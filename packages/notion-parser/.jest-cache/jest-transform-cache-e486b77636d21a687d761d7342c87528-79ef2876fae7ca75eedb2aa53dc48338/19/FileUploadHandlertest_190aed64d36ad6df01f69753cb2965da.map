{"file":"C:\\Users\\rayan\\Desktop\\Dev\\NotionClipper\\packages\\notion-parser\\tests\\unit\\utils\\FileUploadHandler.test.ts","mappings":"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","names":[],"sources":["C:\\Users\\rayan\\Desktop\\Dev\\NotionClipper\\packages\\notion-parser\\tests\\unit\\utils\\FileUploadHandler.test.ts"],"sourcesContent":["/**\r\n * Tests unitaires pour FileUploadHandler - Upload natif Notion v2.1 ⭐\r\n * Couvre l'upload de fichiers via l'API Notion native /v1/file_uploads\r\n */\r\n\r\nimport { FileUploadHandler, uploadFileAndParse } from '../../../src/utils/FileUploadHandler';\r\nimport type { FileUploadResult } from '../../../src/utils/FileUploadHandler';\r\n\r\n// Mock fetch pour les tests\r\nconst mockFetch = jest.fn();\r\nglobal.fetch = mockFetch;\r\n\r\ndescribe('FileUploadHandler - Upload natif Notion v2.1 ⭐', () => {\r\n  let handler: FileUploadHandler;\r\n  const mockOptions = {\r\n    notionToken: 'secret_test_token_123',\r\n    maxFileSize: 20 * 1024 * 1024\r\n  };\r\n\r\n  beforeEach(() => {\r\n    handler = new FileUploadHandler(mockOptions);\r\n    mockFetch.mockClear();\r\n  });\r\n\r\n  describe('Constructor and Configuration', () => {\r\n    it('should initialize with Notion token', () => {\r\n      expect(handler).toBeDefined();\r\n      expect(() => new FileUploadHandler({ notionToken: '' })).toThrow();\r\n    });\r\n\r\n    it('should use default options', () => {\r\n      const defaultHandler = new FileUploadHandler(mockOptions);\r\n      expect(defaultHandler).toBeDefined();\r\n    });\r\n\r\n    it('should accept custom options', () => {\r\n      const customHandler = new FileUploadHandler({\r\n        ...mockOptions,\r\n        maxFileSize: 50 * 1024 * 1024\r\n      });\r\n      expect(customHandler).toBeDefined();\r\n    });\r\n  });\r\n\r\n  describe('File Validation', () => {\r\n    it('should validate file size limits', async () => {\r\n      // Create a mock file that exceeds size limit\r\n      const largeFile = new Blob(['x'.repeat(100 * 1024 * 1024)], { type: 'image/jpeg' }); // 100MB\r\n      \r\n      const result = await handler.uploadFile(largeFile, 'large.jpg');\r\n      \r\n      expect(result.success).toBe(false);\r\n      expect(result.error).toContain('volumineux');\r\n    });\r\n\r\n    it('should validate allowed file types', async () => {\r\n      const restrictedHandler = new FileUploadHandler({\r\n        ...mockOptions,\r\n        allowedTypes: ['image/jpeg', 'image/png']\r\n      });\r\n      \r\n      const file = new Blob(['test'], { type: 'text/plain' });\r\n      const result = await restrictedHandler.uploadFile(file, 'test.txt');\r\n      \r\n      expect(result.success).toBe(false);\r\n      expect(result.error).toContain('non autorisé');\r\n    });\r\n\r\n    it('should validate required parameters', async () => {\r\n      const file = new Blob(['test'], { type: 'image/jpeg' });\r\n      \r\n      const result = await handler.uploadFile(file);\r\n      \r\n      // Should handle gracefully with default filename\r\n      expect(result).toBeDefined();\r\n    });\r\n\r\n    it('should handle file validation gracefully', async () => {\r\n      const file = new Blob(['test'], { type: 'image/jpeg' });\r\n      \r\n      const result = await handler.uploadFile(file, 'test.jpg');\r\n      \r\n      // Should handle gracefully\r\n      expect(result).toBeDefined();\r\n    });\r\n  });\r\n\r\n  describe('File Upload Process', () => {\r\n    it('should upload small file successfully', async () => {\r\n      const file = new Blob(['test content'], { type: 'image/jpeg' });\r\n      \r\n      // Mock successful responses\r\n      mockFetch\r\n        .mockResolvedValueOnce({\r\n          ok: true,\r\n          json: async () => ({\r\n            id: 'file_upload_123',\r\n            status: 'pending'\r\n          })\r\n        })\r\n        .mockResolvedValueOnce({\r\n          ok: true,\r\n          json: async () => ({})\r\n        });\r\n\r\n      const result = await handler.uploadFile(file, 'test.jpg');\r\n\r\n      expect(result.success).toBe(true);\r\n      expect(result.publicId).toBe('file_upload_123');\r\n      expect(mockFetch).toHaveBeenCalledTimes(2);\r\n    });\r\n\r\n    it('should handle upload API errors', async () => {\r\n      const file = new Blob(['test'], { type: 'image/jpeg' });\r\n      \r\n      mockFetch.mockResolvedValueOnce({\r\n        ok: false,\r\n        status: 400,\r\n        text: async () => 'Bad Request'\r\n      });\r\n\r\n      const result = await handler.uploadFile(file, 'test.jpg');\r\n\r\n      expect(result.success).toBe(false);\r\n      expect(result.error).toBeDefined();\r\n    });\r\n\r\n    it('should handle network errors', async () => {\r\n      const file = new Blob(['test'], { type: 'image/jpeg' });\r\n      \r\n      mockFetch.mockRejectedValueOnce(new Error('Network error'));\r\n\r\n      const result = await handler.uploadFile(file, 'test.jpg');\r\n\r\n      expect(result.success).toBe(false);\r\n      expect(result.error).toBeDefined();\r\n    });\r\n\r\n    it('should call progress callback if provided', async () => {\r\n      const file = new Blob(['test'], { type: 'image/jpeg' });\r\n      const progressCallback = jest.fn();\r\n      \r\n      const handlerWithProgress = new FileUploadHandler({\r\n        ...mockOptions,\r\n        onProgress: progressCallback\r\n      });\r\n      \r\n      mockFetch\r\n        .mockResolvedValueOnce({\r\n          ok: true,\r\n          json: async () => ({\r\n            id: 'file_upload_123',\r\n            status: 'pending'\r\n          })\r\n        })\r\n        .mockResolvedValueOnce({\r\n          ok: true,\r\n          json: async () => ({})\r\n        });\r\n\r\n      await handlerWithProgress.uploadFile(file, 'test.jpg');\r\n\r\n      // Progress callback should be called during upload process\r\n      expect(progressCallback).toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('Large File Handling', () => {\r\n    it('should handle large files within size limits', async () => {\r\n      const largeFile = new Blob(['x'.repeat(15 * 1024 * 1024)], { type: 'image/jpeg' }); // 15MB\r\n      \r\n      mockFetch\r\n        .mockResolvedValueOnce({\r\n          ok: true,\r\n          json: async () => ({\r\n            id: 'file_upload_123',\r\n            status: 'pending'\r\n          })\r\n        })\r\n        .mockResolvedValueOnce({\r\n          ok: true,\r\n          json: async () => ({})\r\n        });\r\n\r\n      const result = await handler.uploadFile(largeFile, 'large.jpg');\r\n\r\n      expect(result.success).toBe(true);\r\n      expect(mockFetch).toHaveBeenCalledTimes(2);\r\n    });\r\n\r\n    it('should reject files exceeding size limit', async () => {\r\n      const tooLargeFile = new Blob(['x'.repeat(25 * 1024 * 1024)], { type: 'image/jpeg' }); // 25MB\r\n      \r\n      const result = await handler.uploadFile(tooLargeFile, 'toolarge.jpg');\r\n\r\n      expect(result.success).toBe(false);\r\n      expect(result.error).toContain('volumineux');\r\n    });\r\n  });\r\n\r\n  describe('Block Creation', () => {\r\n    it('should create image block correctly', () => {\r\n      const uploadResult: FileUploadResult = {\r\n        success: true,\r\n        publicId: 'file_upload_123',\r\n        metadata: {\r\n          originalName: 'test.jpg',\r\n          size: 1024,\r\n          type: 'image/jpeg'\r\n        }\r\n      };\r\n      \r\n      const block = handler.createNotionBlock('image', uploadResult);\r\n      \r\n      expect(block.type).toBe('image');\r\n      expect((block as any).image.type).toBe('file_upload');\r\n      expect((block as any).image.file_upload.id).toBe('file_upload_123');\r\n    });\r\n\r\n    it('should create video block correctly', () => {\r\n      const uploadResult: FileUploadResult = {\r\n        success: true,\r\n        publicId: 'file_upload_456',\r\n        metadata: {\r\n          originalName: 'test.mp4',\r\n          size: 2048,\r\n          type: 'video/mp4'\r\n        }\r\n      };\r\n      \r\n      const block = handler.createNotionBlock('video', uploadResult);\r\n      \r\n      expect(block.type).toBe('video');\r\n      expect((block as any).video.type).toBe('file_upload');\r\n      expect((block as any).video.file_upload.id).toBe('file_upload_456');\r\n    });\r\n\r\n    it('should create audio block correctly', () => {\r\n      const uploadResult: FileUploadResult = {\r\n        success: true,\r\n        publicId: 'file_upload_789',\r\n        metadata: {\r\n          originalName: 'test.mp3',\r\n          size: 3072,\r\n          type: 'audio/mp3'\r\n        }\r\n      };\r\n      \r\n      const block = handler.createNotionBlock('audio', uploadResult);\r\n      \r\n      expect(block.type).toBe('audio');\r\n      expect((block as any).audio.type).toBe('file_upload');\r\n      expect((block as any).audio.file_upload.id).toBe('file_upload_789');\r\n    });\r\n\r\n    it('should create file block for unknown types', () => {\r\n      const uploadResult: FileUploadResult = {\r\n        success: true,\r\n        publicId: 'file_upload_000',\r\n        metadata: {\r\n          originalName: 'document.pdf',\r\n          size: 4096,\r\n          type: 'application/pdf'\r\n        }\r\n      };\r\n      \r\n      const block = handler.createNotionBlock('file', uploadResult);\r\n      \r\n      expect(block.type).toBe('file');\r\n      expect((block as any).file.type).toBe('file_upload');\r\n      expect((block as any).file.file_upload.id).toBe('file_upload_000');\r\n    });\r\n  });\r\n\r\n  describe('Notion Block Creation', () => {\r\n    it('should create blocks from upload results', () => {\r\n      const uploadResult: FileUploadResult = {\r\n        success: true,\r\n        publicId: 'file_upload_123',\r\n        metadata: {\r\n          originalName: 'test.jpg',\r\n          size: 1024,\r\n          type: 'image/jpeg'\r\n        }\r\n      };\r\n      \r\n      const block = handler.createNotionBlock('image', uploadResult);\r\n      \r\n      expect(block.type).toBe('image');\r\n      expect((block as any).image.type).toBe('file_upload');\r\n      expect((block as any).image.file_upload.id).toBe('file_upload_123');\r\n    });\r\n  });\r\n\r\n  describe('Error Handling', () => {\r\n    it('should handle network errors gracefully', async () => {\r\n      const file = new Blob(['test'], { type: 'image/jpeg' });\r\n      \r\n      mockFetch.mockRejectedValueOnce(new Error('Network error'));\r\n\r\n      const result = await handler.uploadFile(file, 'test.jpg');\r\n\r\n      expect(result.success).toBe(false);\r\n      expect(result.error).toContain('Network error');\r\n    });\r\n\r\n    it('should handle invalid Notion token', async () => {\r\n      const file = new Blob(['test'], { type: 'image/jpeg' });\r\n      \r\n      mockFetch.mockResolvedValueOnce({\r\n        ok: false,\r\n        status: 401,\r\n        text: async () => 'Unauthorized'\r\n      });\r\n\r\n      const result = await handler.uploadFile(file, 'test.jpg');\r\n\r\n      expect(result.success).toBe(false);\r\n      expect(result.error).toContain('401');\r\n    });\r\n\r\n    it('should handle empty files', async () => {\r\n      const emptyFile = new Blob([], { type: 'text/plain' });\r\n      \r\n      const result = await handler.uploadFile(emptyFile, 'empty.txt');\r\n\r\n      // Should handle gracefully\r\n      expect(result).toBeDefined();\r\n    });\r\n\r\n    it('should handle special characters in filename', async () => {\r\n      const file = new Blob(['test'], { type: 'image/jpeg' });\r\n      const specialFilename = 'tëst fîlé with spéciàl chars.jpg';\r\n      \r\n      mockFetch.mockResolvedValue({\r\n        ok: true,\r\n        json: async () => ({\r\n          id: 'file_upload_123',\r\n          status: 'pending'\r\n        })\r\n      });\r\n\r\n      const result = await handler.uploadFile(file, specialFilename);\r\n\r\n      expect(result.success).toBe(true);\r\n    });\r\n  });\r\n\r\n  describe('Integration Tests', () => {\r\n    it('should work with uploadFileAndParse function', async () => {\r\n      const file = new Blob(['test image content'], { type: 'image/jpeg' });\r\n      \r\n      mockFetch.mockResolvedValue({\r\n        ok: true,\r\n        json: async () => ({\r\n          id: 'file_upload_123',\r\n          status: 'uploaded'\r\n        })\r\n      });\r\n\r\n      const result = await uploadFileAndParse(file, {\r\n        upload: mockOptions\r\n      });\r\n\r\n      expect(result.uploadResult.success).toBe(true);\r\n      expect(result.block).toBeDefined();\r\n      expect(result.block?.type).toBe('image');\r\n    });\r\n  });\r\n});"],"version":3}