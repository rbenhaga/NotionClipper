e51a0ffbb835f845b41070270925779f
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.CodeParser = void 0;
const BaseParser_1 = require("./BaseParser");
class CodeParser extends BaseParser_1.BaseParser {
    constructor(options = {}) {
        super(options);
        this.validLanguages = [
            'abap', 'actionscript', 'ada', 'apache', 'applescript', 'arduino', 'assembly', 'autohotkey',
            'bash', 'basic', 'batch', 'brainfuck', 'c', 'clojure', 'cmake', 'cobol', 'coffeescript',
            'c++', 'c#', 'crystal', 'css', 'cuda', 'd', 'dart', 'delphi', 'diff', 'django', 'docker',
            'dockerfile', 'elixir', 'elm', 'erlang', 'f#', 'flow', 'fortran', 'fsharp', 'gherkin',
            'git', 'glsl', 'go', 'gradle', 'graphql', 'groovy', 'haml', 'handlebars', 'haskell',
            'haxe', 'html', 'http', 'ini', 'java', 'javascript', 'jinja2', 'json', 'jsx', 'julia',
            'kotlin', 'latex', 'less', 'liquid', 'lisp', 'livescript', 'llvm', 'lua', 'makefile',
            'markdown', 'markup', 'matlab', 'mermaid', 'nim', 'nix', 'objective-c', 'ocaml', 'pascal',
            'perl', 'php', 'plain text', 'powershell', 'prolog', 'protobuf', 'pug', 'puppet', 'python',
            'qml', 'r', 'razor', 'reason', 'ruby', 'rust', 'sass', 'scala', 'scheme', 'scss', 'shell',
            'smalltalk', 'solidity', 'sql', 'stylus', 'svelte', 'swift', 'tcl', 'tex', 'toml',
            'tsx', 'typescript', 'vala', 'vb.net', 'verilog', 'vhdl', 'vim', 'visual basic',
            'vue', 'webassembly', 'xml', 'xquery', 'yaml', 'zig'
        ];
    }
    parse(content) {
        if (!content?.trim())
            return [];
        const language = this.detectLanguage(content);
        const truncatedContent = this.truncateContent(content, this.options.maxCodeLength || 2000);
        return [this.createCodeNode(truncatedContent, language, true)];
    }
    detectLanguage(content) {
        // Check if language is provided in metadata
        if (this.options.metadata?.language) {
            const providedLang = this.options.metadata.language.toLowerCase();
            if (this.validLanguages.includes(providedLang)) {
                return providedLang;
            }
        }
        // Auto-detect based on content patterns
        const detectedLang = this.autoDetectLanguage(content);
        return this.validLanguages.includes(detectedLang) ? detectedLang : 'plain text';
    }
    autoDetectLanguage(content) {
        // JavaScript/TypeScript
        if (this.hasPatterns(content, [
            /\b(const|let|var)\s+\w+/,
            /function\s*\(/,
            /=>\s*{?/,
            /import\s+.*from/
        ])) {
            if (content.includes('interface ') || content.includes(': string') || content.includes(': number')) {
                return 'typescript';
            }
            return 'javascript';
        }
        // Python
        if (this.hasPatterns(content, [
            /\bdef\s+\w+\s*\(/,
            /\bclass\s+\w+/,
            /\bimport\s+\w+/,
            /\bfrom\s+\w+\s+import/,
            /:\s*$/m
        ])) {
            return 'python';
        }
        // Java
        if (this.hasPatterns(content, [
            /\bpublic\s+class\s+\w+/,
            /\bpublic\s+static\s+void\s+main/,
            /\bimport\s+java\./,
            /\bSystem\.out\.println/
        ])) {
            return 'java';
        }
        // C/C++
        if (this.hasPatterns(content, [
            /#include\s*<.*>/,
            /\bint\s+main\s*\(/,
            /\bstd::/,
            /\bprintf\s*\(/
        ])) {
            return content.includes('std::') || content.includes('#include <iostream>') ? 'c++' : 'c';
        }
        // C#
        if (this.hasPatterns(content, [
            /\busing\s+System/,
            /\bnamespace\s+\w+/,
            /\bpublic\s+class\s+\w+/,
            /\bConsole\.WriteLine/
        ])) {
            return 'c#';
        }
        // PHP
        if (content.includes('<?php') || this.hasPatterns(content, [
            /\$\w+\s*=/,
            /\bfunction\s+\w+\s*\(/,
            /\becho\s+/
        ])) {
            return 'php';
        }
        // Ruby
        if (this.hasPatterns(content, [
            /\bdef\s+\w+/,
            /\bclass\s+\w+/,
            /\bend\s*$/m,
            /\bputs\s+/
        ])) {
            return 'ruby';
        }
        // Go
        if (this.hasPatterns(content, [
            /\bpackage\s+\w+/,
            /\bfunc\s+\w+\s*\(/,
            /\bimport\s+\(/,
            /\bfmt\.Print/
        ])) {
            return 'go';
        }
        // Rust
        if (this.hasPatterns(content, [
            /\bfn\s+\w+\s*\(/,
            /\blet\s+mut\s+/,
            /\buse\s+std::/,
            /\bprintln!\s*\(/
        ])) {
            return 'rust';
        }
        // SQL
        if (this.hasPatterns(content, [
            /\bSELECT\s+.*\bFROM\b/i,
            /\bINSERT\s+INTO\b/i,
            /\bUPDATE\s+.*\bSET\b/i,
            /\bCREATE\s+TABLE\b/i
        ])) {
            return 'sql';
        }
        // HTML
        if (this.hasPatterns(content, [
            /<html\b/i,
            /<head\b/i,
            /<body\b/i,
            /<div\b.*>/i
        ])) {
            return 'html';
        }
        // CSS
        if (this.hasPatterns(content, [
            /\w+\s*{\s*[\w-]+\s*:/,
            /@media\s+/,
            /\.[\w-]+\s*{/,
            /#[\w-]+\s*{/
        ])) {
            return 'css';
        }
        // JSON
        if (this.isValidJson(content)) {
            return 'json';
        }
        // XML
        if (this.hasPatterns(content, [
            /<\?xml\s+version/i,
            /<\/\w+>/,
            /<\w+\s+.*=/
        ])) {
            return 'xml';
        }
        // YAML
        if (this.hasPatterns(content, [
            /^[\w-]+:\s*$/m,
            /^[\w-]+:\s+\w+/m,
            /^\s*-\s+\w+/m
        ])) {
            return 'yaml';
        }
        // Shell/Bash
        if (this.hasPatterns(content, [
            /^#!/,
            /\becho\s+/,
            /\bif\s+\[.*\]/,
            /\$\w+/
        ])) {
            return 'bash';
        }
        // Kotlin
        if (this.hasPatterns(content, [
            /\bfun\s+\w+\s*\(/,
            /\bval\s+\w+/,
            /\bvar\s+\w+/,
            /\bclass\s+\w+.*{/
        ])) {
            return 'kotlin';
        }
        // Swift
        if (this.hasPatterns(content, [
            /\bfunc\s+\w+\s*\(/,
            /\bvar\s+\w+/,
            /\blet\s+\w+/,
            /\bimport\s+Foundation/
        ])) {
            return 'swift';
        }
        // Dart
        if (this.hasPatterns(content, [
            /\bvoid\s+main\s*\(/,
            /\bclass\s+\w+\s*{/,
            /\bimport\s+'dart:/,
            /\bString\s+\w+/
        ])) {
            return 'dart';
        }
        // Julia
        if (this.hasPatterns(content, [
            /\bfunction\s+\w+\s*\(/,
            /\bend\s*$/m,
            /\busing\s+\w+/,
            /\bprintln\s*\(/
        ])) {
            return 'julia';
        }
        // Scala
        if (this.hasPatterns(content, [
            /\bobject\s+\w+/,
            /\bdef\s+\w+\s*\(/,
            /\bval\s+\w+/,
            /\bimport\s+scala\./
        ])) {
            return 'scala';
        }
        // Haskell
        if (this.hasPatterns(content, [
            /\w+\s*::\s*\w+/,
            /\bmodule\s+\w+/,
            /\bimport\s+\w+/,
            /\bwhere\s*$/m
        ])) {
            return 'haskell';
        }
        // Elixir
        if (this.hasPatterns(content, [
            /\bdefmodule\s+\w+/,
            /\bdef\s+\w+\s*\(/,
            /\bdo\s*$/m,
            /\bIO\.puts/
        ])) {
            return 'elixir';
        }
        // Erlang
        if (this.hasPatterns(content, [
            /^-module\s*\(/m,
            /^-export\s*\(/m,
            /\w+\s*\(.*\)\s*->/,
            /\bio:format/
        ])) {
            return 'erlang';
        }
        // F#
        if (this.hasPatterns(content, [
            /\blet\s+\w+\s*=/,
            /\bmodule\s+\w+/,
            /\bopen\s+\w+/,
            /\bprintfn\s+/
        ])) {
            return 'f#';
        }
        // Fortran
        if (this.hasPatterns(content, [
            /\bprogram\s+\w+/i,
            /\bsubroutine\s+\w+/i,
            /\binteger\s*::/i,
            /\bwrite\s*\(/i
        ])) {
            return 'fortran';
        }
        // R
        if (this.hasPatterns(content, [
            /\blibrary\s*\(/,
            /<-\s*\w+/,
            /\bprint\s*\(/,
            /\bdata\.frame\s*\(/
        ])) {
            return 'r';
        }
        // MATLAB
        if (this.hasPatterns(content, [
            /\bfunction\s+.*=\s*\w+\s*\(/,
            /\bdisp\s*\(/,
            /\bplot\s*\(/,
            /\bend\s*$/m
        ])) {
            return 'matlab';
        }
        // Dockerfile
        if (this.hasPatterns(content, [
            /^FROM\s+\w+/m,
            /^RUN\s+/m,
            /^COPY\s+/m,
            /^WORKDIR\s+/m
        ])) {
            return 'dockerfile';
        }
        // TOML
        if (this.hasPatterns(content, [
            /^\[[\w.-]+\]/m,
            /^[\w-]+\s*=\s*".*"/m,
            /^[\w-]+\s*=\s*\d+/m
        ])) {
            return 'toml';
        }
        return 'plain text';
    }
    hasPatterns(content, patterns) {
        return patterns.some(pattern => pattern.test(content));
    }
    isValidJson(content) {
        try {
            JSON.parse(content.trim());
            return true;
        }
        catch {
            return false;
        }
    }
}
exports.CodeParser = CodeParser;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxyYXlhblxcRGVza3RvcFxcRGV2XFxOb3Rpb25DbGlwcGVyXFxwYWNrYWdlc1xcbm90aW9uLXBhcnNlclxcc3JjXFxwYXJzZXJzXFxDb2RlUGFyc2VyLnRzIiwibWFwcGluZ3MiOiI7OztBQUFBLDZDQUEwQztBQUcxQyxNQUFhLFVBQVcsU0FBUSx1QkFBVTtJQWlCeEMsWUFBWSxVQUF3QixFQUFFO1FBQ3BDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztRQWpCQSxtQkFBYyxHQUFHO1lBQ2hDLE1BQU0sRUFBRSxjQUFjLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRSxhQUFhLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxZQUFZO1lBQzNGLE1BQU0sRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFLFdBQVcsRUFBRSxHQUFHLEVBQUUsU0FBUyxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsY0FBYztZQUN2RixLQUFLLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsUUFBUTtZQUN4RixZQUFZLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsUUFBUSxFQUFFLFNBQVM7WUFDckYsS0FBSyxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxTQUFTO1lBQ25GLE1BQU0sRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLE9BQU87WUFDckYsUUFBUSxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxVQUFVO1lBQ3BGLFVBQVUsRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLGFBQWEsRUFBRSxPQUFPLEVBQUUsUUFBUTtZQUN6RixNQUFNLEVBQUUsS0FBSyxFQUFFLFlBQVksRUFBRSxZQUFZLEVBQUUsUUFBUSxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQUUsUUFBUSxFQUFFLFFBQVE7WUFDMUYsS0FBSyxFQUFFLEdBQUcsRUFBRSxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLE9BQU87WUFDekYsV0FBVyxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxNQUFNO1lBQ2pGLEtBQUssRUFBRSxZQUFZLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxjQUFjO1lBQy9FLEtBQUssRUFBRSxhQUFhLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsS0FBSztTQUNyRCxDQUFDO0lBSUYsQ0FBQztJQUVELEtBQUssQ0FBQyxPQUFlO1FBQ25CLElBQUksQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFO1lBQUUsT0FBTyxFQUFFLENBQUM7UUFFaEMsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUM5QyxNQUFNLGdCQUFnQixHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxPQUFPLENBQUMsYUFBYSxJQUFJLElBQUksQ0FBQyxDQUFDO1FBRTNGLE9BQU8sQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLGdCQUFnQixFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBQ2pFLENBQUM7SUFFTyxjQUFjLENBQUMsT0FBZTtRQUNwQyw0Q0FBNEM7UUFDNUMsSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRSxRQUFRLEVBQUUsQ0FBQztZQUNwQyxNQUFNLFlBQVksR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDbEUsSUFBSSxJQUFJLENBQUMsY0FBYyxDQUFDLFFBQVEsQ0FBQyxZQUFZLENBQUMsRUFBRSxDQUFDO2dCQUMvQyxPQUFPLFlBQVksQ0FBQztZQUN0QixDQUFDO1FBQ0gsQ0FBQztRQUVELHdDQUF3QztRQUN4QyxNQUFNLFlBQVksR0FBRyxJQUFJLENBQUMsa0JBQWtCLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDdEQsT0FBTyxJQUFJLENBQUMsY0FBYyxDQUFDLFFBQVEsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUM7SUFDbEYsQ0FBQztJQUVPLGtCQUFrQixDQUFDLE9BQWU7UUFDeEMsd0JBQXdCO1FBQ3hCLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUU7WUFDNUIseUJBQXlCO1lBQ3pCLGVBQWU7WUFDZixTQUFTO1lBQ1QsaUJBQWlCO1NBQ2xCLENBQUMsRUFBRSxDQUFDO1lBQ0gsSUFBSSxPQUFPLENBQUMsUUFBUSxDQUFDLFlBQVksQ0FBQyxJQUFJLE9BQU8sQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLElBQUksT0FBTyxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDO2dCQUNuRyxPQUFPLFlBQVksQ0FBQztZQUN0QixDQUFDO1lBQ0QsT0FBTyxZQUFZLENBQUM7UUFDdEIsQ0FBQztRQUVELFNBQVM7UUFDVCxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxFQUFFO1lBQzVCLGtCQUFrQjtZQUNsQixlQUFlO1lBQ2YsZ0JBQWdCO1lBQ2hCLHVCQUF1QjtZQUN2QixRQUFRO1NBQ1QsQ0FBQyxFQUFFLENBQUM7WUFDSCxPQUFPLFFBQVEsQ0FBQztRQUNsQixDQUFDO1FBRUQsT0FBTztRQUNQLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUU7WUFDNUIsd0JBQXdCO1lBQ3hCLGlDQUFpQztZQUNqQyxtQkFBbUI7WUFDbkIsd0JBQXdCO1NBQ3pCLENBQUMsRUFBRSxDQUFDO1lBQ0gsT0FBTyxNQUFNLENBQUM7UUFDaEIsQ0FBQztRQUVELFFBQVE7UUFDUixJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxFQUFFO1lBQzVCLGlCQUFpQjtZQUNqQixtQkFBbUI7WUFDbkIsU0FBUztZQUNULGVBQWU7U0FDaEIsQ0FBQyxFQUFFLENBQUM7WUFDSCxPQUFPLE9BQU8sQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLElBQUksT0FBTyxDQUFDLFFBQVEsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQztRQUM1RixDQUFDO1FBRUQsS0FBSztRQUNMLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUU7WUFDNUIsa0JBQWtCO1lBQ2xCLG1CQUFtQjtZQUNuQix3QkFBd0I7WUFDeEIsc0JBQXNCO1NBQ3ZCLENBQUMsRUFBRSxDQUFDO1lBQ0gsT0FBTyxJQUFJLENBQUM7UUFDZCxDQUFDO1FBRUQsTUFBTTtRQUNOLElBQUksT0FBTyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sRUFBRTtZQUN6RCxXQUFXO1lBQ1gsdUJBQXVCO1lBQ3ZCLFdBQVc7U0FDWixDQUFDLEVBQUUsQ0FBQztZQUNILE9BQU8sS0FBSyxDQUFDO1FBQ2YsQ0FBQztRQUVELE9BQU87UUFDUCxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxFQUFFO1lBQzVCLGFBQWE7WUFDYixlQUFlO1lBQ2YsWUFBWTtZQUNaLFdBQVc7U0FDWixDQUFDLEVBQUUsQ0FBQztZQUNILE9BQU8sTUFBTSxDQUFDO1FBQ2hCLENBQUM7UUFFRCxLQUFLO1FBQ0wsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sRUFBRTtZQUM1QixpQkFBaUI7WUFDakIsbUJBQW1CO1lBQ25CLGVBQWU7WUFDZixjQUFjO1NBQ2YsQ0FBQyxFQUFFLENBQUM7WUFDSCxPQUFPLElBQUksQ0FBQztRQUNkLENBQUM7UUFFRCxPQUFPO1FBQ1AsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sRUFBRTtZQUM1QixpQkFBaUI7WUFDakIsZ0JBQWdCO1lBQ2hCLGVBQWU7WUFDZixpQkFBaUI7U0FDbEIsQ0FBQyxFQUFFLENBQUM7WUFDSCxPQUFPLE1BQU0sQ0FBQztRQUNoQixDQUFDO1FBRUQsTUFBTTtRQUNOLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUU7WUFDNUIsd0JBQXdCO1lBQ3hCLG9CQUFvQjtZQUNwQix1QkFBdUI7WUFDdkIscUJBQXFCO1NBQ3RCLENBQUMsRUFBRSxDQUFDO1lBQ0gsT0FBTyxLQUFLLENBQUM7UUFDZixDQUFDO1FBRUQsT0FBTztRQUNQLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUU7WUFDNUIsVUFBVTtZQUNWLFVBQVU7WUFDVixVQUFVO1lBQ1YsWUFBWTtTQUNiLENBQUMsRUFBRSxDQUFDO1lBQ0gsT0FBTyxNQUFNLENBQUM7UUFDaEIsQ0FBQztRQUVELE1BQU07UUFDTixJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxFQUFFO1lBQzVCLHNCQUFzQjtZQUN0QixXQUFXO1lBQ1gsY0FBYztZQUNkLGFBQWE7U0FDZCxDQUFDLEVBQUUsQ0FBQztZQUNILE9BQU8sS0FBSyxDQUFDO1FBQ2YsQ0FBQztRQUVELE9BQU87UUFDUCxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQztZQUM5QixPQUFPLE1BQU0sQ0FBQztRQUNoQixDQUFDO1FBRUQsTUFBTTtRQUNOLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUU7WUFDNUIsbUJBQW1CO1lBQ25CLFNBQVM7WUFDVCxZQUFZO1NBQ2IsQ0FBQyxFQUFFLENBQUM7WUFDSCxPQUFPLEtBQUssQ0FBQztRQUNmLENBQUM7UUFFRCxPQUFPO1FBQ1AsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sRUFBRTtZQUM1QixlQUFlO1lBQ2YsaUJBQWlCO1lBQ2pCLGNBQWM7U0FDZixDQUFDLEVBQUUsQ0FBQztZQUNILE9BQU8sTUFBTSxDQUFDO1FBQ2hCLENBQUM7UUFFRCxhQUFhO1FBQ2IsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sRUFBRTtZQUM1QixLQUFLO1lBQ0wsV0FBVztZQUNYLGVBQWU7WUFDZixPQUFPO1NBQ1IsQ0FBQyxFQUFFLENBQUM7WUFDSCxPQUFPLE1BQU0sQ0FBQztRQUNoQixDQUFDO1FBRUQsU0FBUztRQUNULElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUU7WUFDNUIsa0JBQWtCO1lBQ2xCLGFBQWE7WUFDYixhQUFhO1lBQ2Isa0JBQWtCO1NBQ25CLENBQUMsRUFBRSxDQUFDO1lBQ0gsT0FBTyxRQUFRLENBQUM7UUFDbEIsQ0FBQztRQUVELFFBQVE7UUFDUixJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxFQUFFO1lBQzVCLG1CQUFtQjtZQUNuQixhQUFhO1lBQ2IsYUFBYTtZQUNiLHVCQUF1QjtTQUN4QixDQUFDLEVBQUUsQ0FBQztZQUNILE9BQU8sT0FBTyxDQUFDO1FBQ2pCLENBQUM7UUFFRCxPQUFPO1FBQ1AsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sRUFBRTtZQUM1QixvQkFBb0I7WUFDcEIsbUJBQW1CO1lBQ25CLG1CQUFtQjtZQUNuQixnQkFBZ0I7U0FDakIsQ0FBQyxFQUFFLENBQUM7WUFDSCxPQUFPLE1BQU0sQ0FBQztRQUNoQixDQUFDO1FBRUQsUUFBUTtRQUNSLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUU7WUFDNUIsdUJBQXVCO1lBQ3ZCLFlBQVk7WUFDWixlQUFlO1lBQ2YsZ0JBQWdCO1NBQ2pCLENBQUMsRUFBRSxDQUFDO1lBQ0gsT0FBTyxPQUFPLENBQUM7UUFDakIsQ0FBQztRQUVELFFBQVE7UUFDUixJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxFQUFFO1lBQzVCLGdCQUFnQjtZQUNoQixrQkFBa0I7WUFDbEIsYUFBYTtZQUNiLG9CQUFvQjtTQUNyQixDQUFDLEVBQUUsQ0FBQztZQUNILE9BQU8sT0FBTyxDQUFDO1FBQ2pCLENBQUM7UUFFRCxVQUFVO1FBQ1YsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sRUFBRTtZQUM1QixnQkFBZ0I7WUFDaEIsZ0JBQWdCO1lBQ2hCLGdCQUFnQjtZQUNoQixjQUFjO1NBQ2YsQ0FBQyxFQUFFLENBQUM7WUFDSCxPQUFPLFNBQVMsQ0FBQztRQUNuQixDQUFDO1FBRUQsU0FBUztRQUNULElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUU7WUFDNUIsbUJBQW1CO1lBQ25CLGtCQUFrQjtZQUNsQixXQUFXO1lBQ1gsWUFBWTtTQUNiLENBQUMsRUFBRSxDQUFDO1lBQ0gsT0FBTyxRQUFRLENBQUM7UUFDbEIsQ0FBQztRQUVELFNBQVM7UUFDVCxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxFQUFFO1lBQzVCLGdCQUFnQjtZQUNoQixnQkFBZ0I7WUFDaEIsbUJBQW1CO1lBQ25CLGFBQWE7U0FDZCxDQUFDLEVBQUUsQ0FBQztZQUNILE9BQU8sUUFBUSxDQUFDO1FBQ2xCLENBQUM7UUFFRCxLQUFLO1FBQ0wsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sRUFBRTtZQUM1QixpQkFBaUI7WUFDakIsZ0JBQWdCO1lBQ2hCLGNBQWM7WUFDZCxjQUFjO1NBQ2YsQ0FBQyxFQUFFLENBQUM7WUFDSCxPQUFPLElBQUksQ0FBQztRQUNkLENBQUM7UUFFRCxVQUFVO1FBQ1YsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sRUFBRTtZQUM1QixrQkFBa0I7WUFDbEIscUJBQXFCO1lBQ3JCLGlCQUFpQjtZQUNqQixlQUFlO1NBQ2hCLENBQUMsRUFBRSxDQUFDO1lBQ0gsT0FBTyxTQUFTLENBQUM7UUFDbkIsQ0FBQztRQUVELElBQUk7UUFDSixJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxFQUFFO1lBQzVCLGdCQUFnQjtZQUNoQixVQUFVO1lBQ1YsY0FBYztZQUNkLG9CQUFvQjtTQUNyQixDQUFDLEVBQUUsQ0FBQztZQUNILE9BQU8sR0FBRyxDQUFDO1FBQ2IsQ0FBQztRQUVELFNBQVM7UUFDVCxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxFQUFFO1lBQzVCLDZCQUE2QjtZQUM3QixhQUFhO1lBQ2IsYUFBYTtZQUNiLFlBQVk7U0FDYixDQUFDLEVBQUUsQ0FBQztZQUNILE9BQU8sUUFBUSxDQUFDO1FBQ2xCLENBQUM7UUFFRCxhQUFhO1FBQ2IsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sRUFBRTtZQUM1QixjQUFjO1lBQ2QsVUFBVTtZQUNWLFdBQVc7WUFDWCxjQUFjO1NBQ2YsQ0FBQyxFQUFFLENBQUM7WUFDSCxPQUFPLFlBQVksQ0FBQztRQUN0QixDQUFDO1FBRUQsT0FBTztRQUNQLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUU7WUFDNUIsZUFBZTtZQUNmLHFCQUFxQjtZQUNyQixvQkFBb0I7U0FDckIsQ0FBQyxFQUFFLENBQUM7WUFDSCxPQUFPLE1BQU0sQ0FBQztRQUNoQixDQUFDO1FBRUQsT0FBTyxZQUFZLENBQUM7SUFDdEIsQ0FBQztJQUVPLFdBQVcsQ0FBQyxPQUFlLEVBQUUsUUFBa0I7UUFDckQsT0FBTyxRQUFRLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO0lBQ3pELENBQUM7SUFFTyxXQUFXLENBQUMsT0FBZTtRQUNqQyxJQUFJLENBQUM7WUFDSCxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO1lBQzNCLE9BQU8sSUFBSSxDQUFDO1FBQ2QsQ0FBQztRQUFDLE1BQU0sQ0FBQztZQUNQLE9BQU8sS0FBSyxDQUFDO1FBQ2YsQ0FBQztJQUNILENBQUM7Q0FDRjtBQW5XRCxnQ0FtV0MiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxyYXlhblxcRGVza3RvcFxcRGV2XFxOb3Rpb25DbGlwcGVyXFxwYWNrYWdlc1xcbm90aW9uLXBhcnNlclxcc3JjXFxwYXJzZXJzXFxDb2RlUGFyc2VyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJhc2VQYXJzZXIgfSBmcm9tICcuL0Jhc2VQYXJzZXInO1xyXG5pbXBvcnQgdHlwZSB7IEFTVE5vZGUsIFBhcnNlT3B0aW9ucyB9IGZyb20gJy4uL3R5cGVzJztcclxuXHJcbmV4cG9ydCBjbGFzcyBDb2RlUGFyc2VyIGV4dGVuZHMgQmFzZVBhcnNlciB7XHJcbiAgcHJpdmF0ZSByZWFkb25seSB2YWxpZExhbmd1YWdlcyA9IFtcclxuICAgICdhYmFwJywgJ2FjdGlvbnNjcmlwdCcsICdhZGEnLCAnYXBhY2hlJywgJ2FwcGxlc2NyaXB0JywgJ2FyZHVpbm8nLCAnYXNzZW1ibHknLCAnYXV0b2hvdGtleScsXHJcbiAgICAnYmFzaCcsICdiYXNpYycsICdiYXRjaCcsICdicmFpbmZ1Y2snLCAnYycsICdjbG9qdXJlJywgJ2NtYWtlJywgJ2NvYm9sJywgJ2NvZmZlZXNjcmlwdCcsXHJcbiAgICAnYysrJywgJ2MjJywgJ2NyeXN0YWwnLCAnY3NzJywgJ2N1ZGEnLCAnZCcsICdkYXJ0JywgJ2RlbHBoaScsICdkaWZmJywgJ2RqYW5nbycsICdkb2NrZXInLFxyXG4gICAgJ2RvY2tlcmZpbGUnLCAnZWxpeGlyJywgJ2VsbScsICdlcmxhbmcnLCAnZiMnLCAnZmxvdycsICdmb3J0cmFuJywgJ2ZzaGFycCcsICdnaGVya2luJyxcclxuICAgICdnaXQnLCAnZ2xzbCcsICdnbycsICdncmFkbGUnLCAnZ3JhcGhxbCcsICdncm9vdnknLCAnaGFtbCcsICdoYW5kbGViYXJzJywgJ2hhc2tlbGwnLFxyXG4gICAgJ2hheGUnLCAnaHRtbCcsICdodHRwJywgJ2luaScsICdqYXZhJywgJ2phdmFzY3JpcHQnLCAnamluamEyJywgJ2pzb24nLCAnanN4JywgJ2p1bGlhJyxcclxuICAgICdrb3RsaW4nLCAnbGF0ZXgnLCAnbGVzcycsICdsaXF1aWQnLCAnbGlzcCcsICdsaXZlc2NyaXB0JywgJ2xsdm0nLCAnbHVhJywgJ21ha2VmaWxlJyxcclxuICAgICdtYXJrZG93bicsICdtYXJrdXAnLCAnbWF0bGFiJywgJ21lcm1haWQnLCAnbmltJywgJ25peCcsICdvYmplY3RpdmUtYycsICdvY2FtbCcsICdwYXNjYWwnLFxyXG4gICAgJ3BlcmwnLCAncGhwJywgJ3BsYWluIHRleHQnLCAncG93ZXJzaGVsbCcsICdwcm9sb2cnLCAncHJvdG9idWYnLCAncHVnJywgJ3B1cHBldCcsICdweXRob24nLFxyXG4gICAgJ3FtbCcsICdyJywgJ3Jhem9yJywgJ3JlYXNvbicsICdydWJ5JywgJ3J1c3QnLCAnc2FzcycsICdzY2FsYScsICdzY2hlbWUnLCAnc2NzcycsICdzaGVsbCcsXHJcbiAgICAnc21hbGx0YWxrJywgJ3NvbGlkaXR5JywgJ3NxbCcsICdzdHlsdXMnLCAnc3ZlbHRlJywgJ3N3aWZ0JywgJ3RjbCcsICd0ZXgnLCAndG9tbCcsXHJcbiAgICAndHN4JywgJ3R5cGVzY3JpcHQnLCAndmFsYScsICd2Yi5uZXQnLCAndmVyaWxvZycsICd2aGRsJywgJ3ZpbScsICd2aXN1YWwgYmFzaWMnLFxyXG4gICAgJ3Z1ZScsICd3ZWJhc3NlbWJseScsICd4bWwnLCAneHF1ZXJ5JywgJ3lhbWwnLCAnemlnJ1xyXG4gIF07XHJcblxyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IFBhcnNlT3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdXBlcihvcHRpb25zKTtcclxuICB9XHJcblxyXG4gIHBhcnNlKGNvbnRlbnQ6IHN0cmluZyk6IEFTVE5vZGVbXSB7XHJcbiAgICBpZiAoIWNvbnRlbnQ/LnRyaW0oKSkgcmV0dXJuIFtdO1xyXG5cclxuICAgIGNvbnN0IGxhbmd1YWdlID0gdGhpcy5kZXRlY3RMYW5ndWFnZShjb250ZW50KTtcclxuICAgIGNvbnN0IHRydW5jYXRlZENvbnRlbnQgPSB0aGlzLnRydW5jYXRlQ29udGVudChjb250ZW50LCB0aGlzLm9wdGlvbnMubWF4Q29kZUxlbmd0aCB8fCAyMDAwKTtcclxuXHJcbiAgICByZXR1cm4gW3RoaXMuY3JlYXRlQ29kZU5vZGUodHJ1bmNhdGVkQ29udGVudCwgbGFuZ3VhZ2UsIHRydWUpXTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZGV0ZWN0TGFuZ3VhZ2UoY29udGVudDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIC8vIENoZWNrIGlmIGxhbmd1YWdlIGlzIHByb3ZpZGVkIGluIG1ldGFkYXRhXHJcbiAgICBpZiAodGhpcy5vcHRpb25zLm1ldGFkYXRhPy5sYW5ndWFnZSkge1xyXG4gICAgICBjb25zdCBwcm92aWRlZExhbmcgPSB0aGlzLm9wdGlvbnMubWV0YWRhdGEubGFuZ3VhZ2UudG9Mb3dlckNhc2UoKTtcclxuICAgICAgaWYgKHRoaXMudmFsaWRMYW5ndWFnZXMuaW5jbHVkZXMocHJvdmlkZWRMYW5nKSkge1xyXG4gICAgICAgIHJldHVybiBwcm92aWRlZExhbmc7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBBdXRvLWRldGVjdCBiYXNlZCBvbiBjb250ZW50IHBhdHRlcm5zXHJcbiAgICBjb25zdCBkZXRlY3RlZExhbmcgPSB0aGlzLmF1dG9EZXRlY3RMYW5ndWFnZShjb250ZW50KTtcclxuICAgIHJldHVybiB0aGlzLnZhbGlkTGFuZ3VhZ2VzLmluY2x1ZGVzKGRldGVjdGVkTGFuZykgPyBkZXRlY3RlZExhbmcgOiAncGxhaW4gdGV4dCc7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGF1dG9EZXRlY3RMYW5ndWFnZShjb250ZW50OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgLy8gSmF2YVNjcmlwdC9UeXBlU2NyaXB0XHJcbiAgICBpZiAodGhpcy5oYXNQYXR0ZXJucyhjb250ZW50LCBbXHJcbiAgICAgIC9cXGIoY29uc3R8bGV0fHZhcilcXHMrXFx3Ky8sXHJcbiAgICAgIC9mdW5jdGlvblxccypcXCgvLFxyXG4gICAgICAvPT5cXHMqez8vLFxyXG4gICAgICAvaW1wb3J0XFxzKy4qZnJvbS9cclxuICAgIF0pKSB7XHJcbiAgICAgIGlmIChjb250ZW50LmluY2x1ZGVzKCdpbnRlcmZhY2UgJykgfHwgY29udGVudC5pbmNsdWRlcygnOiBzdHJpbmcnKSB8fCBjb250ZW50LmluY2x1ZGVzKCc6IG51bWJlcicpKSB7XHJcbiAgICAgICAgcmV0dXJuICd0eXBlc2NyaXB0JztcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gJ2phdmFzY3JpcHQnO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFB5dGhvblxyXG4gICAgaWYgKHRoaXMuaGFzUGF0dGVybnMoY29udGVudCwgW1xyXG4gICAgICAvXFxiZGVmXFxzK1xcdytcXHMqXFwoLyxcclxuICAgICAgL1xcYmNsYXNzXFxzK1xcdysvLFxyXG4gICAgICAvXFxiaW1wb3J0XFxzK1xcdysvLFxyXG4gICAgICAvXFxiZnJvbVxccytcXHcrXFxzK2ltcG9ydC8sXHJcbiAgICAgIC86XFxzKiQvbVxyXG4gICAgXSkpIHtcclxuICAgICAgcmV0dXJuICdweXRob24nO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEphdmFcclxuICAgIGlmICh0aGlzLmhhc1BhdHRlcm5zKGNvbnRlbnQsIFtcclxuICAgICAgL1xcYnB1YmxpY1xccytjbGFzc1xccytcXHcrLyxcclxuICAgICAgL1xcYnB1YmxpY1xccytzdGF0aWNcXHMrdm9pZFxccyttYWluLyxcclxuICAgICAgL1xcYmltcG9ydFxccytqYXZhXFwuLyxcclxuICAgICAgL1xcYlN5c3RlbVxcLm91dFxcLnByaW50bG4vXHJcbiAgICBdKSkge1xyXG4gICAgICByZXR1cm4gJ2phdmEnO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEMvQysrXHJcbiAgICBpZiAodGhpcy5oYXNQYXR0ZXJucyhjb250ZW50LCBbXHJcbiAgICAgIC8jaW5jbHVkZVxccyo8Lio+LyxcclxuICAgICAgL1xcYmludFxccyttYWluXFxzKlxcKC8sXHJcbiAgICAgIC9cXGJzdGQ6Oi8sXHJcbiAgICAgIC9cXGJwcmludGZcXHMqXFwoL1xyXG4gICAgXSkpIHtcclxuICAgICAgcmV0dXJuIGNvbnRlbnQuaW5jbHVkZXMoJ3N0ZDo6JykgfHwgY29udGVudC5pbmNsdWRlcygnI2luY2x1ZGUgPGlvc3RyZWFtPicpID8gJ2MrKycgOiAnYyc7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQyNcclxuICAgIGlmICh0aGlzLmhhc1BhdHRlcm5zKGNvbnRlbnQsIFtcclxuICAgICAgL1xcYnVzaW5nXFxzK1N5c3RlbS8sXHJcbiAgICAgIC9cXGJuYW1lc3BhY2VcXHMrXFx3Ky8sXHJcbiAgICAgIC9cXGJwdWJsaWNcXHMrY2xhc3NcXHMrXFx3Ky8sXHJcbiAgICAgIC9cXGJDb25zb2xlXFwuV3JpdGVMaW5lL1xyXG4gICAgXSkpIHtcclxuICAgICAgcmV0dXJuICdjIyc7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUEhQXHJcbiAgICBpZiAoY29udGVudC5pbmNsdWRlcygnPD9waHAnKSB8fCB0aGlzLmhhc1BhdHRlcm5zKGNvbnRlbnQsIFtcclxuICAgICAgL1xcJFxcdytcXHMqPS8sXHJcbiAgICAgIC9cXGJmdW5jdGlvblxccytcXHcrXFxzKlxcKC8sXHJcbiAgICAgIC9cXGJlY2hvXFxzKy9cclxuICAgIF0pKSB7XHJcbiAgICAgIHJldHVybiAncGhwJztcclxuICAgIH1cclxuXHJcbiAgICAvLyBSdWJ5XHJcbiAgICBpZiAodGhpcy5oYXNQYXR0ZXJucyhjb250ZW50LCBbXHJcbiAgICAgIC9cXGJkZWZcXHMrXFx3Ky8sXHJcbiAgICAgIC9cXGJjbGFzc1xccytcXHcrLyxcclxuICAgICAgL1xcYmVuZFxccyokL20sXHJcbiAgICAgIC9cXGJwdXRzXFxzKy9cclxuICAgIF0pKSB7XHJcbiAgICAgIHJldHVybiAncnVieSc7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gR29cclxuICAgIGlmICh0aGlzLmhhc1BhdHRlcm5zKGNvbnRlbnQsIFtcclxuICAgICAgL1xcYnBhY2thZ2VcXHMrXFx3Ky8sXHJcbiAgICAgIC9cXGJmdW5jXFxzK1xcdytcXHMqXFwoLyxcclxuICAgICAgL1xcYmltcG9ydFxccytcXCgvLFxyXG4gICAgICAvXFxiZm10XFwuUHJpbnQvXHJcbiAgICBdKSkge1xyXG4gICAgICByZXR1cm4gJ2dvJztcclxuICAgIH1cclxuXHJcbiAgICAvLyBSdXN0XHJcbiAgICBpZiAodGhpcy5oYXNQYXR0ZXJucyhjb250ZW50LCBbXHJcbiAgICAgIC9cXGJmblxccytcXHcrXFxzKlxcKC8sXHJcbiAgICAgIC9cXGJsZXRcXHMrbXV0XFxzKy8sXHJcbiAgICAgIC9cXGJ1c2VcXHMrc3RkOjovLFxyXG4gICAgICAvXFxicHJpbnRsbiFcXHMqXFwoL1xyXG4gICAgXSkpIHtcclxuICAgICAgcmV0dXJuICdydXN0JztcclxuICAgIH1cclxuXHJcbiAgICAvLyBTUUxcclxuICAgIGlmICh0aGlzLmhhc1BhdHRlcm5zKGNvbnRlbnQsIFtcclxuICAgICAgL1xcYlNFTEVDVFxccysuKlxcYkZST01cXGIvaSxcclxuICAgICAgL1xcYklOU0VSVFxccytJTlRPXFxiL2ksXHJcbiAgICAgIC9cXGJVUERBVEVcXHMrLipcXGJTRVRcXGIvaSxcclxuICAgICAgL1xcYkNSRUFURVxccytUQUJMRVxcYi9pXHJcbiAgICBdKSkge1xyXG4gICAgICByZXR1cm4gJ3NxbCc7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSFRNTFxyXG4gICAgaWYgKHRoaXMuaGFzUGF0dGVybnMoY29udGVudCwgW1xyXG4gICAgICAvPGh0bWxcXGIvaSxcclxuICAgICAgLzxoZWFkXFxiL2ksXHJcbiAgICAgIC88Ym9keVxcYi9pLFxyXG4gICAgICAvPGRpdlxcYi4qPi9pXHJcbiAgICBdKSkge1xyXG4gICAgICByZXR1cm4gJ2h0bWwnO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENTU1xyXG4gICAgaWYgKHRoaXMuaGFzUGF0dGVybnMoY29udGVudCwgW1xyXG4gICAgICAvXFx3K1xccyp7XFxzKltcXHctXStcXHMqOi8sXHJcbiAgICAgIC9AbWVkaWFcXHMrLyxcclxuICAgICAgL1xcLltcXHctXStcXHMqey8sXHJcbiAgICAgIC8jW1xcdy1dK1xccyp7L1xyXG4gICAgXSkpIHtcclxuICAgICAgcmV0dXJuICdjc3MnO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEpTT05cclxuICAgIGlmICh0aGlzLmlzVmFsaWRKc29uKGNvbnRlbnQpKSB7XHJcbiAgICAgIHJldHVybiAnanNvbic7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gWE1MXHJcbiAgICBpZiAodGhpcy5oYXNQYXR0ZXJucyhjb250ZW50LCBbXHJcbiAgICAgIC88XFw/eG1sXFxzK3ZlcnNpb24vaSxcclxuICAgICAgLzxcXC9cXHcrPi8sXHJcbiAgICAgIC88XFx3K1xccysuKj0vXHJcbiAgICBdKSkge1xyXG4gICAgICByZXR1cm4gJ3htbCc7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gWUFNTFxyXG4gICAgaWYgKHRoaXMuaGFzUGF0dGVybnMoY29udGVudCwgW1xyXG4gICAgICAvXltcXHctXSs6XFxzKiQvbSxcclxuICAgICAgL15bXFx3LV0rOlxccytcXHcrL20sXHJcbiAgICAgIC9eXFxzKi1cXHMrXFx3Ky9tXHJcbiAgICBdKSkge1xyXG4gICAgICByZXR1cm4gJ3lhbWwnO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFNoZWxsL0Jhc2hcclxuICAgIGlmICh0aGlzLmhhc1BhdHRlcm5zKGNvbnRlbnQsIFtcclxuICAgICAgL14jIS8sXHJcbiAgICAgIC9cXGJlY2hvXFxzKy8sXHJcbiAgICAgIC9cXGJpZlxccytcXFsuKlxcXS8sXHJcbiAgICAgIC9cXCRcXHcrL1xyXG4gICAgXSkpIHtcclxuICAgICAgcmV0dXJuICdiYXNoJztcclxuICAgIH1cclxuXHJcbiAgICAvLyBLb3RsaW5cclxuICAgIGlmICh0aGlzLmhhc1BhdHRlcm5zKGNvbnRlbnQsIFtcclxuICAgICAgL1xcYmZ1blxccytcXHcrXFxzKlxcKC8sXHJcbiAgICAgIC9cXGJ2YWxcXHMrXFx3Ky8sXHJcbiAgICAgIC9cXGJ2YXJcXHMrXFx3Ky8sXHJcbiAgICAgIC9cXGJjbGFzc1xccytcXHcrLip7L1xyXG4gICAgXSkpIHtcclxuICAgICAgcmV0dXJuICdrb3RsaW4nO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFN3aWZ0XHJcbiAgICBpZiAodGhpcy5oYXNQYXR0ZXJucyhjb250ZW50LCBbXHJcbiAgICAgIC9cXGJmdW5jXFxzK1xcdytcXHMqXFwoLyxcclxuICAgICAgL1xcYnZhclxccytcXHcrLyxcclxuICAgICAgL1xcYmxldFxccytcXHcrLyxcclxuICAgICAgL1xcYmltcG9ydFxccytGb3VuZGF0aW9uL1xyXG4gICAgXSkpIHtcclxuICAgICAgcmV0dXJuICdzd2lmdCc7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRGFydFxyXG4gICAgaWYgKHRoaXMuaGFzUGF0dGVybnMoY29udGVudCwgW1xyXG4gICAgICAvXFxidm9pZFxccyttYWluXFxzKlxcKC8sXHJcbiAgICAgIC9cXGJjbGFzc1xccytcXHcrXFxzKnsvLFxyXG4gICAgICAvXFxiaW1wb3J0XFxzKydkYXJ0Oi8sXHJcbiAgICAgIC9cXGJTdHJpbmdcXHMrXFx3Ky9cclxuICAgIF0pKSB7XHJcbiAgICAgIHJldHVybiAnZGFydCc7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSnVsaWFcclxuICAgIGlmICh0aGlzLmhhc1BhdHRlcm5zKGNvbnRlbnQsIFtcclxuICAgICAgL1xcYmZ1bmN0aW9uXFxzK1xcdytcXHMqXFwoLyxcclxuICAgICAgL1xcYmVuZFxccyokL20sXHJcbiAgICAgIC9cXGJ1c2luZ1xccytcXHcrLyxcclxuICAgICAgL1xcYnByaW50bG5cXHMqXFwoL1xyXG4gICAgXSkpIHtcclxuICAgICAgcmV0dXJuICdqdWxpYSc7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU2NhbGFcclxuICAgIGlmICh0aGlzLmhhc1BhdHRlcm5zKGNvbnRlbnQsIFtcclxuICAgICAgL1xcYm9iamVjdFxccytcXHcrLyxcclxuICAgICAgL1xcYmRlZlxccytcXHcrXFxzKlxcKC8sXHJcbiAgICAgIC9cXGJ2YWxcXHMrXFx3Ky8sXHJcbiAgICAgIC9cXGJpbXBvcnRcXHMrc2NhbGFcXC4vXHJcbiAgICBdKSkge1xyXG4gICAgICByZXR1cm4gJ3NjYWxhJztcclxuICAgIH1cclxuXHJcbiAgICAvLyBIYXNrZWxsXHJcbiAgICBpZiAodGhpcy5oYXNQYXR0ZXJucyhjb250ZW50LCBbXHJcbiAgICAgIC9cXHcrXFxzKjo6XFxzKlxcdysvLFxyXG4gICAgICAvXFxibW9kdWxlXFxzK1xcdysvLFxyXG4gICAgICAvXFxiaW1wb3J0XFxzK1xcdysvLFxyXG4gICAgICAvXFxid2hlcmVcXHMqJC9tXHJcbiAgICBdKSkge1xyXG4gICAgICByZXR1cm4gJ2hhc2tlbGwnO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEVsaXhpclxyXG4gICAgaWYgKHRoaXMuaGFzUGF0dGVybnMoY29udGVudCwgW1xyXG4gICAgICAvXFxiZGVmbW9kdWxlXFxzK1xcdysvLFxyXG4gICAgICAvXFxiZGVmXFxzK1xcdytcXHMqXFwoLyxcclxuICAgICAgL1xcYmRvXFxzKiQvbSxcclxuICAgICAgL1xcYklPXFwucHV0cy9cclxuICAgIF0pKSB7XHJcbiAgICAgIHJldHVybiAnZWxpeGlyJztcclxuICAgIH1cclxuXHJcbiAgICAvLyBFcmxhbmdcclxuICAgIGlmICh0aGlzLmhhc1BhdHRlcm5zKGNvbnRlbnQsIFtcclxuICAgICAgL14tbW9kdWxlXFxzKlxcKC9tLFxyXG4gICAgICAvXi1leHBvcnRcXHMqXFwoL20sXHJcbiAgICAgIC9cXHcrXFxzKlxcKC4qXFwpXFxzKi0+LyxcclxuICAgICAgL1xcYmlvOmZvcm1hdC9cclxuICAgIF0pKSB7XHJcbiAgICAgIHJldHVybiAnZXJsYW5nJztcclxuICAgIH1cclxuXHJcbiAgICAvLyBGI1xyXG4gICAgaWYgKHRoaXMuaGFzUGF0dGVybnMoY29udGVudCwgW1xyXG4gICAgICAvXFxibGV0XFxzK1xcdytcXHMqPS8sXHJcbiAgICAgIC9cXGJtb2R1bGVcXHMrXFx3Ky8sXHJcbiAgICAgIC9cXGJvcGVuXFxzK1xcdysvLFxyXG4gICAgICAvXFxicHJpbnRmblxccysvXHJcbiAgICBdKSkge1xyXG4gICAgICByZXR1cm4gJ2YjJztcclxuICAgIH1cclxuXHJcbiAgICAvLyBGb3J0cmFuXHJcbiAgICBpZiAodGhpcy5oYXNQYXR0ZXJucyhjb250ZW50LCBbXHJcbiAgICAgIC9cXGJwcm9ncmFtXFxzK1xcdysvaSxcclxuICAgICAgL1xcYnN1YnJvdXRpbmVcXHMrXFx3Ky9pLFxyXG4gICAgICAvXFxiaW50ZWdlclxccyo6Oi9pLFxyXG4gICAgICAvXFxid3JpdGVcXHMqXFwoL2lcclxuICAgIF0pKSB7XHJcbiAgICAgIHJldHVybiAnZm9ydHJhbic7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUlxyXG4gICAgaWYgKHRoaXMuaGFzUGF0dGVybnMoY29udGVudCwgW1xyXG4gICAgICAvXFxibGlicmFyeVxccypcXCgvLFxyXG4gICAgICAvPC1cXHMqXFx3Ky8sXHJcbiAgICAgIC9cXGJwcmludFxccypcXCgvLFxyXG4gICAgICAvXFxiZGF0YVxcLmZyYW1lXFxzKlxcKC9cclxuICAgIF0pKSB7XHJcbiAgICAgIHJldHVybiAncic7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gTUFUTEFCXHJcbiAgICBpZiAodGhpcy5oYXNQYXR0ZXJucyhjb250ZW50LCBbXHJcbiAgICAgIC9cXGJmdW5jdGlvblxccysuKj1cXHMqXFx3K1xccypcXCgvLFxyXG4gICAgICAvXFxiZGlzcFxccypcXCgvLFxyXG4gICAgICAvXFxicGxvdFxccypcXCgvLFxyXG4gICAgICAvXFxiZW5kXFxzKiQvbVxyXG4gICAgXSkpIHtcclxuICAgICAgcmV0dXJuICdtYXRsYWInO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIERvY2tlcmZpbGVcclxuICAgIGlmICh0aGlzLmhhc1BhdHRlcm5zKGNvbnRlbnQsIFtcclxuICAgICAgL15GUk9NXFxzK1xcdysvbSxcclxuICAgICAgL15SVU5cXHMrL20sXHJcbiAgICAgIC9eQ09QWVxccysvbSxcclxuICAgICAgL15XT1JLRElSXFxzKy9tXHJcbiAgICBdKSkge1xyXG4gICAgICByZXR1cm4gJ2RvY2tlcmZpbGUnO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFRPTUxcclxuICAgIGlmICh0aGlzLmhhc1BhdHRlcm5zKGNvbnRlbnQsIFtcclxuICAgICAgL15cXFtbXFx3Li1dK1xcXS9tLFxyXG4gICAgICAvXltcXHctXStcXHMqPVxccypcIi4qXCIvbSxcclxuICAgICAgL15bXFx3LV0rXFxzKj1cXHMqXFxkKy9tXHJcbiAgICBdKSkge1xyXG4gICAgICByZXR1cm4gJ3RvbWwnO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiAncGxhaW4gdGV4dCc7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGhhc1BhdHRlcm5zKGNvbnRlbnQ6IHN0cmluZywgcGF0dGVybnM6IFJlZ0V4cFtdKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gcGF0dGVybnMuc29tZShwYXR0ZXJuID0+IHBhdHRlcm4udGVzdChjb250ZW50KSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGlzVmFsaWRKc29uKGNvbnRlbnQ6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgSlNPTi5wYXJzZShjb250ZW50LnRyaW0oKSk7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSBjYXRjaCB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcbn0iXSwidmVyc2lvbiI6M30=