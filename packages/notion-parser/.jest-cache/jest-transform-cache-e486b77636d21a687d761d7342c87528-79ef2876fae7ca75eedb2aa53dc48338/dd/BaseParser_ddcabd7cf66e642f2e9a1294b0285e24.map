{"version":3,"names":["cov_3sbrhrs2k","actualCoverage","s","BaseParser","constructor","options","b","f","maxBlocks","maxRichTextLength","maxCodeLength","defaultLanguage","createTextNode","content","formatting","type","metadata","createHeadingNode","level","isToggleable","children","createToggleHeadingNode","createListNode","items","listType","createListItemNode","checked","createCodeNode","language","isBlock","createTableNode","headers","rows","hasColumnHeader","hasRowHeader","columnCount","Math","max","length","map","row","rowCount","createCalloutNode","icon","color","createMediaNode","url","caption","alt","createEquationNode","expression","createQuoteNode","createDividerNode","createToggleNode","createBookmarkNode","title","description","truncateContent","maxLength","truncated","substring","lastSpace","lastIndexOf","isValidUrl","text","urlPattern","test","includes","exports"],"sources":["C:\\Users\\rayan\\Desktop\\Dev\\NotionClipper\\packages\\notion-parser\\src\\parsers\\BaseParser.ts"],"sourcesContent":["import type { ASTNode, ParseOptions } from '../types';\r\n\r\nexport abstract class BaseParser {\r\n  protected options: ParseOptions;\r\n\r\n  constructor(options: ParseOptions = {}) {\r\n    this.options = {\r\n      maxBlocks: 100,\r\n      maxRichTextLength: 2000,\r\n      maxCodeLength: 2000,\r\n      defaultLanguage: 'plain text',\r\n      ...options\r\n    };\r\n  }\r\n\r\n  abstract parse(content: string): ASTNode[];\r\n\r\n  protected createTextNode(content: string, formatting?: any): ASTNode {\r\n    return {\r\n      type: 'text',\r\n      content,\r\n      metadata: { formatting }\r\n    };\r\n  }\r\n\r\n  protected createHeadingNode(content: string, level: 1 | 2 | 3, isToggleable = false): ASTNode {\r\n    return {\r\n      type: 'heading',\r\n      content,\r\n      metadata: { level, isToggleable },\r\n      children: []\r\n    };\r\n  }\r\n\r\n  protected createToggleHeadingNode(content: string, level: 1 | 2 | 3, children: ASTNode[] = []): ASTNode {\r\n    return {\r\n      type: 'heading',\r\n      content,\r\n      metadata: { level, isToggleable: true },\r\n      children\r\n    };\r\n  }\r\n\r\n  protected createListNode(items: ASTNode[], listType: 'bulleted' | 'numbered' | 'todo'): ASTNode {\r\n    return {\r\n      type: 'list',\r\n      children: items,\r\n      metadata: { listType }\r\n    };\r\n  }\r\n\r\n  protected createListItemNode(content: string, listType: 'bulleted' | 'numbered' | 'todo' = 'bulleted', checked?: boolean): ASTNode {\r\n    return {\r\n      type: 'list_item',\r\n      content,\r\n      metadata: {\r\n        listType,\r\n        checked\r\n      }\r\n    };\r\n  }\r\n\r\n  protected createCodeNode(content: string, language?: string, isBlock = false): ASTNode {\r\n    return {\r\n      type: 'code',\r\n      content,\r\n      metadata: {\r\n        language: language || this.options.defaultLanguage,\r\n        isBlock\r\n      }\r\n    };\r\n  }\r\n\r\n  protected createTableNode(headers: string[], rows: string[][], options?: {\r\n    hasColumnHeader?: boolean;\r\n    hasRowHeader?: boolean;\r\n  }): ASTNode {\r\n    return {\r\n      type: 'table',\r\n      content: '',\r\n      metadata: {\r\n        headers,\r\n        rows,\r\n        hasColumnHeader: options?.hasColumnHeader ?? true,\r\n        hasRowHeader: options?.hasRowHeader ?? false,\r\n        columnCount: Math.max(headers.length, ...rows.map(row => row.length)),\r\n        rowCount: rows.length + (options?.hasColumnHeader ? 1 : 0)\r\n      },\r\n      children: []\r\n    };\r\n  }\r\n\r\n  protected createCalloutNode(content: string, icon?: string, color?: string): ASTNode {\r\n    return {\r\n      type: 'callout',\r\n      content,\r\n      metadata: { icon, color }\r\n    };\r\n  }\r\n\r\n  protected createMediaNode(\r\n    type: 'image' | 'video' | 'audio' | 'file',\r\n    url: string,\r\n    caption?: string,\r\n    alt?: string\r\n  ): ASTNode {\r\n    return {\r\n      type,\r\n      metadata: { url, caption, alt }\r\n    };\r\n  }\r\n\r\n  protected createEquationNode(expression: string, isBlock = false): ASTNode {\r\n    return {\r\n      type: 'equation',\r\n      content: expression,\r\n      metadata: { isBlock }\r\n    };\r\n  }\r\n\r\n  protected createQuoteNode(content: string): ASTNode {\r\n    return {\r\n      type: 'quote',\r\n      content\r\n    };\r\n  }\r\n\r\n  protected createDividerNode(): ASTNode {\r\n    return {\r\n      type: 'divider'\r\n    };\r\n  }\r\n\r\n  protected createToggleNode(content: string, children: ASTNode[] = []): ASTNode {\r\n    return {\r\n      type: 'toggle',\r\n      content,\r\n      children\r\n    };\r\n  }\r\n\r\n  protected createBookmarkNode(url: string, title?: string, description?: string): ASTNode {\r\n    return {\r\n      type: 'bookmark',\r\n      metadata: { url, title, description }\r\n    };\r\n  }\r\n\r\n  protected truncateContent(content: string, maxLength: number): string {\r\n    if (content.length <= maxLength) {\r\n      return content;\r\n    }\r\n\r\n    let truncated = content.substring(0, maxLength - 20);\r\n    const lastSpace = truncated.lastIndexOf(' ');\r\n\r\n    if (lastSpace > maxLength * 0.8) {\r\n      truncated = truncated.substring(0, lastSpace);\r\n    }\r\n\r\n    return truncated + '... [tronqu√©]';\r\n  }\r\n\r\n  protected isValidUrl(text: string): boolean {\r\n    try {\r\n      const urlPattern = /^https?:\\/\\/[^\\s<>\"{}|\\\\^`[\\]]+$/;\r\n      return urlPattern.test(text) && text.includes('.');\r\n    } catch {\r\n      return false;\r\n    }\r\n  }\r\n}"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}