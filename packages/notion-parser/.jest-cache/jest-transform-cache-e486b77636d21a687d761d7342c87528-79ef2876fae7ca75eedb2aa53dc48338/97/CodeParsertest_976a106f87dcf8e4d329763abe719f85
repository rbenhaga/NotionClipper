98918648c9903009ed651e80d32d7aee
"use strict";
/**
 * Tests unitaires pour CodeParser - Cahier des Charges v2.1
 * Couvre le parsing de code avec dÃ©tection de langage
 */
Object.defineProperty(exports, "__esModule", { value: true });
const parseContent_1 = require("../../../src/parseContent");
describe('CodeParser - Cahier des Charges v2.1', () => {
    describe('Language Detection', () => {
        it('should detect JavaScript', () => {
            const jsCode = 'function hello() {\n  console.log("Hello World");\n  return true;\n}';
            const result = (0, parseContent_1.parseContent)(jsCode);
            expect(result.success).toBe(true);
            expect(result.blocks).toHaveLength(1);
            expect(result.blocks[0].type).toBe('code');
        });
        it('should detect Python', () => {
            const pythonCode = 'def hello():\n    print("Hello World")\n    return True';
            const result = (0, parseContent_1.parseContent)(pythonCode);
            expect(result.success).toBe(true);
            expect(result.blocks).toHaveLength(1);
            expect(result.blocks[0].type).toBe('code');
        });
        it('should handle empty code blocks', () => {
            const code = '';
            const result = (0, parseContent_1.parseContent)(code);
            expect(result.success).toBe(true);
        });
    });
    describe('Code Block Structure', () => {
        it('should create valid Notion code block structure', () => {
            const code = 'const test = "hello";';
            const result = (0, parseContent_1.parseContent)(code);
            expect(result.success).toBe(true);
            expect(result.blocks.length).toBeGreaterThan(0);
        });
        it('should preserve code formatting and whitespace', () => {
            const code = 'function test() {\n    if (true) {\n        return "indented";\n    }\n}';
            const result = (0, parseContent_1.parseContent)(code);
            expect(result.success).toBe(true);
            expect(result.blocks.length).toBeGreaterThan(0);
        });
    });
    describe('Performance', () => {
        it('should parse large code files efficiently', () => {
            const largeCode = Array(100).fill('function test() { return true; }').join('\n');
            const startTime = Date.now();
            const result = (0, parseContent_1.parseContent)(largeCode);
            const duration = Date.now() - startTime;
            expect(result.success).toBe(true);
            expect(duration).toBeLessThan(1000); // Should be fast
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxyYXlhblxcRGVza3RvcFxcRGV2XFxOb3Rpb25DbGlwcGVyXFxwYWNrYWdlc1xcbm90aW9uLXBhcnNlclxcdGVzdHNcXHVuaXRcXHBhcnNlcnNcXENvZGVQYXJzZXIudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7OztHQUdHOztBQUVILDREQUF5RDtBQUV6RCxRQUFRLENBQUMsc0NBQXNDLEVBQUUsR0FBRyxFQUFFO0lBQ3BELFFBQVEsQ0FBQyxvQkFBb0IsRUFBRSxHQUFHLEVBQUU7UUFDbEMsRUFBRSxDQUFDLDBCQUEwQixFQUFFLEdBQUcsRUFBRTtZQUNsQyxNQUFNLE1BQU0sR0FBRyxzRUFBc0UsQ0FBQztZQUN0RixNQUFNLE1BQU0sR0FBRyxJQUFBLDJCQUFZLEVBQUMsTUFBTSxDQUFDLENBQUM7WUFFcEMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDbEMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDdEMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQzdDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHNCQUFzQixFQUFFLEdBQUcsRUFBRTtZQUM5QixNQUFNLFVBQVUsR0FBRyx5REFBeUQsQ0FBQztZQUM3RSxNQUFNLE1BQU0sR0FBRyxJQUFBLDJCQUFZLEVBQUMsVUFBVSxDQUFDLENBQUM7WUFFeEMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDbEMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDdEMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQzdDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGlDQUFpQyxFQUFFLEdBQUcsRUFBRTtZQUN6QyxNQUFNLElBQUksR0FBRyxFQUFFLENBQUM7WUFDaEIsTUFBTSxNQUFNLEdBQUcsSUFBQSwyQkFBWSxFQUFDLElBQUksQ0FBQyxDQUFDO1lBRWxDLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3BDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsc0JBQXNCLEVBQUUsR0FBRyxFQUFFO1FBQ3BDLEVBQUUsQ0FBQyxpREFBaUQsRUFBRSxHQUFHLEVBQUU7WUFDekQsTUFBTSxJQUFJLEdBQUcsdUJBQXVCLENBQUM7WUFDckMsTUFBTSxNQUFNLEdBQUcsSUFBQSwyQkFBWSxFQUFDLElBQUksQ0FBQyxDQUFDO1lBRWxDLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2xDLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNsRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxnREFBZ0QsRUFBRSxHQUFHLEVBQUU7WUFDeEQsTUFBTSxJQUFJLEdBQUcsMEVBQTBFLENBQUM7WUFDeEYsTUFBTSxNQUFNLEdBQUcsSUFBQSwyQkFBWSxFQUFDLElBQUksQ0FBQyxDQUFDO1lBRWxDLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2xDLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNsRCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGFBQWEsRUFBRSxHQUFHLEVBQUU7UUFDM0IsRUFBRSxDQUFDLDJDQUEyQyxFQUFFLEdBQUcsRUFBRTtZQUNuRCxNQUFNLFNBQVMsR0FBRyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLGtDQUFrQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBRWpGLE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQztZQUM3QixNQUFNLE1BQU0sR0FBRyxJQUFBLDJCQUFZLEVBQUMsU0FBUyxDQUFDLENBQUM7WUFDdkMsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxHQUFHLFNBQVMsQ0FBQztZQUV4QyxNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNsQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsaUJBQWlCO1FBQ3hELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXHJheWFuXFxEZXNrdG9wXFxEZXZcXE5vdGlvbkNsaXBwZXJcXHBhY2thZ2VzXFxub3Rpb24tcGFyc2VyXFx0ZXN0c1xcdW5pdFxccGFyc2Vyc1xcQ29kZVBhcnNlci50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVGVzdHMgdW5pdGFpcmVzIHBvdXIgQ29kZVBhcnNlciAtIENhaGllciBkZXMgQ2hhcmdlcyB2Mi4xXG4gKiBDb3V2cmUgbGUgcGFyc2luZyBkZSBjb2RlIGF2ZWMgZMOpdGVjdGlvbiBkZSBsYW5nYWdlXG4gKi9cblxuaW1wb3J0IHsgcGFyc2VDb250ZW50IH0gZnJvbSAnLi4vLi4vLi4vc3JjL3BhcnNlQ29udGVudCc7XG5cbmRlc2NyaWJlKCdDb2RlUGFyc2VyIC0gQ2FoaWVyIGRlcyBDaGFyZ2VzIHYyLjEnLCAoKSA9PiB7XG4gIGRlc2NyaWJlKCdMYW5ndWFnZSBEZXRlY3Rpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBkZXRlY3QgSmF2YVNjcmlwdCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGpzQ29kZSA9ICdmdW5jdGlvbiBoZWxsbygpIHtcXG4gIGNvbnNvbGUubG9nKFwiSGVsbG8gV29ybGRcIik7XFxuICByZXR1cm4gdHJ1ZTtcXG59JztcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHBhcnNlQ29udGVudChqc0NvZGUpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmJsb2NrcykudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5ibG9ja3NbMF0udHlwZSkudG9CZSgnY29kZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkZXRlY3QgUHl0aG9uJywgKCkgPT4ge1xuICAgICAgY29uc3QgcHl0aG9uQ29kZSA9ICdkZWYgaGVsbG8oKTpcXG4gICAgcHJpbnQoXCJIZWxsbyBXb3JsZFwiKVxcbiAgICByZXR1cm4gVHJ1ZSc7XG4gICAgICBjb25zdCByZXN1bHQgPSBwYXJzZUNvbnRlbnQocHl0aG9uQ29kZSk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuYmxvY2tzKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgICBleHBlY3QocmVzdWx0LmJsb2Nrc1swXS50eXBlKS50b0JlKCdjb2RlJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSBjb2RlIGJsb2NrcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGNvZGUgPSAnJztcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHBhcnNlQ29udGVudChjb2RlKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQ29kZSBCbG9jayBTdHJ1Y3R1cmUnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgdmFsaWQgTm90aW9uIGNvZGUgYmxvY2sgc3RydWN0dXJlJywgKCkgPT4ge1xuICAgICAgY29uc3QgY29kZSA9ICdjb25zdCB0ZXN0ID0gXCJoZWxsb1wiOyc7XG4gICAgICBjb25zdCByZXN1bHQgPSBwYXJzZUNvbnRlbnQoY29kZSk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuYmxvY2tzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwcmVzZXJ2ZSBjb2RlIGZvcm1hdHRpbmcgYW5kIHdoaXRlc3BhY2UnLCAoKSA9PiB7XG4gICAgICBjb25zdCBjb2RlID0gJ2Z1bmN0aW9uIHRlc3QoKSB7XFxuICAgIGlmICh0cnVlKSB7XFxuICAgICAgICByZXR1cm4gXCJpbmRlbnRlZFwiO1xcbiAgICB9XFxufSc7XG4gICAgICBjb25zdCByZXN1bHQgPSBwYXJzZUNvbnRlbnQoY29kZSk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuYmxvY2tzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUGVyZm9ybWFuY2UnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBwYXJzZSBsYXJnZSBjb2RlIGZpbGVzIGVmZmljaWVudGx5JywgKCkgPT4ge1xuICAgICAgY29uc3QgbGFyZ2VDb2RlID0gQXJyYXkoMTAwKS5maWxsKCdmdW5jdGlvbiB0ZXN0KCkgeyByZXR1cm4gdHJ1ZTsgfScpLmpvaW4oJ1xcbicpO1xuICAgICAgXG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gcGFyc2VDb250ZW50KGxhcmdlQ29kZSk7XG4gICAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChkdXJhdGlvbikudG9CZUxlc3NUaGFuKDEwMDApOyAvLyBTaG91bGQgYmUgZmFzdFxuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9