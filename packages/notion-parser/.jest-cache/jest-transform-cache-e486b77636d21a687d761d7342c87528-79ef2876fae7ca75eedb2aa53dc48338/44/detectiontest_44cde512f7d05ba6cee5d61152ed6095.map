{"file":"C:\\Users\\rayan\\Desktop\\Dev\\NotionClipper\\packages\\notion-parser\\tests\\comprehensive\\detection.test.ts","mappings":"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","names":[],"sources":["C:\\Users\\rayan\\Desktop\\Dev\\NotionClipper\\packages\\notion-parser\\tests\\comprehensive\\detection.test.ts"],"sourcesContent":["/**\r\n * Tests complets de détection automatique\r\n * Basé sur le test ultimate exhaustif - Phase 1\r\n */\r\n\r\nimport { parseContent } from '../../src/parseContent';\r\n\r\ndescribe('Content Detection - Phase 1', () => {\r\n  describe('Automatic Content Type Detection', () => {\r\n    it('should detect URLs with high confidence (>0.90)', async () => {\r\n      const content = 'https://www.notion.so';\r\n      const result = parseContent(content, { includeMetadata: true });\r\n      \r\n      expect(result.success).toBe(true);\r\n      expect(result.metadata?.detectedType).toBe('url');\r\n      expect(result.metadata?.confidence).toBeGreaterThan(0.90);\r\n    });\r\n\r\n    it('should detect JavaScript code with good confidence (>0.70)', async () => {\r\n      const content = `function hello() {\r\n  console.log(\"Hello World\");\r\n  return true;\r\n}`;\r\n      const result = parseContent(content, { includeMetadata: true });\r\n      \r\n      expect(result.success).toBe(true);\r\n      \r\n      expect(result.metadata?.detectedType).toBe('code');\r\n      expect(result.metadata?.confidence).toBeGreaterThan(0.70);\r\n    });\r\n\r\n    it('should detect CSV format with good confidence (>0.70)', async () => {\r\n      const content = `Name,Age,City\r\nJohn,30,Paris\r\nJane,25,London`;\r\n      const result = parseContent(content, { includeMetadata: true });\r\n      \r\n      expect(['csv', 'table']).toContain(result.metadata?.detectedType);\r\n      expect(result.metadata?.confidence).toBeGreaterThan(0.70);\r\n    });\r\n\r\n    it('should detect TSV format with good confidence (>0.70)', async () => {\r\n      const content = `Name\\tAge\\tCity\r\nJohn\\t30\\tParis\r\nJane\\t25\\tLondon`;\r\n      const result = parseContent(content, { includeMetadata: true });\r\n      \r\n      expect(['tsv', 'table']).toContain(result.metadata?.detectedType);\r\n      expect(result.metadata?.confidence).toBeGreaterThan(0.70);\r\n    });\r\n\r\n    it('should detect HTML with moderate confidence (>0.50)', async () => {\r\n      const content = `<!DOCTYPE html>\r\n<html>\r\n<head><title>Test</title></head>\r\n<body>\r\n  <p>Content with <strong>bold</strong></p>\r\n</body>\r\n</html>`;\r\n      const result = parseContent(content, { includeMetadata: true });\r\n      \r\n      expect(result.success).toBe(true);\r\n      \r\n      expect(result.metadata?.detectedType).toBe('html');\r\n      expect(result.metadata?.confidence).toBeGreaterThan(0.50);\r\n    });\r\n\r\n    it('should detect LaTeX with moderate confidence (>0.50)', async () => {\r\n      const content = `$\r\n\\\\int_{a}^{b} f(x) \\\\, dx = F(b) - F(a)\r\n$`;\r\n      const result = parseContent(content, { includeMetadata: true });\r\n      \r\n      expect(result.success).toBe(true);\r\n      \r\n      expect(result.metadata?.detectedType).toBe('latex');\r\n      expect(result.metadata?.confidence).toBeGreaterThan(0.50);\r\n    });\r\n\r\n    it('should detect JSON with good confidence (>0.70)', async () => {\r\n      const content = `{\r\n  \"name\": \"John\",\r\n  \"age\": 30,\r\n  \"city\": \"Paris\"\r\n}`;\r\n      const result = parseContent(content, { includeMetadata: true });\r\n      \r\n      expect(result.success).toBe(true);\r\n      \r\n      expect(result.metadata?.detectedType).toBe('json');\r\n      expect(result.metadata?.confidence).toBeGreaterThan(0.70);\r\n    });\r\n\r\n    it('should detect Markdown with moderate confidence (>0.40)', async () => {\r\n      const content = `# Title\r\n**Bold** and *italic*\r\n- List item`;\r\n      const result = parseContent(content, { includeMetadata: true });\r\n      \r\n      expect(result.success).toBe(true);\r\n      \r\n      expect(result.metadata?.detectedType).toBe('markdown');\r\n      expect(result.metadata?.confidence).toBeGreaterThan(0.40);\r\n    });\r\n\r\n    it('should fallback to text with perfect confidence (1.0)', async () => {\r\n      const content = 'Just plain text without any special formatting';\r\n      const result = parseContent(content, { includeMetadata: true });\r\n      \r\n      expect(result.success).toBe(true);\r\n      \r\n      expect(result.metadata?.detectedType).toBe('text');\r\n      expect(result.metadata?.confidence).toBe(1.0);\r\n    });\r\n  });\r\n\r\n  describe('Detection Priority Order', () => {\r\n    it('should prioritize URL detection over other types', async () => {\r\n      const content = 'https://github.com/user/repo.git';\r\n      const result = parseContent(content, { includeMetadata: true });\r\n      \r\n      expect(result.success).toBe(true);\r\n      \r\n      expect(result.metadata?.detectedType).toBe('url');\r\n    });\r\n\r\n    it('should prioritize code detection over markdown for code-like content', async () => {\r\n      const content = `class Example {\r\n  constructor() {\r\n    this.value = 42;\r\n  }\r\n}`;\r\n      const result = parseContent(content, { includeMetadata: true });\r\n      \r\n      expect(result.success).toBe(true);\r\n      \r\n      expect(result.metadata?.detectedType).toBe('code');\r\n    });\r\n  });\r\n\r\n  describe('Edge Cases in Detection', () => {\r\n    it('should handle mixed content appropriately', async () => {\r\n      const content = `# Markdown Title\r\nBut also has function() { code(); }\r\nAnd https://example.com URLs`;\r\n      \r\n      const result = parseContent(content, { includeMetadata: true });\r\n      \r\n      // Should detect as markdown due to header\r\n      expect(['markdown', 'text']).toContain(result.metadata?.detectedType);\r\n    });\r\n\r\n    it('should handle empty content gracefully', async () => {\r\n      const result = parseContent('', { includeMetadata: true });\r\n      \r\n      expect(result.success).toBe(true);\r\n      expect(result.success).toBe(true);\n      expect(result.blocks).toEqual([]);\r\n    });\r\n\r\n    it('should handle whitespace-only content', async () => {\r\n      const result = parseContent('   \\n\\t  \\n  ', { includeMetadata: true });\r\n      \r\n      expect(result.success).toBe(true);\r\n      expect(result.success).toBe(true);\n      expect(result.blocks).toEqual([]);\r\n    });\r\n  });\r\n});"],"version":3}