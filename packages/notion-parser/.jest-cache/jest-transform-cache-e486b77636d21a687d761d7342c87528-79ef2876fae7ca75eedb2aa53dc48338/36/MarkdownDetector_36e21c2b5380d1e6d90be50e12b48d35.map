{"file":"C:\\Users\\rayan\\Desktop\\Dev\\NotionClipper\\packages\\notion-parser\\src\\detectors\\MarkdownDetector.ts","mappings":";;;AAEA,MAAa,gBAAgB;IAC3B,MAAM,CAAC,OAAe;QACpB,IAAI,CAAC,OAAO,EAAE,IAAI,EAAE,EAAE,CAAC;YACrB,OAAO,EAAE,IAAI,EAAE,UAAU,EAAE,UAAU,EAAE,GAAG,EAAE,CAAC;QAC/C,CAAC;QAED,IAAI,UAAU,GAAG,CAAC,CAAC;QACnB,MAAM,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QAElC,qBAAqB;QACrB,MAAM,WAAW,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CACtC,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,CACzB,CAAC,MAAM,CAAC;QACT,IAAI,WAAW,GAAG,CAAC,EAAE,CAAC;YACpB,UAAU,IAAI,IAAI,CAAC,GAAG,CAAC,WAAW,GAAG,GAAG,EAAE,GAAG,CAAC,CAAC;QACjD,CAAC;QAED,mBAAmB;QACnB,MAAM,SAAS,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CACpC,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,CAC7D,CAAC,MAAM,CAAC;QACT,IAAI,SAAS,GAAG,CAAC,EAAE,CAAC;YAClB,UAAU,IAAI,IAAI,CAAC,GAAG,CAAC,SAAS,GAAG,IAAI,EAAE,GAAG,CAAC,CAAC;QAChD,CAAC;QAED,oBAAoB;QACpB,MAAM,UAAU,GAAG,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC;QAC5D,IAAI,UAAU,GAAG,CAAC,EAAE,CAAC;YACnB,UAAU,IAAI,IAAI,CAAC,GAAG,CAAC,UAAU,GAAG,GAAG,EAAE,GAAG,CAAC,CAAC;QAChD,CAAC;QAED,kBAAkB;QAClB,MAAM,UAAU,GAAG,CAAC,OAAO,CAAC,KAAK,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC,CAAC,MAAM,CAAC;QAC5D,IAAI,UAAU,GAAG,CAAC,EAAE,CAAC;YACnB,UAAU,IAAI,IAAI,CAAC,GAAG,CAAC,UAAU,GAAG,IAAI,EAAE,IAAI,CAAC,CAAC;QAClD,CAAC;QAED,gCAAgC;QAChC,MAAM,UAAU,GAAG,CAAC,OAAO,CAAC,KAAK,CAAC,0BAA0B,CAAC,IAAI,EAAE,CAAC,CAAC,MAAM,CAAC;QAC5E,IAAI,UAAU,GAAG,CAAC,EAAE,CAAC;YACnB,UAAU,IAAI,IAAI,CAAC,GAAG,CAAC,UAAU,GAAG,IAAI,EAAE,IAAI,CAAC,CAAC;QAClD,CAAC;QAED,sBAAsB;QACtB,MAAM,KAAK,GAAG,CAAC,OAAO,CAAC,KAAK,CAAC,sBAAsB,CAAC,IAAI,EAAE,CAAC,CAAC,MAAM,CAAC;QACnE,IAAI,KAAK,GAAG,CAAC,EAAE,CAAC;YACd,UAAU,IAAI,IAAI,CAAC,GAAG,CAAC,KAAK,GAAG,GAAG,EAAE,GAAG,CAAC,CAAC;QAC3C,CAAC;QAED,uBAAuB;QACvB,MAAM,MAAM,GAAG,CAAC,OAAO,CAAC,KAAK,CAAC,uBAAuB,CAAC,IAAI,EAAE,CAAC,CAAC,MAAM,CAAC;QACrE,IAAI,MAAM,GAAG,CAAC,EAAE,CAAC;YACf,UAAU,IAAI,IAAI,CAAC,GAAG,CAAC,MAAM,GAAG,IAAI,EAAE,GAAG,CAAC,CAAC;QAC7C,CAAC;QAED,uBAAuB;QACvB,MAAM,UAAU,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CACrC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,GAAG,CAAC,CACjD,CAAC,MAAM,CAAC;QACT,IAAI,UAAU,IAAI,CAAC,EAAE,CAAC;YACpB,UAAU,IAAI,IAAI,CAAC,GAAG,CAAC,UAAU,GAAG,GAAG,EAAE,IAAI,CAAC,CAAC;QACjD,CAAC;QAED,kBAAkB;QAClB,MAAM,UAAU,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CACrC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CACpB,CAAC,MAAM,CAAC;QACT,IAAI,UAAU,GAAG,CAAC,EAAE,CAAC;YACnB,UAAU,IAAI,IAAI,CAAC,GAAG,CAAC,UAAU,GAAG,IAAI,EAAE,IAAI,CAAC,CAAC;QAClD,CAAC;QAED,iCAAiC;QACjC,MAAM,OAAO,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAClC,IAAI,CAAC,KAAK,CAAC,oBAAoB,CAAC,CACjC,CAAC,MAAM,CAAC;QACT,IAAI,OAAO,GAAG,CAAC,EAAE,CAAC;YAChB,UAAU,IAAI,IAAI,CAAC,GAAG,CAAC,OAAO,GAAG,GAAG,EAAE,GAAG,CAAC,CAAC;QAC7C,CAAC;QAED,2BAA2B;QAC3B,MAAM,UAAU,GAAG,CAAC,OAAO,CAAC,KAAK,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC,CAAC,MAAM,CAAC;QAC/D,IAAI,UAAU,GAAG,CAAC,EAAE,CAAC;YACnB,UAAU,IAAI,IAAI,CAAC,GAAG,CAAC,UAAU,GAAG,GAAG,EAAE,GAAG,CAAC,CAAC;QAChD,CAAC;QAED,uEAAuE;QACvE,wCAAwC;QACxC,MAAM,UAAU,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,MAAM,CAAC;QAE5D,IAAI,UAAU,KAAK,CAAC,EAAE,CAAC;YACrB,sBAAsB;YACtB,IAAI,WAAW,KAAK,CAAC,EAAE,CAAC;gBACtB,UAAU,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,CAAC,gBAAgB;YAC1D,CAAC;iBAAM,IAAI,SAAS,KAAK,CAAC,EAAE,CAAC;gBAC3B,UAAU,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,CAAC,mBAAmB;YAC7D,CAAC;iBAAM,IAAI,UAAU,KAAK,CAAC,EAAE,CAAC;gBAC5B,UAAU,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,CAAC,kBAAkB;YAC5D,CAAC;iBAAM,IAAI,KAAK,GAAG,CAAC,IAAI,MAAM,GAAG,CAAC,EAAE,CAAC;gBACnC,UAAU,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,CAAC,wBAAwB;YAClE,CAAC;iBAAM,IAAI,UAAU,GAAG,CAAC,EAAE,CAAC;gBAC1B,UAAU,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC,CAAC,sBAAsB;YAChE,CAAC;QACH,CAAC;aAAM,IAAI,UAAU,IAAI,CAAC,EAAE,CAAC;YAC3B,+CAA+C;YAC/C,IAAI,WAAW,GAAG,CAAC,IAAI,SAAS,GAAG,CAAC,IAAI,UAAU,GAAG,CAAC,EAAE,CAAC;gBACvD,UAAU,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC;YACzC,CAAC;QACH,CAAC;QAED,OAAO;YACL,IAAI,EAAE,UAAU;YAChB,UAAU,EAAE,IAAI,CAAC,GAAG,CAAC,UAAU,EAAE,GAAG,CAAC;YACrC,QAAQ,EAAE;gBACR,QAAQ,EAAE;oBACR,OAAO,EAAE,WAAW;oBACpB,KAAK,EAAE,SAAS;oBAChB,UAAU;oBACV,KAAK;oBACL,MAAM;oBACN,MAAM,EAAE,UAAU,IAAI,CAAC;oBACvB,UAAU;iBACX;aACF;SACF,CAAC;IACJ,CAAC;CACF;AA7HD,4CA6HC","names":[],"sources":["C:\\Users\\rayan\\Desktop\\Dev\\NotionClipper\\packages\\notion-parser\\src\\detectors\\MarkdownDetector.ts"],"sourcesContent":["import type { DetectionResult } from './ContentDetector';\r\n\r\nexport class MarkdownDetector {\r\n  detect(content: string): DetectionResult {\r\n    if (!content?.trim()) {\r\n      return { type: 'markdown', confidence: 0.0 };\r\n    }\r\n\r\n    let confidence = 0;\r\n    const lines = content.split('\\n');\r\n\r\n    // Headers (# ## ###)\r\n    const headerLines = lines.filter(line => \r\n      line.match(/^#{1,6}\\s+/)\r\n    ).length;\r\n    if (headerLines > 0) {\r\n      confidence += Math.min(headerLines * 0.2, 0.4);\r\n    }\r\n\r\n    // Lists (- * + 1.)\r\n    const listLines = lines.filter(line => \r\n      line.match(/^[\\s]*[-*+]\\s+/) || line.match(/^[\\s]*\\d+\\.\\s+/)\r\n    ).length;\r\n    if (listLines > 0) {\r\n      confidence += Math.min(listLines * 0.15, 0.3);\r\n    }\r\n\r\n    // Code blocks (```)\r\n    const codeBlocks = (content.match(/```/g) || []).length / 2;\r\n    if (codeBlocks > 0) {\r\n      confidence += Math.min(codeBlocks * 0.2, 0.3);\r\n    }\r\n\r\n    // Inline code (`)\r\n    const inlineCode = (content.match(/`[^`]+`/g) || []).length;\r\n    if (inlineCode > 0) {\r\n      confidence += Math.min(inlineCode * 0.05, 0.15);\r\n    }\r\n\r\n    // Bold/Italic (**text** *text*)\r\n    const boldItalic = (content.match(/\\*\\*[^*]+\\*\\*|\\*[^*]+\\*/g) || []).length;\r\n    if (boldItalic > 0) {\r\n      confidence += Math.min(boldItalic * 0.08, 0.25);\r\n    }\r\n\r\n    // Links ([text](url))\r\n    const links = (content.match(/\\[[^\\]]+\\]\\([^)]+\\)/g) || []).length;\r\n    if (links > 0) {\r\n      confidence += Math.min(links * 0.1, 0.2);\r\n    }\r\n\r\n    // Images (![alt](url))\r\n    const images = (content.match(/!\\[[^\\]]*\\]\\([^)]+\\)/g) || []).length;\r\n    if (images > 0) {\r\n      confidence += Math.min(images * 0.15, 0.2);\r\n    }\r\n\r\n    // Tables (|col1|col2|)\r\n    const tableLines = lines.filter(line => \r\n      line.includes('|') && line.split('|').length > 2\r\n    ).length;\r\n    if (tableLines >= 2) {\r\n      confidence += Math.min(tableLines * 0.1, 0.25);\r\n    }\r\n\r\n    // Blockquotes (>)\r\n    const quoteLines = lines.filter(line => \r\n      line.match(/^>\\s+/)\r\n    ).length;\r\n    if (quoteLines > 0) {\r\n      confidence += Math.min(quoteLines * 0.08, 0.15);\r\n    }\r\n\r\n    // Horizontal rules (--- *** ___)\r\n    const hrLines = lines.filter(line => \r\n      line.match(/^(---|\\*\\*\\*|___)$/)\r\n    ).length;\r\n    if (hrLines > 0) {\r\n      confidence += Math.min(hrLines * 0.1, 0.1);\r\n    }\r\n\r\n    // Checkboxes (- [ ] - [x])\r\n    const checkboxes = (content.match(/- \\[[x ]\\]/g) || []).length;\r\n    if (checkboxes > 0) {\r\n      confidence += Math.min(checkboxes * 0.1, 0.2);\r\n    }\r\n\r\n    // Special case: single markdown element should be detected as markdown\r\n    // even if confidence is below threshold\r\n    const totalLines = lines.filter(line => line.trim()).length;\r\n    \r\n    if (totalLines === 1) {\r\n      // Single line content\r\n      if (headerLines === 1) {\r\n        confidence = Math.max(confidence, 0.8); // Single header\r\n      } else if (listLines === 1) {\r\n        confidence = Math.max(confidence, 0.7); // Single list item\r\n      } else if (checkboxes === 1) {\r\n        confidence = Math.max(confidence, 0.7); // Single checkbox\r\n      } else if (links > 0 || images > 0) {\r\n        confidence = Math.max(confidence, 0.6); // Contains links/images\r\n      } else if (boldItalic > 0) {\r\n        confidence = Math.max(confidence, 0.5); // Contains formatting\r\n      }\r\n    } else if (totalLines <= 3) {\r\n      // Short content with clear markdown indicators\r\n      if (headerLines > 0 || listLines > 0 || checkboxes > 0) {\r\n        confidence = Math.max(confidence, 0.6);\r\n      }\r\n    }\r\n\r\n    return {\r\n      type: 'markdown',\r\n      confidence: Math.min(confidence, 1.0),\r\n      metadata: {\r\n        features: {\r\n          headers: headerLines,\r\n          lists: listLines,\r\n          codeBlocks,\r\n          links,\r\n          images,\r\n          tables: tableLines >= 2,\r\n          checkboxes\r\n        }\r\n      }\r\n    };\r\n  }\r\n}"],"version":3}