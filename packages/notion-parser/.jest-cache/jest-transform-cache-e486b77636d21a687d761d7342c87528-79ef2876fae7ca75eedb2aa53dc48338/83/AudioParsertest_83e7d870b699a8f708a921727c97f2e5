668ebf03b6bec7ac100165144d73c735
"use strict";
/**
 * Tests unitaires pour AudioParser - Nouvelle fonctionnalité v2.1
 * Couvre la détection et parsing des URLs audio selon le cahier des charges
 */
Object.defineProperty(exports, "__esModule", { value: true });
const parseContent_1 = require("../../../src/parseContent");
describe('AudioParser - Nouvelle fonctionnalité v2.1 ⭐', () => {
    describe('Audio URL Detection and Parsing', () => {
        it('should parse MP3 audio URL correctly', () => {
            const audioUrl = 'https://example.com/podcast.mp3';
            const result = (0, parseContent_1.parseContent)(audioUrl);
            expect(result.success).toBe(true);
            expect(result.blocks).toHaveLength(1);
            const audioBlock = result.blocks[0];
            expect(audioBlock.type).toBe('audio');
            expect(audioBlock.audio.type).toBe('external');
            expect(audioBlock.audio.external.url).toBe(audioUrl);
        });
        it('should support all audio formats from cahier des charges', () => {
            const supportedFormats = ['mp3', 'wav', 'ogg', 'oga', 'm4a', 'aac', 'flac', 'webm'];
            supportedFormats.forEach(format => {
                const audioUrl = `https://example.com/audio.${format}`;
                const result = (0, parseContent_1.parseContent)(audioUrl);
                expect(result.success).toBe(true);
                expect(result.blocks).toHaveLength(1);
                const audioBlock = result.blocks[0];
                expect(audioBlock.type).toBe('audio');
                expect(audioBlock.audio.external.url).toBe(audioUrl);
            });
        });
        it('should parse multiple audio URLs', () => {
            const content = `https://example.com/song1.mp3
https://example.com/song2.wav
https://example.com/podcast.ogg`;
            const result = (0, parseContent_1.parseContent)(content);
            expect(result.success).toBe(true);
            expect(result.blocks).toHaveLength(3);
            result.blocks.forEach((block) => {
                expect(block.type).toBe('audio');
                expect(block.audio.type).toBe('external');
                expect(block.audio.external.url).toMatch(/\.(mp3|wav|ogg)$/);
            });
        });
        it('should handle audio streaming platform URLs', () => {
            const streamingUrls = [
                'https://soundcloud.com/user/track-name',
                'https://open.spotify.com/track/123456',
                'https://music.youtube.com/watch?v=abcdef',
                'https://bandcamp.com/track/song-name'
            ];
            streamingUrls.forEach(url => {
                const result = (0, parseContent_1.parseContent)(url);
                expect(result.success).toBe(true);
                expect(result.blocks).toHaveLength(1);
                // Streaming URLs should be bookmarks, not direct audio
                const block = result.blocks[0];
                expect(['bookmark', 'audio']).toContain(block.type);
            });
        });
    });
    describe('Audio Block Structure Validation', () => {
        it('should create valid Notion audio block structure', () => {
            const audioUrl = 'https://example.com/test.mp3';
            const result = (0, parseContent_1.parseContent)(audioUrl);
            const audioBlock = result.blocks[0];
            // Validate block structure according to Notion API
            expect(audioBlock).toMatchObject({
                type: 'audio',
                audio: {
                    type: 'external',
                    external: {
                        url: audioUrl
                    },
                    caption: expect.any(Array)
                }
            });
        });
        it('should include empty caption array by default', () => {
            const audioUrl = 'https://example.com/test.wav';
            const result = (0, parseContent_1.parseContent)(audioUrl);
            const audioBlock = result.blocks[0];
            expect(audioBlock.audio.caption).toEqual([]);
        });
        it('should handle audio URLs with query parameters', () => {
            const audioUrl = 'https://example.com/audio.mp3?version=1&quality=high';
            const result = (0, parseContent_1.parseContent)(audioUrl);
            expect(result.success).toBe(true);
            const audioBlock = result.blocks[0];
            expect(audioBlock.audio.external.url).toBe(audioUrl);
        });
        it('should handle audio URLs with fragments', () => {
            const audioUrl = 'https://example.com/audio.mp3#t=30';
            const result = (0, parseContent_1.parseContent)(audioUrl);
            expect(result.success).toBe(true);
            const audioBlock = result.blocks[0];
            expect(audioBlock.audio.external.url).toBe(audioUrl);
        });
    });
    describe('Audio Format Validation', () => {
        it('should reject non-audio URLs', () => {
            const nonAudioUrls = [
                'https://example.com/image.jpg',
                'https://example.com/video.mp4',
                'https://example.com/document.pdf',
                'https://example.com/text.txt'
            ];
            nonAudioUrls.forEach(url => {
                const result = (0, parseContent_1.parseContent)(url);
                expect(result.success).toBe(true);
                const block = result.blocks[0];
                expect(block.type).not.toBe('audio');
            });
        });
        it('should handle case-insensitive audio extensions', () => {
            const audioUrls = [
                'https://example.com/audio.MP3',
                'https://example.com/audio.WAV',
                'https://example.com/audio.OGG'
            ];
            audioUrls.forEach(url => {
                const result = (0, parseContent_1.parseContent)(url);
                expect(result.success).toBe(true);
                const block = result.blocks[0];
                expect(block.type).toBe('audio');
            });
        });
        it('should validate URL format strictly', () => {
            const invalidUrls = [
                'not-a-url.mp3',
                'ftp://example.com/audio.mp3',
                'file:///local/audio.mp3',
                'javascript:alert("xss").mp3'
            ];
            invalidUrls.forEach(url => {
                const result = (0, parseContent_1.parseContent)(url);
                // Should not create audio blocks for invalid URLs
                if (result.blocks.length > 0) {
                    const block = result.blocks[0];
                    expect(block.type).not.toBe('audio');
                }
            });
        });
    });
    describe('Audio Detection Options', () => {
        it('should handle audio URL detection', () => {
            const audioUrl = 'https://example.com/test.mp3';
            const result = (0, parseContent_1.parseContent)(audioUrl);
            expect(result.success).toBe(true);
            expect(result.blocks).toHaveLength(1);
            expect(result.blocks[0].type).toBe('audio');
        });
        it('should handle audio conversion options', () => {
            const audioUrl = 'https://example.com/test.mp3';
            const result = (0, parseContent_1.parseContent)(audioUrl, {
                conversion: { convertImages: true }
            });
            expect(result.success).toBe(true);
            expect(result.blocks).toHaveLength(1);
        });
    });
    describe('Audio Security Validation', () => {
        it('should block malicious audio URLs', () => {
            const maliciousUrls = [
                'javascript:alert("xss").mp3',
                'data:audio/mp3;base64,malicious',
                'file:///etc/passwd.mp3'
            ];
            maliciousUrls.forEach(url => {
                const result = (0, parseContent_1.parseContent)(url);
                // Should not create audio blocks for malicious URLs
                if (result.blocks.length > 0) {
                    const block = result.blocks[0];
                    expect(block.type).not.toBe('audio');
                }
            });
        });
        it('should validate audio URL length limits', () => {
            const longUrl = 'https://example.com/' + 'a'.repeat(2000) + '.mp3';
            const result = (0, parseContent_1.parseContent)(longUrl);
            // Should handle gracefully (may create bookmark instead)
            expect(result.success).toBe(true);
        });
        it('should handle audio URLs with special characters', () => {
            const specialUrls = [
                'https://example.com/audio%20with%20spaces.mp3',
                'https://example.com/audio-with-dashes.mp3',
                'https://example.com/audio_with_underscores.mp3',
                'https://example.com/audio.with.dots.mp3'
            ];
            specialUrls.forEach(url => {
                const result = (0, parseContent_1.parseContent)(url);
                expect(result.success).toBe(true);
                if (result.blocks.length > 0) {
                    const block = result.blocks[0];
                    expect(['audio', 'bookmark']).toContain(block.type);
                }
            });
        });
    });
    describe('Audio Metadata and Performance', () => {
        it('should include audio metadata in detection result', () => {
            const audioUrl = 'https://example.com/podcast.mp3';
            const result = (0, parseContent_1.parseContent)(audioUrl, { includeMetadata: true });
            expect(result.metadata).toBeDefined();
            expect(result.metadata?.detectedType).toBe('url');
        });
        it('should parse audio URLs efficiently', () => {
            const audioUrls = Array(100).fill(0).map((_, i) => `https://example.com/audio${i}.mp3`).join('\n');
            const startTime = Date.now();
            const result = (0, parseContent_1.parseContent)(audioUrls);
            const processingTime = Date.now() - startTime;
            expect(result.success).toBe(true);
            expect(result.blocks).toHaveLength(100);
            expect(processingTime).toBeLessThan(100); // Should be fast
        });
        it('should handle concurrent audio parsing', () => {
            const audioUrls = [
                'https://example.com/song1.mp3',
                'https://example.com/song2.wav',
                'https://example.com/song3.ogg'
            ];
            const results = audioUrls.map(url => (0, parseContent_1.parseContent)(url));
            results.forEach(result => {
                expect(result.success).toBe(true);
                expect(result.blocks).toHaveLength(1);
            });
        });
    });
    describe('Audio Integration with Other Content Types', () => {
        it('should handle mixed content with audio URLs', () => {
            const mixedContent = `# My Playlist

Here are some great songs:

https://example.com/song1.mp3
https://example.com/song2.wav

**Description**: These are my favorite tracks.`;
            const result = (0, parseContent_1.parseContent)(mixedContent, { contentType: 'markdown' });
            expect(result.success).toBe(true);
            expect(result.blocks.length).toBeGreaterThan(1);
            // Should contain both text and audio blocks
            const blockTypes = result.blocks.map((block) => block.type);
            expect(blockTypes).toContain('heading_1');
            expect(blockTypes).toContain('paragraph');
        });
        it('should preserve audio URLs in markdown links', () => {
            const markdownWithAudio = '[Listen to this song](https://example.com/song.mp3)';
            const result = (0, parseContent_1.parseContent)(markdownWithAudio, { contentType: 'markdown' });
            expect(result.success).toBe(true);
            expect(result.blocks).toHaveLength(1);
            const paragraph = result.blocks[0];
            expect(paragraph.type).toBe('paragraph');
            expect(paragraph.paragraph.rich_text[0].href).toBe('https://example.com/song.mp3');
        });
    });
    describe('Audio Error Handling', () => {
        it('should handle malformed audio content gracefully', () => {
            const malformedContent = 'https://example.com/audio.mp3 but this is broken';
            const result = (0, parseContent_1.parseContent)(malformedContent);
            expect(result.success).toBe(true);
            // Should handle as text or mixed content
            expect(result.blocks.length).toBeGreaterThan(0);
        });
        it('should provide meaningful error messages for invalid audio', () => {
            const invalidAudio = 'not-an-audio-url';
            const result = (0, parseContent_1.parseContent)(invalidAudio);
            expect(result.success).toBe(true);
            expect(result.blocks[0].type).toBe('paragraph'); // Should fallback to text
        });
        it('should handle empty audio URLs', () => {
            const emptyUrl = '';
            const result = (0, parseContent_1.parseContent)(emptyUrl);
            expect(result.success).toBe(true);
            expect(result.blocks).toEqual([]);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxyYXlhblxcRGVza3RvcFxcRGV2XFxOb3Rpb25DbGlwcGVyXFxwYWNrYWdlc1xcbm90aW9uLXBhcnNlclxcdGVzdHNcXHVuaXRcXHBhcnNlcnNcXEF1ZGlvUGFyc2VyLnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7R0FHRzs7QUFFSCw0REFBeUQ7QUFHekQsUUFBUSxDQUFDLDhDQUE4QyxFQUFFLEdBQUcsRUFBRTtJQUM1RCxRQUFRLENBQUMsaUNBQWlDLEVBQUUsR0FBRyxFQUFFO1FBQy9DLEVBQUUsQ0FBQyxzQ0FBc0MsRUFBRSxHQUFHLEVBQUU7WUFDOUMsTUFBTSxRQUFRLEdBQUcsaUNBQWlDLENBQUM7WUFDbkQsTUFBTSxNQUFNLEdBQUcsSUFBQSwyQkFBWSxFQUFDLFFBQVEsQ0FBQyxDQUFDO1lBRXRDLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2xDLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBRXRDLE1BQU0sVUFBVSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFRLENBQUM7WUFDM0MsTUFBTSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDdEMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBQy9DLE1BQU0sQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDdkQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsMERBQTBELEVBQUUsR0FBRyxFQUFFO1lBQ2xFLE1BQU0sZ0JBQWdCLEdBQUcsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLEVB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QUFHLEVBQUUsQ0FBQztZQUNwQixNQUFNLE1BQU0sR0FBRyxJQUFBLDJCQUFZLEVBQUMsUUFBUSxDQUFDLENBQUM7WUFFdEMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDbEMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDcEMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xccmF5YW5cXERlc2t0b3BcXERldlxcTm90aW9uQ2xpcHBlclxccGFja2FnZXNcXG5vdGlvbi1wYXJzZXJcXHRlc3RzXFx1bml0XFxwYXJzZXJzXFxBdWRpb1BhcnNlci50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVGVzdHMgdW5pdGFpcmVzIHBvdXIgQXVkaW9QYXJzZXIgLSBOb3V2ZWxsZSBmb25jdGlvbm5hbGl0w6kgdjIuMVxuICogQ291dnJlIGxhIGTDqXRlY3Rpb24gZXQgcGFyc2luZyBkZXMgVVJMcyBhdWRpbyBzZWxvbiBsZSBjYWhpZXIgZGVzIGNoYXJnZXNcbiAqL1xuXG5pbXBvcnQgeyBwYXJzZUNvbnRlbnQgfSBmcm9tICcuLi8uLi8uLi9zcmMvcGFyc2VDb250ZW50JztcbmltcG9ydCB0eXBlIHsgTm90aW9uQmxvY2sgfSBmcm9tICcuLi8uLi8uLi9zcmMvdHlwZXMnO1xuXG5kZXNjcmliZSgnQXVkaW9QYXJzZXIgLSBOb3V2ZWxsZSBmb25jdGlvbm5hbGl0w6kgdjIuMSDirZAnLCAoKSA9PiB7XG4gIGRlc2NyaWJlKCdBdWRpbyBVUkwgRGV0ZWN0aW9uIGFuZCBQYXJzaW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcGFyc2UgTVAzIGF1ZGlvIFVSTCBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgICBjb25zdCBhdWRpb1VybCA9ICdodHRwczovL2V4YW1wbGUuY29tL3BvZGNhc3QubXAzJztcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHBhcnNlQ29udGVudChhdWRpb1VybCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuYmxvY2tzKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgICBcbiAgICAgIGNvbnN0IGF1ZGlvQmxvY2sgPSByZXN1bHQuYmxvY2tzWzBdIGFzIGFueTtcbiAgICAgIGV4cGVjdChhdWRpb0Jsb2NrLnR5cGUpLnRvQmUoJ2F1ZGlvJyk7XG4gICAgICBleHBlY3QoYXVkaW9CbG9jay5hdWRpby50eXBlKS50b0JlKCdleHRlcm5hbCcpO1xuICAgICAgZXhwZWN0KGF1ZGlvQmxvY2suYXVkaW8uZXh0ZXJuYWwudXJsKS50b0JlKGF1ZGlvVXJsKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc3VwcG9ydCBhbGwgYXVkaW8gZm9ybWF0cyBmcm9tIGNhaGllciBkZXMgY2hhcmdlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IHN1cHBvcnRlZEZvcm1hdHMgPSBbJ21wMycsICd3YXYnLCAnb2dnJywgJ29nYScsICdtNGEnLCAnYWFjJywgJ2ZsYWMnLCAnd2VibSddO1xuICAgICAgXG4gICAgICBzdXBwb3J0ZWRGb3JtYXRzLmZvckVhY2goZm9ybWF0ID0+IHtcbiAgICAgICAgY29uc3QgYXVkaW9VcmwgPSBgaHR0cHM6Ly9leGFtcGxlLmNvbS9hdWRpby4ke2Zvcm1hdH1gO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBwYXJzZUNvbnRlbnQoYXVkaW9VcmwpO1xuICAgICAgICBcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmJsb2NrcykudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgYXVkaW9CbG9jayA9IHJlc3VsdC5ibG9ja3NbMF0gYXMgYW55O1xuICAgICAgICBleHBlY3QoYXVkaW9CbG9jay50eXBlKS50b0JlKCdhdWRpbycpO1xuICAgICAgICBleHBlY3QoYXVkaW9CbG9jay5hdWRpby5leHRlcm5hbC51cmwpLnRvQmUoYXVkaW9VcmwpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHBhcnNlIG11bHRpcGxlIGF1ZGlvIFVSTHMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBjb250ZW50ID0gYGh0dHBzOi8vZXhhbXBsZS5jb20vc29uZzEubXAzXG5odHRwczovL2V4YW1wbGUuY29tL3NvbmcyLndhdlxuaHR0cHM6Ly9leGFtcGxlLmNvbS9wb2RjYXN0Lm9nZ2A7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHBhcnNlQ29udGVudChjb250ZW50KTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5ibG9ja3MpLnRvSGF2ZUxlbmd0aCgzKTtcbiAgICAgIFxuICAgICAgcmVzdWx0LmJsb2Nrcy5mb3JFYWNoKChibG9jazogYW55KSA9PiB7XG4gICAgICAgIGV4cGVjdChibG9jay50eXBlKS50b0JlKCdhdWRpbycpO1xuICAgICAgICBleHBlY3QoYmxvY2suYXVkaW8udHlwZSkudG9CZSgnZXh0ZXJuYWwnKTtcbiAgICAgICAgZXhwZWN0KGJsb2NrLmF1ZGlvLmV4dGVybmFsLnVybCkudG9NYXRjaCgvXFwuKG1wM3x3YXZ8b2dnKSQvKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgYXVkaW8gc3RyZWFtaW5nIHBsYXRmb3JtIFVSTHMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBzdHJlYW1pbmdVcmxzID0gW1xuICAgICAgICAnaHR0cHM6Ly9zb3VuZGNsb3VkLmNvbS91c2VyL3RyYWNrLW5hbWUnLFxuICAgICAgICAnaHR0cHM6Ly9vcGVuLnNwb3RpZnkuY29tL3RyYWNrLzEyMzQ1NicsXG4gICAgICAgICdodHRwczovL211c2ljLnlvdXR1YmUuY29tL3dhdGNoP3Y9YWJjZGVmJyxcbiAgICAgICAgJ2h0dHBzOi8vYmFuZGNhbXAuY29tL3RyYWNrL3NvbmctbmFtZSdcbiAgICAgIF07XG4gICAgICBcbiAgICAgIHN0cmVhbWluZ1VybHMuZm9yRWFjaCh1cmwgPT4ge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBwYXJzZUNvbnRlbnQodXJsKTtcbiAgICAgICAgXG4gICAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5ibG9ja3MpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFN0cmVhbWluZyBVUkxzIHNob3VsZCBiZSBib29rbWFya3MsIG5vdCBkaXJlY3QgYXVkaW9cbiAgICAgICAgY29uc3QgYmxvY2sgPSByZXN1bHQuYmxvY2tzWzBdIGFzIGFueTtcbiAgICAgICAgZXhwZWN0KFsnYm9va21hcmsnLCAnYXVkaW8nXSkudG9Db250YWluKGJsb2NrLnR5cGUpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdBdWRpbyBCbG9jayBTdHJ1Y3R1cmUgVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSB2YWxpZCBOb3Rpb24gYXVkaW8gYmxvY2sgc3RydWN0dXJlJywgKCkgPT4ge1xuICAgICAgY29uc3QgYXVkaW9VcmwgPSAnaHR0cHM6Ly9leGFtcGxlLmNvbS90ZXN0Lm1wMyc7XG4gICAgICBjb25zdCByZXN1bHQgPSBwYXJzZUNvbnRlbnQoYXVkaW9VcmwpO1xuICAgICAgXG4gICAgICBjb25zdCBhdWRpb0Jsb2NrID0gcmVzdWx0LmJsb2Nrc1swXSBhcyBhbnk7XG4gICAgICBcbiAgICAgIC8vIFZhbGlkYXRlIGJsb2NrIHN0cnVjdHVyZSBhY2NvcmRpbmcgdG8gTm90aW9uIEFQSVxuICAgICAgZXhwZWN0KGF1ZGlvQmxvY2spLnRvTWF0Y2hPYmplY3Qoe1xuICAgICAgICB0eXBlOiAnYXVkaW8nLFxuICAgICAgICBhdWRpbzoge1xuICAgICAgICAgIHR5cGU6ICdleHRlcm5hbCcsXG4gICAgICAgICAgZXh0ZXJuYWw6IHtcbiAgICAgICAgICAgIHVybDogYXVkaW9VcmxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNhcHRpb246IGV4cGVjdC5hbnkoQXJyYXkpXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBpbmNsdWRlIGVtcHR5IGNhcHRpb24gYXJyYXkgYnkgZGVmYXVsdCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGF1ZGlvVXJsID0gJ2h0dHBzOi8vZXhhbXBsZS5jb20vdGVzdC53YXYnO1xuICAgICAgY29uc3QgcmVzdWx0ID0gcGFyc2VDb250ZW50KGF1ZGlvVXJsKTtcbiAgICAgIFxuICAgICAgY29uc3QgYXVkaW9CbG9jayA9IHJlc3VsdC5ibG9ja3NbMF0gYXMgYW55O1xuICAgICAgZXhwZWN0KGF1ZGlvQmxvY2suYXVkaW8uY2FwdGlvbikudG9FcXVhbChbXSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBhdWRpbyBVUkxzIHdpdGggcXVlcnkgcGFyYW1ldGVycycsICgpID0+IHtcbiAgICAgIGNvbnN0IGF1ZGlvVXJsID0gJ2h0dHBzOi8vZXhhbXBsZS5jb20vYXVkaW8ubXAzP3ZlcnNpb249MSZxdWFsaXR5PWhpZ2gnO1xuICAgICAgY29uc3QgcmVzdWx0ID0gcGFyc2VDb250ZW50KGF1ZGlvVXJsKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgY29uc3QgYXVkaW9CbG9jayA9IHJlc3VsdC5ibG9ja3NbMF0gYXMgYW55O1xuICAgICAgZXhwZWN0KGF1ZGlvQmxvY2suYXVkaW8uZXh0ZXJuYWwudXJsKS50b0JlKGF1ZGlvVXJsKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGF1ZGlvIFVSTHMgd2l0aCBmcmFnbWVudHMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBhdWRpb1VybCA9ICdodHRwczovL2V4YW1wbGUuY29tL2F1ZGlvLm1wMyN0PTMwJztcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHBhcnNlQ29udGVudChhdWRpb1VybCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGNvbnN0IGF1ZGlvQmxvY2sgPSByZXN1bHQuYmxvY2tzWzBdIGFzIGFueTtcbiAgICAgIGV4cGVjdChhdWRpb0Jsb2NrLmF1ZGlvLmV4dGVybmFsLnVybCkudG9CZShhdWRpb1VybCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdBdWRpbyBGb3JtYXQgVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJlamVjdCBub24tYXVkaW8gVVJMcycsICgpID0+IHtcbiAgICAgIGNvbnN0IG5vbkF1ZGlvVXJscyA9IFtcbiAgICAgICAgJ2h0dHBzOi8vZXhhbXBsZS5jb20vaW1hZ2UuanBnJyxcbiAgICAgICAgJ2h0dHBzOi8vZXhhbXBsZS5jb20vdmlkZW8ubXA0JyxcbiAgICAgICAgJ2h0dHBzOi8vZXhhbXBsZS5jb20vZG9jdW1lbnQucGRmJyxcbiAgICAgICAgJ2h0dHBzOi8vZXhhbXBsZS5jb20vdGV4dC50eHQnXG4gICAgICBdO1xuICAgICAgXG4gICAgICBub25BdWRpb1VybHMuZm9yRWFjaCh1cmwgPT4ge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBwYXJzZUNvbnRlbnQodXJsKTtcbiAgICAgICAgXG4gICAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgICAgY29uc3QgYmxvY2sgPSByZXN1bHQuYmxvY2tzWzBdIGFzIGFueTtcbiAgICAgICAgZXhwZWN0KGJsb2NrLnR5cGUpLm5vdC50b0JlKCdhdWRpbycpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjYXNlLWluc2Vuc2l0aXZlIGF1ZGlvIGV4dGVuc2lvbnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBhdWRpb1VybHMgPSBbXG4gICAgICAgICdodHRwczovL2V4YW1wbGUuY29tL2F1ZGlvLk1QMycsXG4gICAgICAgICdodHRwczovL2V4YW1wbGUuY29tL2F1ZGlvLldBVicsXG4gICAgICAgICdodHRwczovL2V4YW1wbGUuY29tL2F1ZGlvLk9HRydcbiAgICAgIF07XG4gICAgICBcbiAgICAgIGF1ZGlvVXJscy5mb3JFYWNoKHVybCA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHBhcnNlQ29udGVudCh1cmwpO1xuICAgICAgICBcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgICBjb25zdCBibG9jayA9IHJlc3VsdC5ibG9ja3NbMF0gYXMgYW55O1xuICAgICAgICBleHBlY3QoYmxvY2sudHlwZSkudG9CZSgnYXVkaW8nKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBVUkwgZm9ybWF0IHN0cmljdGx5JywgKCkgPT4ge1xuICAgICAgY29uc3QgaW52YWxpZFVybHMgPSBbXG4gICAgICAgICdub3QtYS11cmwubXAzJyxcbiAgICAgICAgJ2Z0cDovL2V4YW1wbGUuY29tL2F1ZGlvLm1wMycsXG4gICAgICAgICdmaWxlOi8vL2xvY2FsL2F1ZGlvLm1wMycsXG4gICAgICAgICdqYXZhc2NyaXB0OmFsZXJ0KFwieHNzXCIpLm1wMydcbiAgICAgIF07XG4gICAgICBcbiAgICAgIGludmFsaWRVcmxzLmZvckVhY2godXJsID0+IHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gcGFyc2VDb250ZW50KHVybCk7XG4gICAgICAgIFxuICAgICAgICAvLyBTaG91bGQgbm90IGNyZWF0ZSBhdWRpbyBibG9ja3MgZm9yIGludmFsaWQgVVJMc1xuICAgICAgICBpZiAocmVzdWx0LmJsb2Nrcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgY29uc3QgYmxvY2sgPSByZXN1bHQuYmxvY2tzWzBdIGFzIGFueTtcbiAgICAgICAgICBleHBlY3QoYmxvY2sudHlwZSkubm90LnRvQmUoJ2F1ZGlvJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQXVkaW8gRGV0ZWN0aW9uIE9wdGlvbnMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgYXVkaW8gVVJMIGRldGVjdGlvbicsICgpID0+IHtcbiAgICAgIGNvbnN0IGF1ZGlvVXJsID0gJ2h0dHBzOi8vZXhhbXBsZS5jb20vdGVzdC5tcDMnO1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBwYXJzZUNvbnRlbnQoYXVkaW9VcmwpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmJsb2NrcykudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5ibG9ja3NbMF0udHlwZSkudG9CZSgnYXVkaW8nKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGF1ZGlvIGNvbnZlcnNpb24gb3B0aW9ucycsICgpID0+IHtcbiAgICAgIGNvbnN0IGF1ZGlvVXJsID0gJ2h0dHBzOi8vZXhhbXBsZS5jb20vdGVzdC5tcDMnO1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBwYXJzZUNvbnRlbnQoYXVkaW9VcmwsIHtcbiAgICAgICAgY29udmVyc2lvbjogeyBjb252ZXJ0SW1hZ2VzOiB0cnVlIH1cbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmJsb2NrcykudG9IYXZlTGVuZ3RoKDEpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQXVkaW8gU2VjdXJpdHkgVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGJsb2NrIG1hbGljaW91cyBhdWRpbyBVUkxzJywgKCkgPT4ge1xuICAgICAgY29uc3QgbWFsaWNpb3VzVXJscyA9IFtcbiAgICAgICAgJ2phdmFzY3JpcHQ6YWxlcnQoXCJ4c3NcIikubXAzJyxcbiAgICAgICAgJ2RhdGE6YXVkaW8vbXAzO2Jhc2U2NCxtYWxpY2lvdXMnLFxuICAgICAgICAnZmlsZTovLy9ldGMvcGFzc3dkLm1wMydcbiAgICAgIF07XG4gICAgICBcbiAgICAgIG1hbGljaW91c1VybHMuZm9yRWFjaCh1cmwgPT4ge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBwYXJzZUNvbnRlbnQodXJsKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFNob3VsZCBub3QgY3JlYXRlIGF1ZGlvIGJsb2NrcyBmb3IgbWFsaWNpb3VzIFVSTHNcbiAgICAgICAgaWYgKHJlc3VsdC5ibG9ja3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGNvbnN0IGJsb2NrID0gcmVzdWx0LmJsb2Nrc1swXSBhcyBhbnk7XG4gICAgICAgICAgZXhwZWN0KGJsb2NrLnR5cGUpLm5vdC50b0JlKCdhdWRpbycpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgYXVkaW8gVVJMIGxlbmd0aCBsaW1pdHMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBsb25nVXJsID0gJ2h0dHBzOi8vZXhhbXBsZS5jb20vJyArICdhJy5yZXBlYXQoMjAwMCkgKyAnLm1wMyc7XG4gICAgICBjb25zdCByZXN1bHQgPSBwYXJzZUNvbnRlbnQobG9uZ1VybCk7XG4gICAgICBcbiAgICAgIC8vIFNob3VsZCBoYW5kbGUgZ3JhY2VmdWxseSAobWF5IGNyZWF0ZSBib29rbWFyayBpbnN0ZWFkKVxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgYXVkaW8gVVJMcyB3aXRoIHNwZWNpYWwgY2hhcmFjdGVycycsICgpID0+IHtcbiAgICAgIGNvbnN0IHNwZWNpYWxVcmxzID0gW1xuICAgICAgICAnaHR0cHM6Ly9leGFtcGxlLmNvbS9hdWRpbyUyMHdpdGglMjBzcGFjZXMubXAzJyxcbiAgICAgICAgJ2h0dHBzOi8vZXhhbXBsZS5jb20vYXVkaW8td2l0aC1kYXNoZXMubXAzJyxcbiAgICAgICAgJ2h0dHBzOi8vZXhhbXBsZS5jb20vYXVkaW9fd2l0aF91bmRlcnNjb3Jlcy5tcDMnLFxuICAgICAgICAnaHR0cHM6Ly9leGFtcGxlLmNvbS9hdWRpby53aXRoLmRvdHMubXAzJ1xuICAgICAgXTtcbiAgICAgIFxuICAgICAgc3BlY2lhbFVybHMuZm9yRWFjaCh1cmwgPT4ge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBwYXJzZUNvbnRlbnQodXJsKTtcbiAgICAgICAgXG4gICAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgICAgaWYgKHJlc3VsdC5ibG9ja3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGNvbnN0IGJsb2NrID0gcmVzdWx0LmJsb2Nrc1swXSBhcyBhbnk7XG4gICAgICAgICAgZXhwZWN0KFsnYXVkaW8nLCAnYm9va21hcmsnXSkudG9Db250YWluKGJsb2NrLnR5cGUpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0F1ZGlvIE1ldGFkYXRhIGFuZCBQZXJmb3JtYW5jZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGluY2x1ZGUgYXVkaW8gbWV0YWRhdGEgaW4gZGV0ZWN0aW9uIHJlc3VsdCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGF1ZGlvVXJsID0gJ2h0dHBzOi8vZXhhbXBsZS5jb20vcG9kY2FzdC5tcDMnO1xuICAgICAgY29uc3QgcmVzdWx0ID0gcGFyc2VDb250ZW50KGF1ZGlvVXJsLCB7IGluY2x1ZGVNZXRhZGF0YTogdHJ1ZSB9KTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5tZXRhZGF0YSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQubWV0YWRhdGE/LmRldGVjdGVkVHlwZSkudG9CZSgndXJsJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHBhcnNlIGF1ZGlvIFVSTHMgZWZmaWNpZW50bHknLCAoKSA9PiB7XG4gICAgICBjb25zdCBhdWRpb1VybHMgPSBBcnJheSgxMDApLmZpbGwoMCkubWFwKChfLCBpKSA9PiBcbiAgICAgICAgYGh0dHBzOi8vZXhhbXBsZS5jb20vYXVkaW8ke2l9Lm1wM2BcbiAgICAgICkuam9pbignXFxuJyk7XG4gICAgICBcbiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgICBjb25zdCByZXN1bHQgPSBwYXJzZUNvbnRlbnQoYXVkaW9VcmxzKTtcbiAgICAgIGNvbnN0IHByb2Nlc3NpbmdUaW1lID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5ibG9ja3MpLnRvSGF2ZUxlbmd0aCgxMDApO1xuICAgICAgZXhwZWN0KHByb2Nlc3NpbmdUaW1lKS50b0JlTGVzc1RoYW4oMTAwKTsgLy8gU2hvdWxkIGJlIGZhc3RcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbmN1cnJlbnQgYXVkaW8gcGFyc2luZycsICgpID0+IHtcbiAgICAgIGNvbnN0IGF1ZGlvVXJscyA9IFtcbiAgICAgICAgJ2h0dHBzOi8vZXhhbXBsZS5jb20vc29uZzEubXAzJyxcbiAgICAgICAgJ2h0dHBzOi8vZXhhbXBsZS5jb20vc29uZzIud2F2JyxcbiAgICAgICAgJ2h0dHBzOi8vZXhhbXBsZS5jb20vc29uZzMub2dnJ1xuICAgICAgXTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzdWx0cyA9IGF1ZGlvVXJscy5tYXAodXJsID0+IHBhcnNlQ29udGVudCh1cmwpKTtcbiAgICAgIFxuICAgICAgcmVzdWx0cy5mb3JFYWNoKHJlc3VsdCA9PiB7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5ibG9ja3MpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQXVkaW8gSW50ZWdyYXRpb24gd2l0aCBPdGhlciBDb250ZW50IFR5cGVzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIG1peGVkIGNvbnRlbnQgd2l0aCBhdWRpbyBVUkxzJywgKCkgPT4ge1xuICAgICAgY29uc3QgbWl4ZWRDb250ZW50ID0gYCMgTXkgUGxheWxpc3RcblxuSGVyZSBhcmUgc29tZSBncmVhdCBzb25nczpcblxuaHR0cHM6Ly9leGFtcGxlLmNvbS9zb25nMS5tcDNcbmh0dHBzOi8vZXhhbXBsZS5jb20vc29uZzIud2F2XG5cbioqRGVzY3JpcHRpb24qKjogVGhlc2UgYXJlIG15IGZhdm9yaXRlIHRyYWNrcy5gO1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBwYXJzZUNvbnRlbnQobWl4ZWRDb250ZW50LCB7IGNvbnRlbnRUeXBlOiAnbWFya2Rvd24nIH0pO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmJsb2Nrcy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigxKTtcbiAgICAgIFxuICAgICAgLy8gU2hvdWxkIGNvbnRhaW4gYm90aCB0ZXh0IGFuZCBhdWRpbyBibG9ja3NcbiAgICAgIGNvbnN0IGJsb2NrVHlwZXMgPSByZXN1bHQuYmxvY2tzLm1hcCgoYmxvY2s6IGFueSkgPT4gYmxvY2sudHlwZSk7XG4gICAgICBleHBlY3QoYmxvY2tUeXBlcykudG9Db250YWluKCdoZWFkaW5nXzEnKTtcbiAgICAgIGV4cGVjdChibG9ja1R5cGVzKS50b0NvbnRhaW4oJ3BhcmFncmFwaCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwcmVzZXJ2ZSBhdWRpbyBVUkxzIGluIG1hcmtkb3duIGxpbmtzJywgKCkgPT4ge1xuICAgICAgY29uc3QgbWFya2Rvd25XaXRoQXVkaW8gPSAnW0xpc3RlbiB0byB0aGlzIHNvbmddKGh0dHBzOi8vZXhhbXBsZS5jb20vc29uZy5tcDMpJztcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHBhcnNlQ29udGVudChtYXJrZG93bldpdGhBdWRpbywgeyBjb250ZW50VHlwZTogJ21hcmtkb3duJyB9KTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5ibG9ja3MpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgIFxuICAgICAgY29uc3QgcGFyYWdyYXBoID0gcmVzdWx0LmJsb2Nrc1swXSBhcyBhbnk7XG4gICAgICBleHBlY3QocGFyYWdyYXBoLnR5cGUpLnRvQmUoJ3BhcmFncmFwaCcpO1xuICAgICAgZXhwZWN0KHBhcmFncmFwaC5wYXJhZ3JhcGgucmljaF90ZXh0WzBdLmhyZWYpLnRvQmUoJ2h0dHBzOi8vZXhhbXBsZS5jb20vc29uZy5tcDMnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0F1ZGlvIEVycm9yIEhhbmRsaW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIG1hbGZvcm1lZCBhdWRpbyBjb250ZW50IGdyYWNlZnVsbHknLCAoKSA9PiB7XG4gICAgICBjb25zdCBtYWxmb3JtZWRDb250ZW50ID0gJ2h0dHBzOi8vZXhhbXBsZS5jb20vYXVkaW8ubXAzIGJ1dCB0aGlzIGlzIGJyb2tlbic7XG4gICAgICBjb25zdCByZXN1bHQgPSBwYXJzZUNvbnRlbnQobWFsZm9ybWVkQ29udGVudCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIC8vIFNob3VsZCBoYW5kbGUgYXMgdGV4dCBvciBtaXhlZCBjb250ZW50XG4gICAgICBleHBlY3QocmVzdWx0LmJsb2Nrcy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcHJvdmlkZSBtZWFuaW5nZnVsIGVycm9yIG1lc3NhZ2VzIGZvciBpbnZhbGlkIGF1ZGlvJywgKCkgPT4ge1xuICAgICAgY29uc3QgaW52YWxpZEF1ZGlvID0gJ25vdC1hbi1hdWRpby11cmwnO1xuICAgICAgY29uc3QgcmVzdWx0ID0gcGFyc2VDb250ZW50KGludmFsaWRBdWRpbyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuYmxvY2tzWzBdLnR5cGUpLnRvQmUoJ3BhcmFncmFwaCcpOyAvLyBTaG91bGQgZmFsbGJhY2sgdG8gdGV4dFxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgYXVkaW8gVVJMcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGVtcHR5VXJsID0gJyc7XG4gICAgICBjb25zdCByZXN1bHQgPSBwYXJzZUNvbnRlbnQoZW1wdHlVcmwpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmJsb2NrcykudG9FcXVhbChbXSk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il0sInZlcnNpb24iOjN9