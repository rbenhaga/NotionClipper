{"file":"C:\\Users\\rayan\\Desktop\\Dev\\NotionClipper\\packages\\notion-parser\\src\\parsers\\MarkdownParser.ts","mappings":";;;AAAA,6CAA0C;AAG1C,MAAa,cAAe,SAAQ,uBAAU;IAC5C,YAAY,UAAwB,EAAE;QACpC,KAAK,CAAC,OAAO,CAAC,CAAC;IACjB,CAAC;IAED,KAAK,CAAC,OAAe;QACnB,IAAI,CAAC,OAAO,EAAE,IAAI,EAAE;YAAE,OAAO,EAAE,CAAC;QAEhC,MAAM,KAAK,GAAc,EAAE,CAAC;QAC5B,MAAM,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QAClC,IAAI,CAAC,GAAG,CAAC,CAAC;QAEV,OAAO,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC;YACxB,MAAM,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;YACtB,MAAM,OAAO,GAAG,IAAI,CAAC,IAAI,EAAE,CAAC;YAE5B,IAAI,CAAC,OAAO,EAAE,CAAC;gBACb,CAAC,EAAE,CAAC;gBACJ,SAAS;YACX,CAAC;YAED,cAAc;YACd,IAAI,OAAO,CAAC,UAAU,CAAC,KAAK,CAAC,EAAE,CAAC;gBAC9B,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,IAAI,CAAC,cAAc,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;gBACzD,IAAI,IAAI;oBAAE,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBAC3B,CAAC,IAAI,QAAQ,CAAC;gBACd,SAAS;YACX,CAAC;YAED,kBAAkB;YAClB,IAAI,OAAO,KAAK,GAAG,IAAI,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC;gBAChD,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,IAAI,CAAC,kBAAkB,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;gBAC7D,IAAI,IAAI;oBAAE,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBAC3B,CAAC,IAAI,QAAQ,CAAC;gBACd,SAAS;YACX,CAAC;YAED,SAAS;YACT,IAAI,OAAO,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC,MAAM,IAAI,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,CAAC;gBAClF,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;gBACrD,IAAI,IAAI;oBAAE,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBAC3B,CAAC,IAAI,QAAQ,CAAC;gBACd,SAAS;YACX,CAAC;YAED,gCAAgC;YAChC,IAAI,OAAO,CAAC,KAAK,CAAC,gBAAgB,CAAC,EAAE,CAAC;gBACpC,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,IAAI,CAAC,kBAAkB,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;gBAC7D,IAAI,IAAI;oBAAE,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBAC3B,CAAC,IAAI,QAAQ,CAAC;gBACd,SAAS;YACX,CAAC;YAED,sBAAsB;YACtB,IAAI,OAAO,CAAC,KAAK,CAAC,iBAAiB,CAAC,EAAE,CAAC;gBACrC,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;gBACvD,IAAI,IAAI;oBAAE,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBAC3B,CAAC,IAAI,QAAQ,CAAC;gBACd,SAAS;YACX,CAAC;YAED,0CAA0C;YAC1C,IAAI,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,gBAAgB,CAAC,EAAE,CAAC;gBAC/F,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,IAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;gBAC3D,IAAI,IAAI;oBAAE,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBAC3B,CAAC,IAAI,QAAQ,CAAC;gBACd,SAAS;YACX,CAAC;YAED,gCAAgC;YAChC,IAAI,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE,CAAC;gBAC7B,MAAM,EAAE,KAAK,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,IAAI,CAAC,eAAe,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;gBACtE,KAAK,CAAC,IAAI,CAAC,GAAG,SAAS,CAAC,CAAC;gBACzB,CAAC,IAAI,QAAQ,CAAC;gBACd,SAAS;YACX,CAAC;YAED,yCAAyC;YACzC,IAAI,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,EAAE,CAAC;gBACnC,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,IAAI,CAAC,uBAAuB,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;gBAClE,IAAI,IAAI;oBAAE,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBAC3B,CAAC,IAAI,QAAQ,CAAC;gBACd,SAAS;YACX,CAAC;YAED,sBAAsB;YACtB,MAAM,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;YACrC,IAAI,IAAI;gBAAE,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAE3B,CAAC,EAAE,CAAC;QACN,CAAC;QAED,OAAO,KAAK,CAAC,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC,OAAO,CAAC,SAAS,IAAI,GAAG,CAAC,CAAC;IACvD,CAAC;IAEO,SAAS,CAAC,IAAY;QAC5B,UAAU;QACV,MAAM,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,mBAAmB,CAAC,CAAC;QACpD,IAAI,WAAW,EAAE,CAAC;YAChB,MAAM,KAAK,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,MAAmB,CAAC;YACjD,OAAO,IAAI,CAAC,iBAAiB,CAAC,WAAW,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC;QACvD,CAAC;QAED,6BAA6B;QAC7B,MAAM,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,gCAAgC,CAAC,CAAC;QAChE,IAAI,UAAU,EAAE,CAAC;YACf,MAAM,SAAS,GAAG,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,UAAU,CAAC,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;YAE9E,oEAAoE;YACpE,IAAI,UAAU,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC;gBACzB,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC,yCAAyC;YAC7E,CAAC;YAED,OAAO,SAAS,CAAC;QACnB,CAAC;QAED,gEAAgE;QAChE,MAAM,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,qBAAqB,CAAC,CAAC;QACtD,IAAI,WAAW,EAAE,CAAC;YAChB,OAAO,IAAI,CAAC,kBAAkB,CAAC,WAAW,CAAC,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC;QAC7D,CAAC;QAED,MAAM,aAAa,GAAG,IAAI,CAAC,KAAK,CAAC,qBAAqB,CAAC,CAAC;QACxD,IAAI,aAAa,EAAE,CAAC;YAClB,OAAO,IAAI,CAAC,kBAAkB,CAAC,aAAa,CAAC,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC;QAC/D,CAAC;QAED,aAAa;QACb,MAAM,aAAa,GAAG,IAAI,CAAC,KAAK,CAAC,4BAA4B,CAAC,CAAC;QAC/D,IAAI,aAAa,EAAE,CAAC;YAClB,OAAO,IAAI,CAAC,kBAAkB,CAAC,aAAa,CAAC,CAAC,CAAC,EAAE,MAAM,EAAE,aAAa,CAAC,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC;QACrF,CAAC;QAED,SAAS;QACT,IAAI,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC;YACrD,OAAO,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;QACjD,CAAC;QAED,WAAW;QACX,IAAI,IAAI,CAAC,KAAK,CAAC,oBAAoB,CAAC,EAAE,CAAC;YACrC,OAAO,IAAI,CAAC,iBAAiB,EAAE,CAAC;QAClC,CAAC;QAED,OAAO;QACP,IAAI,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC;YAC1B,OAAO,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,CAAC;QACvC,CAAC;QAED,uBAAuB;QACvB,IAAI,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,CAAC;YAC7C,OAAO,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;QACpC,CAAC;QAED,oBAAoB;QACpB,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;IACnC,CAAC;IAEO,cAAc,CAAC,KAAe,EAAE,QAAgB;QACtD,MAAM,SAAS,GAAG,KAAK,CAAC,QAAQ,CAAC,CAAC;QAClC,MAAM,QAAQ,GAAG,SAAS,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC,IAAI,EAAE,IAAI,YAAY,CAAC;QACrE,MAAM,SAAS,GAAa,EAAE,CAAC;QAC/B,IAAI,CAAC,GAAG,QAAQ,GAAG,CAAC,CAAC;QAErB,OAAO,CAAC,GAAG,KAAK,CAAC,MAAM,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,UAAU,CAAC,KAAK,CAAC,EAAE,CAAC;YAC9D,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;YACzB,CAAC,EAAE,CAAC;QACN,CAAC;QAED,IAAI,CAAC,IAAI,KAAK,CAAC,MAAM,EAAE,CAAC;YACtB,gCAAgC;YAChC,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,CAAC;QAC/D,CAAC;QAED,MAAM,IAAI,GAAG,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAClC,MAAM,aAAa,GAAG,IAAI,CAAC,eAAe,CAAC,IAAI,EAAE,IAAI,CAAC,OAAO,CAAC,aAAa,IAAI,IAAI,CAAC,CAAC;QAErF,OAAO;YACL,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,aAAa,EAAE,QAAQ,EAAE,IAAI,CAAC;YACxD,QAAQ,EAAE,CAAC,GAAG,QAAQ,GAAG,CAAC;SAC3B,CAAC;IACJ,CAAC;IAEO,kBAAkB,CAAC,KAAe,EAAE,QAAgB;QAC1D,MAAM,SAAS,GAAG,KAAK,CAAC,QAAQ,CAAC,CAAC;QAElC,kCAAkC;QAClC,IAAI,SAAS,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;YACnF,MAAM,UAAU,GAAG,SAAS,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;YACjD,OAAO;gBACL,IAAI,EAAE,IAAI,CAAC,kBAAkB,CAAC,UAAU,EAAE,IAAI,CAAC;gBAC/C,QAAQ,EAAE,CAAC;aACZ,CAAC;QACJ,CAAC;QAED,4BAA4B;QAC5B,MAAM,aAAa,GAAa,EAAE,CAAC;QACnC,IAAI,CAAC,GAAG,QAAQ,GAAG,CAAC,CAAC;QACrB,MAAM,SAAS,GAAG,SAAS,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC;QAE1D,OAAO,CAAC,GAAG,KAAK,CAAC,MAAM,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,KAAK,SAAS,EAAE,CAAC;YACzD,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;YAC7B,CAAC,EAAE,CAAC;QACN,CAAC;QAED,IAAI,CAAC,IAAI,KAAK,CAAC,MAAM,EAAE,CAAC;YACtB,sCAAsC;YACtC,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,CAAC;QAC/D,CAAC;QAED,MAAM,UAAU,GAAG,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI,EAAE,CAAC;QAEnD,IAAI,CAAC,UAAU,EAAE,CAAC;YAChB,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,GAAG,QAAQ,GAAG,CAAC,EAAE,CAAC;QACpD,CAAC;QAED,OAAO;YACL,IAAI,EAAE,IAAI,CAAC,kBAAkB,CAAC,UAAU,EAAE,IAAI,CAAC;YAC/C,QAAQ,EAAE,CAAC,GAAG,QAAQ,GAAG,CAAC;SAC3B,CAAC;IACJ,CAAC;IAEO,UAAU,CAAC,KAAe,EAAE,QAAgB;QAClD,MAAM,UAAU,GAAa,EAAE,CAAC;QAChC,IAAI,CAAC,GAAG,QAAQ,CAAC;QAEjB,0BAA0B;QAC1B,OAAO,CAAC,GAAG,KAAK,CAAC,MAAM,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE,CAAC;YAC3D,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;YAC1B,CAAC,EAAE,CAAC;QACN,CAAC;QAED,IAAI,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;YAC1B,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,EAAE,CAAC;QACrC,CAAC;QAED,gBAAgB;QAChB,MAAM,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;QAElD,2BAA2B;QAC3B,IAAI,cAAc,GAAG,CAAC,CAAC;QACvB,IAAI,UAAU,CAAC,MAAM,GAAG,CAAC,IAAI,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;YAClE,cAAc,GAAG,CAAC,CAAC;QACrB,CAAC;QAED,kBAAkB;QAClB,MAAM,IAAI,GAAG,UAAU,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC,CAAC;QAEpF,wBAAwB;QACxB,MAAM,UAAU,GAAG,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,MAAM,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC;QAC5E,MAAM,iBAAiB,GAAG,IAAI,CAAC,iBAAiB,CAAC,OAAO,EAAE,UAAU,CAAC,CAAC;QACtE,MAAM,cAAc,GAAG,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,iBAAiB,CAAC,GAAG,EAAE,UAAU,CAAC,CAAC,CAAC;QAEhF,OAAO;YACL,IAAI,EAAE,IAAI,CAAC,eAAe,CAAC,iBAAiB,EAAE,cAAc,CAAC;YAC7D,QAAQ,EAAE,CAAC,GAAG,QAAQ;SACvB,CAAC;IACJ,CAAC;IAEO,aAAa,CAAC,IAAY;QAChC,0CAA0C;QAC1C,MAAM,OAAO,GAAG,IAAI,CAAC,IAAI,EAAE,CAAC;QAC5B,MAAM,iBAAiB,GAAG,OAAO,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;QAC/E,MAAM,mBAAmB,GAAG,iBAAiB,CAAC,QAAQ,CAAC,GAAG,CAAC;YACzD,CAAC,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YAChC,CAAC,CAAC,iBAAiB,CAAC;QAEtB,OAAO,mBAAmB;aACvB,KAAK,CAAC,GAAG,CAAC;aACV,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC;IAC9B,CAAC;IAEO,gBAAgB,CAAC,IAAY;QACnC,MAAM,OAAO,GAAG,IAAI,CAAC,IAAI,EAAE,CAAC;QAC5B,OAAO,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,OAAO,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;IAC/D,CAAC;IAEO,iBAAiB,CAAC,GAAa,EAAE,YAAoB;QAC3D,MAAM,UAAU,GAAG,CAAC,GAAG,GAAG,CAAC,CAAC;QAE5B,sCAAsC;QACtC,OAAO,UAAU,CAAC,MAAM,GAAG,YAAY,EAAE,CAAC;YACxC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QACtB,CAAC;QAED,uBAAuB;QACvB,IAAI,UAAU,CAAC,MAAM,GAAG,YAAY,EAAE,CAAC;YACrC,UAAU,CAAC,MAAM,GAAG,YAAY,CAAC;QACnC,CAAC;QAED,OAAO,UAAU,CAAC;IACpB,CAAC;IAEO,kBAAkB,CAAC,KAAe,EAAE,QAAgB;QAC1D,MAAM,SAAS,GAAG,KAAK,CAAC,QAAQ,CAAC,CAAC;QAClC,MAAM,KAAK,GAAG,SAAS,CAAC,KAAK,CAAC,uBAAuB,CAAC,CAAC;QAEvD,IAAI,CAAC,KAAK;YAAE,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,EAAE,CAAC;QAE/C,MAAM,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,MAAmB,CAAC;QAC3C,MAAM,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;QAEvB,MAAM,QAAQ,GAAc,EAAE,CAAC;QAC/B,IAAI,CAAC,GAAG,QAAQ,GAAG,CAAC,CAAC;QAErB,+CAA+C;QAC/C,OAAO,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC;YACxB,MAAM,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;YAE7B,IAAI,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE,CAAC;gBACzB,8CAA8C;gBAC9C,MAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;gBACzC,IAAI,OAAO,EAAE,CAAC;oBACZ,gCAAgC;oBAChC,MAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;oBACzC,QAAQ,CAAC,IAAI,CAAC,GAAG,YAAY,CAAC,CAAC;gBACjC,CAAC;gBACD,CAAC,EAAE,CAAC;YACN,CAAC;iBAAM,IAAI,CAAC,IAAI,EAAE,CAAC;gBACjB,2BAA2B;gBAC3B,CAAC,EAAE,CAAC;YACN,CAAC;iBAAM,CAAC;gBACN,gBAAgB;gBAChB,MAAM;YACR,CAAC;QACH,CAAC;QAED,OAAO;YACL,IAAI,EAAE,IAAI,CAAC,uBAAuB,CAAC,KAAK,EAAE,KAAK,EAAE,QAAQ,CAAC;YAC1D,QAAQ,EAAE,CAAC,GAAG,QAAQ;SACvB,CAAC;IACJ,CAAC;IAEO,gBAAgB,CAAC,KAAe,EAAE,QAAgB;QACxD,MAAM,SAAS,GAAG,KAAK,CAAC,QAAQ,CAAC,CAAC;QAClC,MAAM,OAAO,GAAG,SAAS,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,cAAc;QAE7D,IAAI,CAAC,OAAO;YAAE,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,EAAE,CAAC;QAEjD,MAAM,QAAQ,GAAc,EAAE,CAAC;QAC/B,IAAI,CAAC,GAAG,QAAQ,GAAG,CAAC,CAAC;QAErB,+CAA+C;QAC/C,OAAO,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC;YACxB,MAAM,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;YAE7B,IAAI,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE,CAAC;gBACzB,8CAA8C;gBAC9C,MAAM,YAAY,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;gBAC9C,IAAI,YAAY,EAAE,CAAC;oBACjB,gCAAgC;oBAChC,MAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC;oBAC9C,QAAQ,CAAC,IAAI,CAAC,GAAG,YAAY,CAAC,CAAC;gBACjC,CAAC;gBACD,CAAC,EAAE,CAAC;YACN,CAAC;iBAAM,IAAI,CAAC,IAAI,EAAE,CAAC;gBACjB,2BAA2B;gBAC3B,CAAC,EAAE,CAAC;YACN,CAAC;iBAAM,CAAC;gBACN,gBAAgB;gBAChB,MAAM;YACR,CAAC;QACH,CAAC;QAED,0CAA0C;QAC1C,IAAI,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;YAC1B,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,CAAC;QAC9D,CAAC;QAED,OAAO;YACL,IAAI,EAAE,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,QAAQ,CAAC;YAC9C,QAAQ,EAAE,CAAC,GAAG,QAAQ;SACvB,CAAC;IACJ,CAAC;IAEO,YAAY,CAAC,KAAe,EAAE,QAAgB;QACpD,MAAM,SAAS,GAAG,KAAK,CAAC,QAAQ,CAAC,CAAC;QAClC,MAAM,KAAK,GAAG,SAAS,CAAC,KAAK,CAAC,yBAAyB,CAAC,CAAC;QAEzD,IAAI,CAAC,KAAK;YAAE,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,EAAE,CAAC;QAE/C,MAAM,QAAQ,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC;QACxC,MAAM,YAAY,GAAG,KAAK,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;QAEpC,MAAM,YAAY,GAAG,CAAC,YAAY,CAAC,CAAC;QACpC,IAAI,CAAC,GAAG,QAAQ,GAAG,CAAC,CAAC;QAErB,mCAAmC;QACnC,OAAO,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC;YACxB,MAAM,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;YAE7B,IAAI,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE,CAAC;gBACzB,iCAAiC;gBACjC,IAAI,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC,EAAE,CAAC;oBAClC,kDAAkD;oBAClD,MAAM;gBACR,CAAC;gBAED,2BAA2B;gBAC3B,MAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;gBACzC,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;gBAC3B,CAAC,EAAE,CAAC;YACN,CAAC;iBAAM,IAAI,CAAC,IAAI,EAAE,CAAC;gBACjB,4BAA4B;gBAC5B,YAAY,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;gBACtB,CAAC,EAAE,CAAC;YACN,CAAC;iBAAM,CAAC;gBACN,iBAAiB;gBACjB,MAAM;YACR,CAAC;QACH,CAAC;QAED,MAAM,OAAO,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC9D,MAAM,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC;QAC3C,MAAM,KAAK,GAAG,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;QAE7C,OAAO;YACL,IAAI,EAAE,IAAI,CAAC,iBAAiB,CAAC,OAAO,EAAE,IAAI,EAAE,KAAK,CAAC;YAClD,QAAQ,EAAE,CAAC,GAAG,QAAQ;SACvB,CAAC;IACJ,CAAC;IAEO,UAAU,CAAC,IAAY;QAC7B,OAAO,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC;YAChC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC;YAC3B,uBAAuB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACvC,CAAC;IAEO,eAAe,CAAC,KAAe,EAAE,QAAgB;QACvD,MAAM,SAAS,GAA0D,EAAE,CAAC;QAC5E,IAAI,CAAC,GAAG,QAAQ,CAAC;QAEjB,OAAO,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC;YACxB,MAAM,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;YACtB,MAAM,OAAO,GAAG,IAAI,CAAC,IAAI,EAAE,CAAC;YAE5B,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE,CAAC;gBAC9B,MAAM;YACR,CAAC;YAED,MAAM,KAAK,GAAG,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC;YAC7C,MAAM,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;YAE7C,IAAI,QAAQ,EAAE,CAAC;gBACb,SAAS,CAAC,IAAI,CAAC;oBACb,IAAI,EAAE,QAAQ,CAAC,IAAI;oBACnB,KAAK;oBACL,IAAI,EAAE,QAAQ,CAAC,IAAI;iBACpB,CAAC,CAAC;YACL,CAAC;YAED,CAAC,EAAE,CAAC;QACN,CAAC;QAED,wCAAwC;QACxC,MAAM,WAAW,GAAG,IAAI,CAAC,wBAAwB,CAAC,SAAS,CAAC,CAAC;QAE7D,OAAO;YACL,KAAK,EAAE,WAAW;YAClB,QAAQ,EAAE,CAAC,GAAG,QAAQ;SACvB,CAAC;IACJ,CAAC;IAEO,mBAAmB,CAAC,IAAY;QACtC,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;QACnC,MAAM,MAAM,GAAG,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;QAC3C,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,qBAAqB;IACtD,CAAC;IAEO,aAAa,CAAC,IAAY;QAChC,WAAW;QACX,MAAM,aAAa,GAAG,IAAI,CAAC,KAAK,CAAC,4BAA4B,CAAC,CAAC;QAC/D,IAAI,aAAa,EAAE,CAAC;YAClB,OAAO;gBACL,IAAI,EAAE,IAAI,CAAC,kBAAkB,CAAC,aAAa,CAAC,CAAC,CAAC,EAAE,MAAM,EAAE,aAAa,CAAC,CAAC,CAAC,KAAK,GAAG,CAAC;gBACjF,IAAI,EAAE,MAAM;aACb,CAAC;QACJ,CAAC;QAED,gBAAgB;QAChB,MAAM,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,qBAAqB,CAAC,CAAC;QACtD,IAAI,WAAW,EAAE,CAAC;YAChB,OAAO;gBACL,IAAI,EAAE,IAAI,CAAC,kBAAkB,CAAC,WAAW,CAAC,CAAC,CAAC,EAAE,UAAU,CAAC;gBACzD,IAAI,EAAE,UAAU;aACjB,CAAC;QACJ,CAAC;QAED,gBAAgB;QAChB,MAAM,aAAa,GAAG,IAAI,CAAC,KAAK,CAAC,qBAAqB,CAAC,CAAC;QACxD,IAAI,aAAa,EAAE,CAAC;YAClB,OAAO;gBACL,IAAI,EAAE,IAAI,CAAC,kBAAkB,CAAC,aAAa,CAAC,CAAC,CAAC,EAAE,UAAU,CAAC;gBAC3D,IAAI,EAAE,UAAU;aACjB,CAAC;QACJ,CAAC;QAED,OAAO,IAAI,CAAC;IACd,CAAC;IAEO,wBAAwB,CAAC,KAA4D;QAC3F,IAAI,KAAK,CAAC,MAAM,KAAK,CAAC;YAAE,OAAO,EAAE,CAAC;QAElC,MAAM,MAAM,GAAc,EAAE,CAAC;QAC7B,MAAM,KAAK,GAAiE,EAAE,CAAC;QAE/E,KAAK,MAAM,IAAI,IAAI,KAAK,EAAE,CAAC;YACzB,wDAAwD;YACxD,OAAO,KAAK,CAAC,MAAM,GAAG,CAAC,IAAI,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,KAAK,IAAI,IAAI,CAAC,KAAK,EAAE,CAAC;gBACvE,MAAM,MAAM,GAAG,KAAK,CAAC,GAAG,EAAG,CAAC;gBAC5B,IAAI,MAAM,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;oBAC9B,MAAM,CAAC,IAAY,CAAC,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC;gBAClD,CAAC;gBAED,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;oBACrB,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;gBACrD,CAAC;qBAAM,CAAC;oBACN,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;gBAC3B,CAAC;YACH,CAAC;YAED,4BAA4B;YAC5B,KAAK,CAAC,IAAI,CAAC;gBACT,IAAI,EAAE,IAAI,CAAC,IAAI;gBACf,KAAK,EAAE,IAAI,CAAC,KAAK;gBACjB,QAAQ,EAAE,EAAE;aACb,CAAC,CAAC;QACL,CAAC;QAED,iCAAiC;QACjC,OAAO,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;YACxB,MAAM,MAAM,GAAG,KAAK,CAAC,GAAG,EAAG,CAAC;YAC5B,IAAI,MAAM,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;gBAC9B,MAAM,CAAC,IAAY,CAAC,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC;YAClD,CAAC;YAED,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;gBACrB,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;YACrD,CAAC;iBAAM,CAAC;gBACN,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;YAC3B,CAAC;QACH,CAAC;QAED,OAAO,MAAM,CAAC;IAChB,CAAC;IAEO,gBAAgB,CAAC,IAAY;QACnC,iCAAiC;QACjC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,+DAA+D,CAAC,CAAC;IACtF,CAAC;IAEO,uBAAuB,CAAC,KAAe,EAAE,QAAgB;QAC/D,MAAM,cAAc,GAAa,EAAE,CAAC;QACpC,IAAI,CAAC,GAAG,QAAQ,CAAC;QAEjB,OAAO,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC;YACxB,MAAM,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;YACtB,MAAM,OAAO,GAAG,IAAI,CAAC,IAAI,EAAE,CAAC;YAE5B,4BAA4B;YAC5B,IAAI,CAAC,OAAO,EAAE,CAAC;gBACb,MAAM;YACR,CAAC;YAED,0CAA0C;YAC1C,IAAI,IAAI,CAAC,qBAAqB,CAAC,OAAO,CAAC,EAAE,CAAC;gBACxC,MAAM;YACR,CAAC;YAED,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC1B,CAAC,EAAE,CAAC;QACN,CAAC;QAED,IAAI,cAAc,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;YAChC,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,EAAE,CAAC;QACrC,CAAC;QAED,uCAAuC;QACvC,MAAM,OAAO,GAAG,cAAc,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QAEzC,OAAO;YACL,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC;YAClC,QAAQ,EAAE,CAAC,GAAG,QAAQ;SACvB,CAAC;IACJ,CAAC;IAEO,qBAAqB,CAAC,IAAY;QACxC,OAAO,+DAA+D,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACpF,CAAC;IAEO,eAAe,CAAC,IAAY;QAClC,kCAAkC;QAClC,+DAA+D;QAC/D,MAAM,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC;QAC/C,OAAO,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;IACxC,CAAC;IAEO,cAAc,CAAC,IAAY;QACjC,MAAM,KAAK,GAA2B;YACpC,MAAM,EAAE,IAAI;YACZ,MAAM,EAAE,IAAI;YACZ,KAAK,EAAE,IAAI;YACX,SAAS,EAAE,IAAI;YACf,QAAQ,EAAE,IAAI;YACd,SAAS,EAAE,GAAG;YACd,UAAU,EAAE,GAAG;YACf,OAAO,EAAE,IAAI;YACb,SAAS,EAAE,IAAI;YACf,KAAK,EAAE,IAAI;YACX,MAAM,EAAE,IAAI;YACZ,UAAU,EAAE,IAAI;YAChB,SAAS,EAAE,IAAI;YACf,MAAM,EAAE,IAAI;YACZ,SAAS,EAAE,GAAG;YACd,MAAM,EAAE,GAAG;YACX,SAAS,EAAE,GAAG;YACd,OAAO,EAAE,GAAG;YACZ,MAAM,EAAE,GAAG;SACZ,CAAC;QACF,OAAO,KAAK,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC;IAC7B,CAAC;IAEO,eAAe,CAAC,IAAY;QAClC,MAAM,MAAM,GAA2B;YACrC,MAAM,EAAE,iBAAiB;YACzB,MAAM,EAAE,iBAAiB;YACzB,KAAK,EAAE,kBAAkB;YACzB,SAAS,EAAE,mBAAmB;YAC9B,QAAQ,EAAE,gBAAgB;YAC1B,SAAS,EAAE,kBAAkB;YAC7B,UAAU,EAAE,mBAAmB;YAC/B,OAAO,EAAE,iBAAiB;YAC1B,SAAS,EAAE,iBAAiB;YAC5B,KAAK,EAAE,gBAAgB;YACvB,MAAM,EAAE,iBAAiB;YACzB,UAAU,EAAE,mBAAmB;YAC/B,SAAS,EAAE,mBAAmB;YAC9B,MAAM,EAAE,mBAAmB;YAC3B,SAAS,EAAE,gBAAgB;YAC3B,MAAM,EAAE,gBAAgB;YACxB,SAAS,EAAE,mBAAmB;YAC9B,OAAO,EAAE,kBAAkB;YAC3B,MAAM,EAAE,kBAAkB;SAC3B,CAAC;QACF,OAAO,MAAM,CAAC,IAAI,CAAC,IAAI,iBAAiB,CAAC;IAC3C,CAAC;IAID;;OAEG;IACH,MAAM,CAAC,iBAAiB,CAAC,OAAe;QACtC,MAAM,MAAM,GAAG,IAAI,cAAc,EAAE,CAAC;QACpC,MAAM,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QAClC,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,CAAC,eAAe,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;QACnD,OAAO,KAAK,CAAC;IACf,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,kBAAkB,CAAC,OAAe;QACvC,MAAM,MAAM,GAAG,IAAI,cAAc,EAAE,CAAC;QACpC,MAAM,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QAClC,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;QAC7C,OAAO,IAAI,CAAC;IACd,CAAC;CACF;AA3pBD,wCA2pBC","names":[],"sources":["C:\\Users\\rayan\\Desktop\\Dev\\NotionClipper\\packages\\notion-parser\\src\\parsers\\MarkdownParser.ts"],"sourcesContent":["import { BaseParser } from './BaseParser';\r\nimport type { ASTNode, ParseOptions } from '../types';\r\n\r\nexport class MarkdownParser extends BaseParser {\r\n  constructor(options: ParseOptions = {}) {\r\n    super(options);\r\n  }\r\n\r\n  parse(content: string): ASTNode[] {\r\n    if (!content?.trim()) return [];\r\n\r\n    const nodes: ASTNode[] = [];\r\n    const lines = content.split('\\n');\r\n    let i = 0;\r\n\r\n    while (i < lines.length) {\r\n      const line = lines[i];\r\n      const trimmed = line.trim();\r\n\r\n      if (!trimmed) {\r\n        i++;\r\n        continue;\r\n      }\r\n\r\n      // Code blocks\r\n      if (trimmed.startsWith('```')) {\r\n        const { node, consumed } = this.parseCodeBlock(lines, i);\r\n        if (node) nodes.push(node);\r\n        i += consumed;\r\n        continue;\r\n      }\r\n\r\n      // Equation blocks\r\n      if (trimmed === '$' || trimmed.startsWith('$$')) {\r\n        const { node, consumed } = this.parseEquationBlock(lines, i);\r\n        if (node) nodes.push(node);\r\n        i += consumed;\r\n        continue;\r\n      }\r\n\r\n      // Tables\r\n      if (trimmed.startsWith('|') && i + 1 < lines.length && lines[i + 1].includes('|')) {\r\n        const { node, consumed } = this.parseTable(lines, i);\r\n        if (node) nodes.push(node);\r\n        i += consumed;\r\n        continue;\r\n      }\r\n\r\n      // Toggle headings (> # Heading)\r\n      if (trimmed.match(/^>\\s*#{1,3}\\s+/)) {\r\n        const { node, consumed } = this.parseToggleHeading(lines, i);\r\n        if (node) nodes.push(node);\r\n        i += consumed;\r\n        continue;\r\n      }\r\n\r\n      // Multi-line callouts\r\n      if (trimmed.match(/^>\\s*\\[!(\\w+)\\]/)) {\r\n        const { node, consumed } = this.parseCallout(lines, i);\r\n        if (node) nodes.push(node);\r\n        i += consumed;\r\n        continue;\r\n      }\r\n\r\n      // Toggle blocks (> content with children)\r\n      if (trimmed.startsWith('> ') && !trimmed.match(/^>\\s*\\[!/) && !trimmed.match(/^>\\s*#{1,3}\\s+/)) {\r\n        const { node, consumed } = this.parseToggleBlock(lines, i);\r\n        if (node) nodes.push(node);\r\n        i += consumed;\r\n        continue;\r\n      }\r\n\r\n      // Nested lists (up to 3 levels)\r\n      if (this.isListLine(trimmed)) {\r\n        const { nodes: listNodes, consumed } = this.parseNestedList(lines, i);\r\n        nodes.push(...listNodes);\r\n        i += consumed;\r\n        continue;\r\n      }\r\n\r\n      // Multi-line paragraphs with soft breaks\r\n      if (this.isParagraphStart(trimmed)) {\r\n        const { node, consumed } = this.parseMultiLineParagraph(lines, i);\r\n        if (node) nodes.push(node);\r\n        i += consumed;\r\n        continue;\r\n      }\r\n\r\n      // Single line parsing\r\n      const node = this.parseLine(trimmed);\r\n      if (node) nodes.push(node);\r\n\r\n      i++;\r\n    }\r\n\r\n    return nodes.slice(0, this.options.maxBlocks || 100);\r\n  }\r\n\r\n  private parseLine(line: string): ASTNode | null {\r\n    // Headers\r\n    const headerMatch = line.match(/^(#{1,3})\\s+(.+)$/);\r\n    if (headerMatch) {\r\n      const level = headerMatch[1].length as 1 | 2 | 3;\r\n      return this.createHeadingNode(headerMatch[2], level);\r\n    }\r\n\r\n    // Images with inline content\r\n    const imageMatch = line.match(/^!\\[([^\\]]*)\\]\\(([^)]+)\\)(.*)$/);\r\n    if (imageMatch) {\r\n      const imageNode = this.createMediaNode('image', imageMatch[2], imageMatch[1]);\r\n\r\n      // If there's additional content after the image, create a paragraph\r\n      if (imageMatch[3].trim()) {\r\n        return this.createTextNode(line); // Keep as text to preserve mixed content\r\n      }\r\n\r\n      return imageNode;\r\n    }\r\n\r\n    // Lists (will be handled by parseNestedList for proper nesting)\r\n    const bulletMatch = line.match(/^(\\s*)[-*+]\\s+(.+)$/);\r\n    if (bulletMatch) {\r\n      return this.createListItemNode(bulletMatch[2], 'bulleted');\r\n    }\r\n\r\n    const numberedMatch = line.match(/^(\\s*)\\d+\\.\\s+(.+)$/);\r\n    if (numberedMatch) {\r\n      return this.createListItemNode(numberedMatch[2], 'numbered');\r\n    }\r\n\r\n    // Checkboxes\r\n    const checkboxMatch = line.match(/^(\\s*)- \\[([ x])\\]\\s+(.+)$/);\r\n    if (checkboxMatch) {\r\n      return this.createListItemNode(checkboxMatch[3], 'todo', checkboxMatch[2] === 'x');\r\n    }\r\n\r\n    // Quotes\r\n    if (line.startsWith('> ') && !line.match(/^>\\s*\\[!/)) {\r\n      return this.createQuoteNode(line.substring(2));\r\n    }\r\n\r\n    // Dividers\r\n    if (line.match(/^(---|\\*\\*\\*|___)$/)) {\r\n      return this.createDividerNode();\r\n    }\r\n\r\n    // URLs\r\n    if (this.isValidUrl(line)) {\r\n      return this.createBookmarkNode(line);\r\n    }\r\n\r\n    // HTML inline handling\r\n    if (line.includes('<') && line.includes('>')) {\r\n      return this.parseHtmlInline(line);\r\n    }\r\n\r\n    // Regular paragraph\r\n    return this.createTextNode(line);\r\n  }\r\n\r\n  private parseCodeBlock(lines: string[], startIdx: number): { node: ASTNode | null; consumed: number } {\r\n    const firstLine = lines[startIdx];\r\n    const language = firstLine.replace('```', '').trim() || 'plain text';\r\n    const codeLines: string[] = [];\r\n    let i = startIdx + 1;\r\n\r\n    while (i < lines.length && !lines[i].trim().startsWith('```')) {\r\n      codeLines.push(lines[i]);\r\n      i++;\r\n    }\r\n\r\n    if (i >= lines.length) {\r\n      // No closing ```, treat as text\r\n      return { node: this.createTextNode(firstLine), consumed: 1 };\r\n    }\r\n\r\n    const code = codeLines.join('\\n');\r\n    const truncatedCode = this.truncateContent(code, this.options.maxCodeLength || 2000);\r\n\r\n    return {\r\n      node: this.createCodeNode(truncatedCode, language, true),\r\n      consumed: i - startIdx + 1\r\n    };\r\n  }\r\n\r\n  private parseEquationBlock(lines: string[], startIdx: number): { node: ASTNode | null; consumed: number } {\r\n    const firstLine = lines[startIdx];\r\n\r\n    // Handle $$equation$$ single line\r\n    if (firstLine.startsWith('$$') && firstLine.endsWith('$$') && firstLine.length > 4) {\r\n      const expression = firstLine.slice(2, -2).trim();\r\n      return {\r\n        node: this.createEquationNode(expression, true),\r\n        consumed: 1\r\n      };\r\n    }\r\n\r\n    // Handle multi-line $ or $$\r\n    const equationLines: string[] = [];\r\n    let i = startIdx + 1;\r\n    const delimiter = firstLine.startsWith('$$') ? '$$' : '$';\r\n\r\n    while (i < lines.length && lines[i].trim() !== delimiter) {\r\n      equationLines.push(lines[i]);\r\n      i++;\r\n    }\r\n\r\n    if (i >= lines.length) {\r\n      // No closing delimiter, treat as text\r\n      return { node: this.createTextNode(firstLine), consumed: 1 };\r\n    }\r\n\r\n    const expression = equationLines.join('\\n').trim();\r\n\r\n    if (!expression) {\r\n      return { node: null, consumed: i - startIdx + 1 };\r\n    }\r\n\r\n    return {\r\n      node: this.createEquationNode(expression, true),\r\n      consumed: i - startIdx + 1\r\n    };\r\n  }\r\n\r\n  private parseTable(lines: string[], startIdx: number): { node: ASTNode | null; consumed: number } {\r\n    const tableLines: string[] = [];\r\n    let i = startIdx;\r\n\r\n    // Collect all table lines\r\n    while (i < lines.length && lines[i].trim().startsWith('|')) {\r\n      tableLines.push(lines[i]);\r\n      i++;\r\n    }\r\n\r\n    if (tableLines.length < 2) {\r\n      return { node: null, consumed: 1 };\r\n    }\r\n\r\n    // Parse headers\r\n    const headers = this.parseTableRow(tableLines[0]);\r\n\r\n    // Check for separator line\r\n    let dataStartIndex = 1;\r\n    if (tableLines.length > 1 && this.isTableSeparator(tableLines[1])) {\r\n      dataStartIndex = 2;\r\n    }\r\n\r\n    // Parse data rows\r\n    const rows = tableLines.slice(dataStartIndex).map(line => this.parseTableRow(line));\r\n\r\n    // Normalize row lengths\r\n    const maxColumns = Math.max(headers.length, ...rows.map(row => row.length));\r\n    const normalizedHeaders = this.normalizeTableRow(headers, maxColumns);\r\n    const normalizedRows = rows.map(row => this.normalizeTableRow(row, maxColumns));\r\n\r\n    return {\r\n      node: this.createTableNode(normalizedHeaders, normalizedRows),\r\n      consumed: i - startIdx\r\n    };\r\n  }\r\n\r\n  private parseTableRow(line: string): string[] {\r\n    // Remove leading/trailing pipes and split\r\n    const trimmed = line.trim();\r\n    const withoutOuterPipes = trimmed.startsWith('|') ? trimmed.slice(1) : trimmed;\r\n    const withoutTrailingPipe = withoutOuterPipes.endsWith('|')\r\n      ? withoutOuterPipes.slice(0, -1)\r\n      : withoutOuterPipes;\r\n\r\n    return withoutTrailingPipe\r\n      .split('|')\r\n      .map(cell => cell.trim());\r\n  }\r\n\r\n  private isTableSeparator(line: string): boolean {\r\n    const trimmed = line.trim();\r\n    return /^[\\|\\-:\\s]+$/.test(trimmed) && trimmed.includes('-');\r\n  }\r\n\r\n  private normalizeTableRow(row: string[], targetLength: number): string[] {\r\n    const normalized = [...row];\r\n\r\n    // Pad with empty strings if too short\r\n    while (normalized.length < targetLength) {\r\n      normalized.push('');\r\n    }\r\n\r\n    // Truncate if too long\r\n    if (normalized.length > targetLength) {\r\n      normalized.length = targetLength;\r\n    }\r\n\r\n    return normalized;\r\n  }\r\n\r\n  private parseToggleHeading(lines: string[], startIdx: number): { node: ASTNode | null; consumed: number } {\r\n    const firstLine = lines[startIdx];\r\n    const match = firstLine.match(/^>\\s*(#{1,3})\\s+(.+)$/);\r\n\r\n    if (!match) return { node: null, consumed: 1 };\r\n\r\n    const level = match[1].length as 1 | 2 | 3;\r\n    const title = match[2];\r\n\r\n    const children: ASTNode[] = [];\r\n    let i = startIdx + 1;\r\n\r\n    // Parse toggle content (lines starting with >)\r\n    while (i < lines.length) {\r\n      const line = lines[i].trim();\r\n\r\n      if (line.startsWith('>')) {\r\n        // Remove > prefix and parse as normal content\r\n        const content = line.substring(1).trim();\r\n        if (content) {\r\n          // Recursively parse the content\r\n          const contentNodes = this.parse(content);\r\n          children.push(...contentNodes);\r\n        }\r\n        i++;\r\n      } else if (!line) {\r\n        // Empty line within toggle\r\n        i++;\r\n      } else {\r\n        // End of toggle\r\n        break;\r\n      }\r\n    }\r\n\r\n    return {\r\n      node: this.createToggleHeadingNode(title, level, children),\r\n      consumed: i - startIdx\r\n    };\r\n  }\r\n\r\n  private parseToggleBlock(lines: string[], startIdx: number): { node: ASTNode | null; consumed: number } {\r\n    const firstLine = lines[startIdx];\r\n    const content = firstLine.substring(2).trim(); // Remove \"> \"\r\n\r\n    if (!content) return { node: null, consumed: 1 };\r\n\r\n    const children: ASTNode[] = [];\r\n    let i = startIdx + 1;\r\n\r\n    // Parse toggle content (lines starting with >)\r\n    while (i < lines.length) {\r\n      const line = lines[i].trim();\r\n\r\n      if (line.startsWith('>')) {\r\n        // Remove > prefix and parse as normal content\r\n        const childContent = line.substring(1).trim();\r\n        if (childContent) {\r\n          // Recursively parse the content\r\n          const contentNodes = this.parse(childContent);\r\n          children.push(...contentNodes);\r\n        }\r\n        i++;\r\n      } else if (!line) {\r\n        // Empty line within toggle\r\n        i++;\r\n      } else {\r\n        // End of toggle\r\n        break;\r\n      }\r\n    }\r\n\r\n    // If no children, treat as a simple quote\r\n    if (children.length === 0) {\r\n      return { node: this.createQuoteNode(content), consumed: 1 };\r\n    }\r\n\r\n    return {\r\n      node: this.createToggleNode(content, children),\r\n      consumed: i - startIdx\r\n    };\r\n  }\r\n\r\n  private parseCallout(lines: string[], startIdx: number): { node: ASTNode | null; consumed: number } {\r\n    const firstLine = lines[startIdx];\r\n    const match = firstLine.match(/^>\\s*\\[!(\\w+)\\]\\s*(.*)$/);\r\n\r\n    if (!match) return { node: null, consumed: 1 };\r\n\r\n    const iconName = match[1].toLowerCase();\r\n    const firstContent = match[2] || '';\r\n\r\n    const contentLines = [firstContent];\r\n    let i = startIdx + 1;\r\n\r\n    // Parse multi-line callout content\r\n    while (i < lines.length) {\r\n      const line = lines[i].trim();\r\n\r\n      if (line.startsWith('>')) {\r\n        // Check if this is a new callout\r\n        if (line.match(/^>\\s*\\[!(\\w+)\\]/)) {\r\n          // This is a new callout, stop parsing current one\r\n          break;\r\n        }\r\n\r\n        // Continue callout content\r\n        const content = line.substring(1).trim();\r\n        contentLines.push(content);\r\n        i++;\r\n      } else if (!line) {\r\n        // Empty line within callout\r\n        contentLines.push('');\r\n        i++;\r\n      } else {\r\n        // End of callout\r\n        break;\r\n      }\r\n    }\r\n\r\n    const content = contentLines.filter(l => l !== '').join('\\n');\r\n    const icon = this.getCalloutIcon(iconName);\r\n    const color = this.getCalloutColor(iconName);\r\n\r\n    return {\r\n      node: this.createCalloutNode(content, icon, color),\r\n      consumed: i - startIdx\r\n    };\r\n  }\r\n\r\n  private isListLine(line: string): boolean {\r\n    return /^(\\s*)[-*+]\\s+/.test(line) ||\r\n      /^(\\s*)\\d+\\.\\s+/.test(line) ||\r\n      /^(\\s*)- \\[([ x])\\]\\s+/.test(line);\r\n  }\r\n\r\n  private parseNestedList(lines: string[], startIdx: number): { nodes: ASTNode[]; consumed: number } {\r\n    const listItems: Array<{ node: ASTNode; level: number; type: string }> = [];\r\n    let i = startIdx;\r\n\r\n    while (i < lines.length) {\r\n      const line = lines[i];\r\n      const trimmed = line.trim();\r\n\r\n      if (!this.isListLine(trimmed)) {\r\n        break;\r\n      }\r\n\r\n      const level = this.getIndentationLevel(line);\r\n      const listItem = this.parseListItem(trimmed);\r\n\r\n      if (listItem) {\r\n        listItems.push({\r\n          node: listItem.node,\r\n          level,\r\n          type: listItem.type\r\n        });\r\n      }\r\n\r\n      i++;\r\n    }\r\n\r\n    // Convert flat list to nested structure\r\n    const nestedNodes = this.buildNestedListStructure(listItems);\r\n\r\n    return {\r\n      nodes: nestedNodes,\r\n      consumed: i - startIdx\r\n    };\r\n  }\r\n\r\n  private getIndentationLevel(line: string): number {\r\n    const match = line.match(/^(\\s*)/);\r\n    const spaces = match ? match[1].length : 0;\r\n    return Math.floor(spaces / 2); // 2 spaces = 1 level\r\n  }\r\n\r\n  private parseListItem(line: string): { node: ASTNode; type: string } | null {\r\n    // Checkbox\r\n    const checkboxMatch = line.match(/^(\\s*)- \\[([ x])\\]\\s+(.+)$/);\r\n    if (checkboxMatch) {\r\n      return {\r\n        node: this.createListItemNode(checkboxMatch[3], 'todo', checkboxMatch[2] === 'x'),\r\n        type: 'todo'\r\n      };\r\n    }\r\n\r\n    // Bulleted list\r\n    const bulletMatch = line.match(/^(\\s*)[-*+]\\s+(.+)$/);\r\n    if (bulletMatch) {\r\n      return {\r\n        node: this.createListItemNode(bulletMatch[2], 'bulleted'),\r\n        type: 'bulleted'\r\n      };\r\n    }\r\n\r\n    // Numbered list\r\n    const numberedMatch = line.match(/^(\\s*)\\d+\\.\\s+(.+)$/);\r\n    if (numberedMatch) {\r\n      return {\r\n        node: this.createListItemNode(numberedMatch[2], 'numbered'),\r\n        type: 'numbered'\r\n      };\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  private buildNestedListStructure(items: Array<{ node: ASTNode; level: number; type: string }>): ASTNode[] {\r\n    if (items.length === 0) return [];\r\n\r\n    const result: ASTNode[] = [];\r\n    const stack: Array<{ node: ASTNode; level: number; children: ASTNode[] }> = [];\r\n\r\n    for (const item of items) {\r\n      // Pop items from stack that are at same or higher level\r\n      while (stack.length > 0 && stack[stack.length - 1].level >= item.level) {\r\n        const popped = stack.pop()!;\r\n        if (popped.children.length > 0) {\r\n          (popped.node as any).children = popped.children;\r\n        }\r\n\r\n        if (stack.length > 0) {\r\n          stack[stack.length - 1].children.push(popped.node);\r\n        } else {\r\n          result.push(popped.node);\r\n        }\r\n      }\r\n\r\n      // Add current item to stack\r\n      stack.push({\r\n        node: item.node,\r\n        level: item.level,\r\n        children: []\r\n      });\r\n    }\r\n\r\n    // Pop remaining items from stack\r\n    while (stack.length > 0) {\r\n      const popped = stack.pop()!;\r\n      if (popped.children.length > 0) {\r\n        (popped.node as any).children = popped.children;\r\n      }\r\n\r\n      if (stack.length > 0) {\r\n        stack[stack.length - 1].children.push(popped.node);\r\n      } else {\r\n        result.push(popped.node);\r\n      }\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  private isParagraphStart(line: string): boolean {\r\n    // Not a special markdown element\r\n    return !line.match(/^(#{1,3}\\s|[-*+]\\s|\\d+\\.\\s|>\\s|\\|.*\\||```|---|\\*\\*\\*|___|!\\[)/);\r\n  }\r\n\r\n  private parseMultiLineParagraph(lines: string[], startIdx: number): { node: ASTNode | null; consumed: number } {\r\n    const paragraphLines: string[] = [];\r\n    let i = startIdx;\r\n\r\n    while (i < lines.length) {\r\n      const line = lines[i];\r\n      const trimmed = line.trim();\r\n\r\n      // Empty line ends paragraph\r\n      if (!trimmed) {\r\n        break;\r\n      }\r\n\r\n      // Special markdown elements end paragraph\r\n      if (this.isSpecialMarkdownLine(trimmed)) {\r\n        break;\r\n      }\r\n\r\n      paragraphLines.push(line);\r\n      i++;\r\n    }\r\n\r\n    if (paragraphLines.length === 0) {\r\n      return { node: null, consumed: 1 };\r\n    }\r\n\r\n    // Join lines with soft breaks (spaces)\r\n    const content = paragraphLines.join(' ');\r\n\r\n    return {\r\n      node: this.createTextNode(content),\r\n      consumed: i - startIdx\r\n    };\r\n  }\r\n\r\n  private isSpecialMarkdownLine(line: string): boolean {\r\n    return /^(#{1,3}\\s|[-*+]\\s|\\d+\\.\\s|>\\s|\\|.*\\||```|---|\\*\\*\\*|___|!\\[)/.test(line);\r\n  }\r\n\r\n  private parseHtmlInline(line: string): ASTNode {\r\n    // Simple HTML tag removal for now\r\n    // In a more complete implementation, you'd parse HTML properly\r\n    const cleanText = line.replace(/<[^>]*>/g, '');\r\n    return this.createTextNode(cleanText);\r\n  }\r\n\r\n  private getCalloutIcon(name: string): string {\r\n    const icons: Record<string, string> = {\r\n      'note': 'üìù',\r\n      'info': '‚ÑπÔ∏è',\r\n      'tip': 'üí°',\r\n      'warning': '‚ö†Ô∏è',\r\n      'danger': 'üö®',\r\n      'success': '‚úÖ',\r\n      'question': '‚ùì',\r\n      'quote': 'üí¨',\r\n      'example': 'üìå',\r\n      'bug': 'üêõ',\r\n      'todo': '‚òëÔ∏è',\r\n      'abstract': 'üìÑ',\r\n      'summary': 'üìã',\r\n      'tldr': 'üìã',\r\n      'failure': '‚ùå',\r\n      'fail': '‚ùå',\r\n      'missing': '‚ùì',\r\n      'check': '‚úÖ',\r\n      'done': '‚úÖ'\r\n    };\r\n    return icons[name] || 'üí°';\r\n  }\r\n\r\n  private getCalloutColor(name: string): string {\r\n    const colors: Record<string, string> = {\r\n      'note': 'blue_background',\r\n      'info': 'blue_background',\r\n      'tip': 'green_background',\r\n      'warning': 'yellow_background',\r\n      'danger': 'red_background',\r\n      'success': 'green_background',\r\n      'question': 'purple_background',\r\n      'quote': 'gray_background',\r\n      'example': 'blue_background',\r\n      'bug': 'red_background',\r\n      'todo': 'blue_background',\r\n      'abstract': 'purple_background',\r\n      'summary': 'purple_background',\r\n      'tldr': 'purple_background',\r\n      'failure': 'red_background',\r\n      'fail': 'red_background',\r\n      'missing': 'yellow_background',\r\n      'check': 'green_background',\r\n      'done': 'green_background'\r\n    };\r\n    return colors[name] || 'gray_background';\r\n  }\r\n\r\n\r\n\r\n  /**\r\n   * Enhanced list parsing with better nesting support\r\n   */\r\n  static parseMarkdownList(content: string): ASTNode[] {\r\n    const parser = new MarkdownParser();\r\n    const lines = content.split('\\n');\r\n    const { nodes } = parser.parseNestedList(lines, 0);\r\n    return nodes;\r\n  }\r\n\r\n  /**\r\n   * Parse markdown tables with advanced features\r\n   */\r\n  static parseMarkdownTable(content: string): ASTNode | null {\r\n    const parser = new MarkdownParser();\r\n    const lines = content.split('\\n');\r\n    const { node } = parser.parseTable(lines, 0);\r\n    return node;\r\n  }\r\n}"],"version":3}