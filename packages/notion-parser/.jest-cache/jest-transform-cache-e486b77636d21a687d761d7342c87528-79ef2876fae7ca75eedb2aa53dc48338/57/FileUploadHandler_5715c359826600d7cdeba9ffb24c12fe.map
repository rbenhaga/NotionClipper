{"version":3,"names":["cov_hgqrhc95n","actualCoverage","s","exports","uploadFileAndParse","FileUploadHandler","constructor","options","f","maxFileSize","retryAttempts","generateUniqueName","uploadFile","file","filename","validationResult","validateFile","valid","b","success","error","finalFilename","uploadToNotion","Error","message","size","toFixed","File","allowedTypes","isAllowed","some","allowedType","type","startsWith","replace","join","originalName","timestamp","Date","now","random","Math","toString","substring","extension","split","pop","baseName","notionToken","fileUpload","createNotionFileUpload","sendFileToNotion","id","url","publicId","metadata","response","fetch","method","headers","body","JSON","stringify","name","file_size","mime_type","ok","status","json","fileUploadId","formData","FormData","append","createNotionBlock","blockType","uploadResult","baseBlock","object","image","file_upload","caption","video","audio","uploader","upload","errors","block"],"sources":["C:\\Users\\rayan\\Desktop\\Dev\\NotionClipper\\packages\\notion-parser\\src\\utils\\FileUploadHandler.ts"],"sourcesContent":["import type { NotionBlock } from '../types';\r\nimport type { FileUploadOptions } from '../types/options';\r\n\r\nexport interface FileUploadResult {\r\n  success: boolean;\r\n  url?: string;\r\n  publicId?: string;\r\n  error?: string;\r\n  metadata?: {\r\n    originalName: string;\r\n    size: number;\r\n    type: string;\r\n    width?: number;\r\n    height?: number;\r\n    duration?: number;\r\n  };\r\n}\r\n\r\n/**\r\n * Gestionnaire d'upload de fichiers vers Notion API native\r\n */\r\nexport class FileUploadHandler {\r\n  private options: FileUploadOptions;\r\n\r\n  constructor(options: FileUploadOptions) {\r\n    this.options = {\r\n      maxFileSize: 20 * 1024 * 1024, // 20MB par défaut\r\n      retryAttempts: 3,\r\n      generateUniqueName: false,\r\n      ...options\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Upload un fichier vers Notion API native\r\n   */\r\n  async uploadFile(file: File | Blob, filename?: string): Promise<FileUploadResult> {\r\n    try {\r\n      // Validation du fichier\r\n      const validationResult = this.validateFile(file);\r\n      if (!validationResult.valid) {\r\n        return {\r\n          success: false,\r\n          error: validationResult.error\r\n        };\r\n      }\r\n\r\n      // Génération du nom unique si nécessaire\r\n      const finalFilename = this.options.generateUniqueName \r\n        ? this.generateUniqueName(filename || 'file')\r\n        : filename || 'file';\r\n\r\n      // Upload vers Notion API native uniquement\r\n      return await this.uploadToNotion(file, finalFilename);\r\n    } catch (error) {\r\n      return {\r\n        success: false,\r\n        error: `Erreur d'upload: ${error instanceof Error ? error.message : 'Erreur inconnue'}`\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Valide un fichier avant upload\r\n   */\r\n  private validateFile(file: File | Blob): { valid: boolean; error?: string } {\r\n    // Vérifier la taille\r\n    if (file.size > this.options.maxFileSize!) {\r\n      return {\r\n        valid: false,\r\n        error: `Fichier trop volumineux: ${(file.size / 1024 / 1024).toFixed(1)}MB > ${(this.options.maxFileSize! / 1024 / 1024).toFixed(1)}MB`\r\n      };\r\n    }\r\n\r\n    // Vérifier le type si spécifié\r\n    if (file instanceof File && this.options.allowedTypes) {\r\n      const isAllowed = this.options.allowedTypes.some((allowedType: string) => {\r\n        return file.type === allowedType || file.type.startsWith(allowedType.replace('*', ''));\r\n      });\r\n\r\n      if (!isAllowed) {\r\n        return {\r\n          valid: false,\r\n          error: `Type de fichier non autorisé: ${file.type}. Types autorisés: ${this.options.allowedTypes.join(', ')}`\r\n        };\r\n      }\r\n    }\r\n\r\n    return { valid: true };\r\n  }\r\n\r\n  /**\r\n   * Génère un nom de fichier unique\r\n   */\r\n  private generateUniqueName(originalName: string): string {\r\n    const timestamp = Date.now();\r\n    const random = Math.random().toString(36).substring(2, 8);\r\n    const extension = originalName.split('.').pop();\r\n    const baseName = originalName.replace(/\\.[^/.]+$/, '');\r\n    \r\n    return `${baseName}_${timestamp}_${random}.${extension}`;\r\n  }\r\n\r\n  /**\r\n   * Upload vers Notion API native\r\n   */\r\n  private async uploadToNotion(file: File | Blob, filename: string): Promise<FileUploadResult> {\r\n    if (!this.options.notionToken) {\r\n      return {\r\n        success: false,\r\n        error: 'Token Notion manquant'\r\n      };\r\n    }\r\n\r\n    try {\r\n      // Étape 1: Créer le FileUpload\r\n      const fileUpload = await this.createNotionFileUpload(file, filename);\r\n      \r\n      // Étape 2: Envoyer le fichier\r\n      await this.sendFileToNotion(fileUpload.id, file, filename);\r\n      \r\n      return {\r\n        success: true,\r\n        url: fileUpload.id, // Utiliser l'ID comme URL\r\n        publicId: fileUpload.id,\r\n        metadata: {\r\n          originalName: filename,\r\n          size: file.size,\r\n          type: file instanceof File ? file.type : 'application/octet-stream'\r\n        }\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        success: false,\r\n        error: `Erreur upload Notion: ${error instanceof Error ? error.message : 'Erreur inconnue'}`\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Crée un FileUpload dans Notion\r\n   */\r\n  private async createNotionFileUpload(file: File | Blob, filename: string): Promise<any> {\r\n    const response = await fetch('https://api.notion.com/v1/file_uploads', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Authorization': `Bearer ${this.options.notionToken}`,\r\n        'Notion-Version': '2025-09-03',\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify({\r\n        name: filename,\r\n        file_size: file.size,\r\n        mime_type: file instanceof File ? file.type : 'application/octet-stream'\r\n      })\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`Erreur création FileUpload: ${response.status}`);\r\n    }\r\n\r\n    return await response.json();\r\n  }\r\n\r\n  /**\r\n   * Envoie le fichier vers Notion\r\n   */\r\n  private async sendFileToNotion(fileUploadId: string, file: File | Blob, filename: string): Promise<void> {\r\n    const formData = new FormData();\r\n    formData.append('file', file, filename);\r\n\r\n    const response = await fetch(`https://api.notion.com/v1/file_uploads/${fileUploadId}/send`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Authorization': `Bearer ${this.options.notionToken}`,\r\n        'Notion-Version': '2025-09-03'\r\n      },\r\n      body: formData\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`Erreur envoi fichier: ${response.status}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Crée un bloc Notion depuis un résultat d'upload\r\n   */\r\n  createNotionBlock(blockType: string, uploadResult: FileUploadResult): NotionBlock {\r\n    const baseBlock: any = {\r\n      object: 'block',\r\n      type: blockType\r\n    };\r\n\r\n    if (blockType === 'image') {\r\n      baseBlock.image = {\r\n        type: 'file_upload',\r\n        file_upload: {\r\n          id: uploadResult.publicId\r\n        },\r\n        caption: []\r\n      };\r\n    } else if (blockType === 'video') {\r\n      baseBlock.video = {\r\n        type: 'file_upload',\r\n        file_upload: {\r\n          id: uploadResult.publicId\r\n        },\r\n        caption: []\r\n      };\r\n    } else if (blockType === 'audio') {\r\n      baseBlock.audio = {\r\n        type: 'file_upload',\r\n        file_upload: {\r\n          id: uploadResult.publicId\r\n        },\r\n        caption: []\r\n      };\r\n    } else if (blockType === 'file') {\r\n      baseBlock.file = {\r\n        type: 'file_upload',\r\n        file_upload: {\r\n          id: uploadResult.publicId\r\n        },\r\n        caption: []\r\n      };\r\n    }\r\n\r\n    return baseBlock as NotionBlock;\r\n  }\r\n}\r\n\r\n/**\r\n * Upload un fichier et parse le résultat\r\n */\r\nexport async function uploadFileAndParse(\r\n  file: File | Blob,\r\n  options: {\r\n    upload: FileUploadOptions;\r\n    parse?: any;\r\n  }\r\n): Promise<{\r\n  uploadResult: FileUploadResult;\r\n  block?: NotionBlock;\r\n  errors?: Error[];\r\n}> {\r\n  try {\r\n    const uploader = new FileUploadHandler(options.upload);\r\n    \r\n    const uploadResult = await uploader.uploadFile(file);\r\n    \r\n    if (!uploadResult.success) {\r\n      return {\r\n        uploadResult,\r\n        errors: [new Error(uploadResult.error || 'Upload failed')]\r\n      };\r\n    }\r\n\r\n    // Déterminer le type de bloc\r\n    let blockType = 'file';\r\n    if (file instanceof File) {\r\n      if (file.type.startsWith('image/')) blockType = 'image';\r\n      else if (file.type.startsWith('video/')) blockType = 'video';\r\n      else if (file.type.startsWith('audio/')) blockType = 'audio';\r\n    }\r\n\r\n    const block = uploader.createNotionBlock(blockType, uploadResult);\r\n\r\n    return {\r\n      uploadResult,\r\n      block\r\n    };\r\n  } catch (error) {\r\n    return {\r\n      uploadResult: { success: false, error: 'Upload failed' },\r\n      errors: [error as Error]\r\n    };\r\n  }\r\n}"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}