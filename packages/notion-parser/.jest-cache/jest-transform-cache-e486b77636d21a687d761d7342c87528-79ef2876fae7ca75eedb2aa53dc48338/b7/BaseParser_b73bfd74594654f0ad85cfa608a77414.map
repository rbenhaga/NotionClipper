{"file":"C:\\Users\\rayan\\Desktop\\Dev\\NotionClipper\\packages\\notion-parser\\src\\parsers\\BaseParser.ts","mappings":"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","names":[],"sources":["C:\\Users\\rayan\\Desktop\\Dev\\NotionClipper\\packages\\notion-parser\\src\\parsers\\BaseParser.ts"],"sourcesContent":["import type { ASTNode, ParseOptions } from '../types';\r\n\r\nexport abstract class BaseParser {\r\n  protected options: ParseOptions;\r\n\r\n  constructor(options: ParseOptions = {}) {\r\n    this.options = {\r\n      maxBlocks: 100,\r\n      maxRichTextLength: 2000,\r\n      maxCodeLength: 2000,\r\n      defaultLanguage: 'plain text',\r\n      ...options\r\n    };\r\n  }\r\n\r\n  abstract parse(content: string): ASTNode[];\r\n\r\n  protected createTextNode(content: string, formatting?: any): ASTNode {\r\n    return {\r\n      type: 'text',\r\n      content,\r\n      metadata: { formatting }\r\n    };\r\n  }\r\n\r\n  protected createHeadingNode(content: string, level: 1 | 2 | 3, isToggleable = false): ASTNode {\r\n    return {\r\n      type: 'heading',\r\n      content,\r\n      metadata: { level, isToggleable },\r\n      children: []\r\n    };\r\n  }\r\n\r\n  protected createToggleHeadingNode(content: string, level: 1 | 2 | 3, children: ASTNode[] = []): ASTNode {\r\n    return {\r\n      type: 'heading',\r\n      content,\r\n      metadata: { level, isToggleable: true },\r\n      children\r\n    };\r\n  }\r\n\r\n  protected createListNode(items: ASTNode[], listType: 'bulleted' | 'numbered' | 'todo'): ASTNode {\r\n    return {\r\n      type: 'list',\r\n      children: items,\r\n      metadata: { listType }\r\n    };\r\n  }\r\n\r\n  protected createListItemNode(content: string, listType: 'bulleted' | 'numbered' | 'todo' = 'bulleted', checked?: boolean): ASTNode {\r\n    return {\r\n      type: 'list_item',\r\n      content,\r\n      metadata: {\r\n        listType,\r\n        checked\r\n      }\r\n    };\r\n  }\r\n\r\n  protected createCodeNode(content: string, language?: string, isBlock = false): ASTNode {\r\n    return {\r\n      type: 'code',\r\n      content,\r\n      metadata: {\r\n        language: language || this.options.defaultLanguage,\r\n        isBlock\r\n      }\r\n    };\r\n  }\r\n\r\n  protected createTableNode(headers: string[], rows: string[][], options?: {\r\n    hasColumnHeader?: boolean;\r\n    hasRowHeader?: boolean;\r\n  }): ASTNode {\r\n    return {\r\n      type: 'table',\r\n      content: '',\r\n      metadata: {\r\n        headers,\r\n        rows,\r\n        hasColumnHeader: options?.hasColumnHeader ?? true,\r\n        hasRowHeader: options?.hasRowHeader ?? false,\r\n        columnCount: Math.max(headers.length, ...rows.map(row => row.length)),\r\n        rowCount: rows.length + (options?.hasColumnHeader ? 1 : 0)\r\n      },\r\n      children: []\r\n    };\r\n  }\r\n\r\n  protected createCalloutNode(content: string, icon?: string, color?: string): ASTNode {\r\n    return {\r\n      type: 'callout',\r\n      content,\r\n      metadata: { icon, color }\r\n    };\r\n  }\r\n\r\n  protected createMediaNode(\r\n    type: 'image' | 'video' | 'audio' | 'file',\r\n    url: string,\r\n    caption?: string,\r\n    alt?: string\r\n  ): ASTNode {\r\n    return {\r\n      type,\r\n      metadata: { url, caption, alt }\r\n    };\r\n  }\r\n\r\n  protected createEquationNode(expression: string, isBlock = false): ASTNode {\r\n    return {\r\n      type: 'equation',\r\n      content: expression,\r\n      metadata: { isBlock }\r\n    };\r\n  }\r\n\r\n  protected createQuoteNode(content: string): ASTNode {\r\n    return {\r\n      type: 'quote',\r\n      content\r\n    };\r\n  }\r\n\r\n  protected createDividerNode(): ASTNode {\r\n    return {\r\n      type: 'divider'\r\n    };\r\n  }\r\n\r\n  protected createToggleNode(content: string, children: ASTNode[] = []): ASTNode {\r\n    return {\r\n      type: 'toggle',\r\n      content,\r\n      children\r\n    };\r\n  }\r\n\r\n  protected createBookmarkNode(url: string, title?: string, description?: string): ASTNode {\r\n    return {\r\n      type: 'bookmark',\r\n      metadata: { url, title, description }\r\n    };\r\n  }\r\n\r\n  protected truncateContent(content: string, maxLength: number): string {\r\n    if (content.length <= maxLength) {\r\n      return content;\r\n    }\r\n\r\n    let truncated = content.substring(0, maxLength - 20);\r\n    const lastSpace = truncated.lastIndexOf(' ');\r\n\r\n    if (lastSpace > maxLength * 0.8) {\r\n      truncated = truncated.substring(0, lastSpace);\r\n    }\r\n\r\n    return truncated + '... [tronqu√©]';\r\n  }\r\n\r\n  protected isValidUrl(text: string): boolean {\r\n    try {\r\n      const urlPattern = /^https?:\\/\\/[^\\s<>\"{}|\\\\^`[\\]]+$/;\r\n      return urlPattern.test(text) && text.includes('.');\r\n    } catch {\r\n      return false;\r\n    }\r\n  }\r\n}"],"version":3}